<!DOCTYPE html>
<html lang="en-US" xml:lang="en-US">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>13 Experiments and Quasi-Experiments | Introduction to Econometrics with R - THIS IS A FORK of the oriinal work</title>
  <meta name="description" content="Beginners with little background in statistics and econometrics often have a hard time understanding the benefits of having programming skills for learning and applying Econometrics. ‘Introduction to Econometrics with R’ is an interactive companion to the well-received textbook ‘Introduction to Econometrics’ by James H. Stock and Mark W. Watson (2015). It gives a gentle introduction to the essentials of R programming and guides students in implementing the empirical applications presented throughout the textbook using the newly aquired skills. This is supported by interactive programming exercises generated with DataCamp Light and integration of interactive visualizations of central concepts which are based on the flexible JavaScript library D3.js." />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="13 Experiments and Quasi-Experiments | Introduction to Econometrics with R - THIS IS A FORK of the oriinal work" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://www.econometrics-with-r.org//images/cover.png" />
  <meta property="og:description" content="Beginners with little background in statistics and econometrics often have a hard time understanding the benefits of having programming skills for learning and applying Econometrics. ‘Introduction to Econometrics with R’ is an interactive companion to the well-received textbook ‘Introduction to Econometrics’ by James H. Stock and Mark W. Watson (2015). It gives a gentle introduction to the essentials of R programming and guides students in implementing the empirical applications presented throughout the textbook using the newly aquired skills. This is supported by interactive programming exercises generated with DataCamp Light and integration of interactive visualizations of central concepts which are based on the flexible JavaScript library D3.js." />
  <meta name="github-repo" content="mca91/EconometricsWithR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="13 Experiments and Quasi-Experiments | Introduction to Econometrics with R - THIS IS A FORK of the oriinal work" />
  
  <meta name="twitter:description" content="Beginners with little background in statistics and econometrics often have a hard time understanding the benefits of having programming skills for learning and applying Econometrics. ‘Introduction to Econometrics with R’ is an interactive companion to the well-received textbook ‘Introduction to Econometrics’ by James H. Stock and Mark W. Watson (2015). It gives a gentle introduction to the essentials of R programming and guides students in implementing the empirical applications presented throughout the textbook using the newly aquired skills. This is supported by interactive programming exercises generated with DataCamp Light and integration of interactive visualizations of central concepts which are based on the flexible JavaScript library D3.js." />
  <meta name="twitter:image" content="https://www.econometrics-with-r.org//images/cover.png" />

<meta name="author" content="Christoph Hanck, Martin Arnold, Alexander Gerber, and Martin Schmelzer" />


<meta name="date" content="2024-12-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ivr.html"/>
<link rel="next" href="ittsraf.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.3/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="toc.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><center><img src="images/logo.png" alt="logo" width="50%" height="50%"style="margin: 15px 0 0 0"></center></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#colophon"><i class="fa fa-check"></i><b>1.1</b> Colophon</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#a-very-short-introduction-to-r-and-rstudio"><i class="fa fa-check"></i><b>1.2</b> A Very Short Introduction to <tt>R</tt> and <em>RStudio</em></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="pt.html"><a href="pt.html"><i class="fa fa-check"></i><b>2</b> Probability Theory</a>
<ul>
<li class="chapter" data-level="2.1" data-path="pt.html"><a href="pt.html#random-variables-and-probability-distributions"><i class="fa fa-check"></i><b>2.1</b> Random Variables and Probability Distributions</a>
<ul>
<li class="chapter" data-level="" data-path="pt.html"><a href="pt.html#probability-distributions-of-discrete-random-variables"><i class="fa fa-check"></i>Probability Distributions of Discrete Random Variables</a></li>
<li class="chapter" data-level="" data-path="pt.html"><a href="pt.html#bernoulli-trials"><i class="fa fa-check"></i>Bernoulli Trials</a></li>
<li class="chapter" data-level="" data-path="pt.html"><a href="pt.html#expected-value-mean-and-variance"><i class="fa fa-check"></i>Expected Value, Mean and Variance</a></li>
<li class="chapter" data-level="" data-path="pt.html"><a href="pt.html#probability-distributions-of-continuous-random-variables"><i class="fa fa-check"></i>Probability Distributions of Continuous Random Variables</a></li>
<li class="chapter" data-level="" data-path="pt.html"><a href="pt.html#the-normal-distribution"><i class="fa fa-check"></i>The Normal Distribution</a></li>
<li class="chapter" data-level="" data-path="pt.html"><a href="pt.html#the-chi-squared-distribution"><i class="fa fa-check"></i>The Chi-Squared Distribution</a></li>
<li class="chapter" data-level="" data-path="pt.html"><a href="pt.html#thetdist"><i class="fa fa-check"></i>The Student t Distribution</a></li>
<li class="chapter" data-level="" data-path="pt.html"><a href="pt.html#the-f-distribution"><i class="fa fa-check"></i>The F Distribution</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="pt.html"><a href="pt.html#RSATDOSA"><i class="fa fa-check"></i><b>2.2</b> Random Sampling and the Distribution of Sample Averages</a>
<ul>
<li class="chapter" data-level="" data-path="pt.html"><a href="pt.html#mean-and-variance-of-the-sample-mean"><i class="fa fa-check"></i>Mean and Variance of the Sample Mean</a></li>
<li class="chapter" data-level="" data-path="pt.html"><a href="pt.html#large-sample-approximations-to-sampling-distributions"><i class="fa fa-check"></i>Large Sample Approximations to Sampling Distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="pt.html"><a href="pt.html#exercises-2"><i class="fa fa-check"></i><b>2.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="arosur.html"><a href="arosur.html"><i class="fa fa-check"></i><b>3</b> A Review of Statistics using R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="arosur.html"><a href="arosur.html#estimation-of-the-population-mean"><i class="fa fa-check"></i><b>3.1</b> Estimation of the Population Mean</a></li>
<li class="chapter" data-level="3.2" data-path="arosur.html"><a href="arosur.html#potsm"><i class="fa fa-check"></i><b>3.2</b> Properties of the Sample Mean</a></li>
<li class="chapter" data-level="3.3" data-path="arosur.html"><a href="arosur.html#hypothesis-tests-concerning-the-population-mean"><i class="fa fa-check"></i><b>3.3</b> Hypothesis Tests concerning the Population Mean</a>
<ul>
<li class="chapter" data-level="" data-path="arosur.html"><a href="arosur.html#the-p-value"><i class="fa fa-check"></i>The p-Value</a></li>
<li class="chapter" data-level="" data-path="arosur.html"><a href="arosur.html#calculating-the-p-value-when-the-standard-deviation-is-known"><i class="fa fa-check"></i>Calculating the p-Value when the Standard Deviation is Known</a></li>
<li class="chapter" data-level="" data-path="arosur.html"><a href="arosur.html#SVSSDASE"><i class="fa fa-check"></i>Sample Variance, Sample Standard Deviation and Standard Error</a></li>
<li class="chapter" data-level="" data-path="arosur.html"><a href="arosur.html#calculating-the-p-value-when-the-standard-deviation-is-unknown"><i class="fa fa-check"></i>Calculating the p-value When the Standard Deviation is Unknown</a></li>
<li class="chapter" data-level="" data-path="arosur.html"><a href="arosur.html#the-t-statistic"><i class="fa fa-check"></i>The t-statistic</a></li>
<li class="chapter" data-level="" data-path="arosur.html"><a href="arosur.html#hypothesis-testing-with-a-prespecified-significance-level"><i class="fa fa-check"></i>Hypothesis Testing with a Prespecified Significance Level</a></li>
<li class="chapter" data-level="" data-path="arosur.html"><a href="arosur.html#one-sided-alternatives"><i class="fa fa-check"></i>One-sided Alternatives</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="arosur.html"><a href="arosur.html#confidence-intervals-for-the-population-mean"><i class="fa fa-check"></i><b>3.4</b> Confidence Intervals for the Population Mean</a></li>
<li class="chapter" data-level="3.5" data-path="arosur.html"><a href="arosur.html#cmfdp"><i class="fa fa-check"></i><b>3.5</b> Comparing Means from Different Populations</a></li>
<li class="chapter" data-level="3.6" data-path="arosur.html"><a href="arosur.html#aattggoe"><i class="fa fa-check"></i><b>3.6</b> An Application to the Gender Gap of Earnings</a></li>
<li class="chapter" data-level="3.7" data-path="arosur.html"><a href="arosur.html#scatterplots-sample-covariance-and-sample-correlation"><i class="fa fa-check"></i><b>3.7</b> Scatterplots, Sample Covariance and Sample Correlation</a></li>
<li class="chapter" data-level="3.8" data-path="arosur.html"><a href="arosur.html#exercises-3"><i class="fa fa-check"></i><b>3.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lrwor.html"><a href="lrwor.html"><i class="fa fa-check"></i><b>4</b> Linear Regression with One Regressor</a>
<ul>
<li class="chapter" data-level="4.1" data-path="lrwor.html"><a href="lrwor.html#simple-linear-regression"><i class="fa fa-check"></i><b>4.1</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="4.2" data-path="lrwor.html"><a href="lrwor.html#estimating-the-coefficients-of-the-linear-regression-model"><i class="fa fa-check"></i><b>4.2</b> Estimating the Coefficients of the Linear Regression Model</a>
<ul>
<li class="chapter" data-level="" data-path="lrwor.html"><a href="lrwor.html#the-ordinary-least-squares-estimator"><i class="fa fa-check"></i>The Ordinary Least Squares Estimator</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="lrwor.html"><a href="lrwor.html#measures-of-fit"><i class="fa fa-check"></i><b>4.3</b> Measures of Fit</a>
<ul>
<li class="chapter" data-level="" data-path="lrwor.html"><a href="lrwor.html#the-coefficient-of-determination"><i class="fa fa-check"></i>The Coefficient of Determination</a></li>
<li class="chapter" data-level="" data-path="lrwor.html"><a href="lrwor.html#the-standard-error-of-the-regression"><i class="fa fa-check"></i>The Standard Error of the Regression</a></li>
<li class="chapter" data-level="" data-path="lrwor.html"><a href="lrwor.html#application-to-the-test-score-data"><i class="fa fa-check"></i>Application to the Test Score Data</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="lrwor.html"><a href="lrwor.html#tlsa"><i class="fa fa-check"></i><b>4.4</b> The Least Squares Assumptions</a>
<ul>
<li class="chapter" data-level="" data-path="lrwor.html"><a href="lrwor.html#assumption-1-the-error-term-has-conditional-mean-of-zero"><i class="fa fa-check"></i>Assumption 1: The Error Term has Conditional Mean of Zero</a></li>
<li class="chapter" data-level="" data-path="lrwor.html"><a href="lrwor.html#assumption-2-independently-and-identically-distributed-data"><i class="fa fa-check"></i>Assumption 2: Independently and Identically Distributed Data</a></li>
<li class="chapter" data-level="" data-path="lrwor.html"><a href="lrwor.html#assumption-3-large-outliers-are-unlikely"><i class="fa fa-check"></i>Assumption 3: Large Outliers are Unlikely</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="lrwor.html"><a href="lrwor.html#tsdotoe"><i class="fa fa-check"></i><b>4.5</b> The Sampling Distribution of the OLS Estimator</a>
<ul>
<li class="chapter" data-level="" data-path="lrwor.html"><a href="lrwor.html#simulation-study-1"><i class="fa fa-check"></i>Simulation Study 1</a></li>
<li class="chapter" data-level="" data-path="lrwor.html"><a href="lrwor.html#simulation-study-2"><i class="fa fa-check"></i>Simulation Study 2</a></li>
<li class="chapter" data-level="" data-path="lrwor.html"><a href="lrwor.html#simulation-study-3"><i class="fa fa-check"></i>Simulation Study 3</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="lrwor.html"><a href="lrwor.html#exercises-4"><i class="fa fa-check"></i><b>4.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="htaciitslrm.html"><a href="htaciitslrm.html"><i class="fa fa-check"></i><b>5</b> Hypothesis Tests and Confidence Intervals in SLR Model</a>
<ul>
<li class="chapter" data-level="5.1" data-path="htaciitslrm.html"><a href="htaciitslrm.html#testing-two-sided-hypotheses-concerning-the-slope-coefficient"><i class="fa fa-check"></i><b>5.1</b> Testing Two-Sided Hypotheses concerning the Slope Coefficient</a></li>
<li class="chapter" data-level="5.2" data-path="htaciitslrm.html"><a href="htaciitslrm.html#cifrc"><i class="fa fa-check"></i><b>5.2</b> Confidence Intervals for Regression Coefficients</a>
<ul>
<li class="chapter" data-level="" data-path="htaciitslrm.html"><a href="htaciitslrm.html#simulation-study-confidence-intervals"><i class="fa fa-check"></i>Simulation Study: Confidence Intervals</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="htaciitslrm.html"><a href="htaciitslrm.html#rwxiabv"><i class="fa fa-check"></i><b>5.3</b> Regression when X is a Binary Variable</a></li>
<li class="chapter" data-level="5.4" data-path="htaciitslrm.html"><a href="htaciitslrm.html#hah"><i class="fa fa-check"></i><b>5.4</b> Heteroskedasticity and Homoskedasticity</a>
<ul>
<li class="chapter" data-level="" data-path="htaciitslrm.html"><a href="htaciitslrm.html#a-real-world-example-for-heteroskedasticity"><i class="fa fa-check"></i>A Real-World Example for Heteroskedasticity</a></li>
<li class="chapter" data-level="" data-path="htaciitslrm.html"><a href="htaciitslrm.html#should-we-care-about-heteroskedasticity"><i class="fa fa-check"></i>Should We Care About Heteroskedasticity?</a></li>
<li class="chapter" data-level="" data-path="htaciitslrm.html"><a href="htaciitslrm.html#computation-of-heteroskedasticity-robust-standard-errors"><i class="fa fa-check"></i>Computation of Heteroskedasticity-Robust Standard Errors</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="htaciitslrm.html"><a href="htaciitslrm.html#the-gauss-markov-theorem"><i class="fa fa-check"></i><b>5.5</b> The Gauss-Markov Theorem</a>
<ul>
<li class="chapter" data-level="" data-path="htaciitslrm.html"><a href="htaciitslrm.html#simulation-study-blue-estimator"><i class="fa fa-check"></i>Simulation Study: BLUE Estimator</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="htaciitslrm.html"><a href="htaciitslrm.html#using-the-t-statistic-in-regression-when-the-sample-size-is-small"><i class="fa fa-check"></i><b>5.6</b> Using the t-Statistic in Regression when the Sample Size Is Small</a></li>
<li class="chapter" data-level="5.7" data-path="htaciitslrm.html"><a href="htaciitslrm.html#exercises-5"><i class="fa fa-check"></i><b>5.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="rmwmr.html"><a href="rmwmr.html"><i class="fa fa-check"></i><b>6</b> Regression Models with Multiple Regressors</a>
<ul>
<li class="chapter" data-level="6.1" data-path="rmwmr.html"><a href="rmwmr.html#omitted-variable-bias"><i class="fa fa-check"></i><b>6.1</b> Omitted Variable Bias</a></li>
<li class="chapter" data-level="6.2" data-path="rmwmr.html"><a href="rmwmr.html#tmrm"><i class="fa fa-check"></i><b>6.2</b> The Multiple Regression Model</a></li>
<li class="chapter" data-level="6.3" data-path="rmwmr.html"><a href="rmwmr.html#mofimr"><i class="fa fa-check"></i><b>6.3</b> Measures of Fit in Multiple Regression</a></li>
<li class="chapter" data-level="6.4" data-path="rmwmr.html"><a href="rmwmr.html#ols-assumptions-in-multiple-regression"><i class="fa fa-check"></i><b>6.4</b> OLS Assumptions in Multiple Regression</a>
<ul>
<li class="chapter" data-level="" data-path="rmwmr.html"><a href="rmwmr.html#multicollinearity"><i class="fa fa-check"></i>Multicollinearity</a></li>
<li class="chapter" data-level="" data-path="rmwmr.html"><a href="rmwmr.html#simulation-study-imperfect-multicollinearity"><i class="fa fa-check"></i>Simulation Study: Imperfect Multicollinearity</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="rmwmr.html"><a href="rmwmr.html#the-distribution-of-the-ols-estimators-in-multiple-regression"><i class="fa fa-check"></i><b>6.5</b> The Distribution of the OLS Estimators in Multiple Regression</a></li>
<li class="chapter" data-level="6.6" data-path="rmwmr.html"><a href="rmwmr.html#exercises-6"><i class="fa fa-check"></i><b>6.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="htaciimr.html"><a href="htaciimr.html"><i class="fa fa-check"></i><b>7</b> Hypothesis Tests and Confidence Intervals in MR Models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="htaciimr.html"><a href="htaciimr.html#hypothesis-tests-and-confidence-intervals-for-a-single-coefficient"><i class="fa fa-check"></i><b>7.1</b> Hypothesis Tests and Confidence Intervals for a Single Coefficient</a></li>
<li class="chapter" data-level="7.2" data-path="htaciimr.html"><a href="htaciimr.html#an-application-to-test-scores-and-the-student-teacher-ratio"><i class="fa fa-check"></i><b>7.2</b> An Application to Test Scores and the Student-Teacher Ratio</a>
<ul>
<li class="chapter" data-level="" data-path="htaciimr.html"><a href="htaciimr.html#another-augmentation-of-the-model"><i class="fa fa-check"></i>Another Augmentation of the Model</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="htaciimr.html"><a href="htaciimr.html#joint-hypothesis-testing-using-the-f-statistic"><i class="fa fa-check"></i><b>7.3</b> Joint Hypothesis Testing using the F-Statistic</a></li>
<li class="chapter" data-level="7.4" data-path="htaciimr.html"><a href="htaciimr.html#confidence-sets-for-multiple-coefficients"><i class="fa fa-check"></i><b>7.4</b> Confidence Sets for Multiple Coefficients</a></li>
<li class="chapter" data-level="7.5" data-path="htaciimr.html"><a href="htaciimr.html#model-specification-for-multiple-regression"><i class="fa fa-check"></i><b>7.5</b> Model Specification for Multiple Regression</a>
<ul>
<li class="chapter" data-level="" data-path="htaciimr.html"><a href="htaciimr.html#model-specification-in-theory-and-in-practice"><i class="fa fa-check"></i>Model Specification in Theory and in Practice</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="htaciimr.html"><a href="htaciimr.html#analysis-of-the-test-score-data-set"><i class="fa fa-check"></i><b>7.6</b> Analysis of the Test Score Data Set</a></li>
<li class="chapter" data-level="7.7" data-path="htaciimr.html"><a href="htaciimr.html#exercises-7"><i class="fa fa-check"></i><b>7.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="nrf.html"><a href="nrf.html"><i class="fa fa-check"></i><b>8</b> Nonlinear Regression Functions</a>
<ul>
<li class="chapter" data-level="8.1" data-path="nrf.html"><a href="nrf.html#a-general-strategy-for-modelling-nonlinear-regression-functions"><i class="fa fa-check"></i><b>8.1</b> A General Strategy for Modelling Nonlinear Regression Functions</a></li>
<li class="chapter" data-level="8.2" data-path="nrf.html"><a href="nrf.html#nfoasiv"><i class="fa fa-check"></i><b>8.2</b> Nonlinear Functions of a Single Independent Variable</a>
<ul>
<li class="chapter" data-level="" data-path="nrf.html"><a href="nrf.html#polynomials"><i class="fa fa-check"></i>Polynomials</a></li>
<li class="chapter" data-level="" data-path="nrf.html"><a href="nrf.html#logarithms"><i class="fa fa-check"></i>Logarithms</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="nrf.html"><a href="nrf.html#interactions-between-independent-variables"><i class="fa fa-check"></i><b>8.3</b> Interactions between Independent Variables</a></li>
<li class="chapter" data-level="8.4" data-path="nrf.html"><a href="nrf.html#nonlinear-effects-on-test-scores-of-the-student-teacher-ratio"><i class="fa fa-check"></i><b>8.4</b> Nonlinear Effects on Test Scores of the Student-Teacher Ratio</a></li>
<li class="chapter" data-level="8.5" data-path="nrf.html"><a href="nrf.html#exercises-8"><i class="fa fa-check"></i><b>8.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="asbomr.html"><a href="asbomr.html"><i class="fa fa-check"></i><b>9</b> Assessing Studies Based on Multiple Regression</a>
<ul>
<li class="chapter" data-level="9.1" data-path="asbomr.html"><a href="asbomr.html#internal-and-external-validity"><i class="fa fa-check"></i><b>9.1</b> Internal and External Validity</a></li>
<li class="chapter" data-level="9.2" data-path="asbomr.html"><a href="asbomr.html#ttivomra"><i class="fa fa-check"></i><b>9.2</b> Threats to Internal Validity of Multiple Regression Analysis</a></li>
<li class="chapter" data-level="9.3" data-path="asbomr.html"><a href="asbomr.html#internal-and-external-validity-when-the-regression-is-used-for-forecasting"><i class="fa fa-check"></i><b>9.3</b> Internal and External Validity when the Regression is used for Forecasting</a></li>
<li class="chapter" data-level="9.4" data-path="asbomr.html"><a href="asbomr.html#etsacs"><i class="fa fa-check"></i><b>9.4</b> Example: Test Scores and Class Size</a></li>
<li class="chapter" data-level="9.5" data-path="asbomr.html"><a href="asbomr.html#exercises-9"><i class="fa fa-check"></i><b>9.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="rwpd.html"><a href="rwpd.html"><i class="fa fa-check"></i><b>10</b> Regression with Panel Data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="rwpd.html"><a href="rwpd.html#panel-data"><i class="fa fa-check"></i><b>10.1</b> Panel Data</a></li>
<li class="chapter" data-level="10.2" data-path="rwpd.html"><a href="rwpd.html#PDWTTP"><i class="fa fa-check"></i><b>10.2</b> Panel Data with Two Time Periods: “Before and After” Comparisons</a></li>
<li class="chapter" data-level="10.3" data-path="rwpd.html"><a href="rwpd.html#fixed-effects-regression"><i class="fa fa-check"></i><b>10.3</b> Fixed Effects Regression</a>
<ul>
<li class="chapter" data-level="" data-path="rwpd.html"><a href="rwpd.html#estimation-and-inference"><i class="fa fa-check"></i>Estimation and Inference</a></li>
<li class="chapter" data-level="" data-path="rwpd.html"><a href="rwpd.html#application-to-traffic-deaths"><i class="fa fa-check"></i>Application to Traffic Deaths</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="rwpd.html"><a href="rwpd.html#regression-with-time-fixed-effects"><i class="fa fa-check"></i><b>10.4</b> Regression with Time Fixed Effects</a></li>
<li class="chapter" data-level="10.5" data-path="rwpd.html"><a href="rwpd.html#tferaaseffer"><i class="fa fa-check"></i><b>10.5</b> The Fixed Effects Regression Assumptions and Standard Errors for Fixed Effects Regression</a></li>
<li class="chapter" data-level="10.6" data-path="rwpd.html"><a href="rwpd.html#drunk-driving-laws-and-traffic-deaths"><i class="fa fa-check"></i><b>10.6</b> Drunk Driving Laws and Traffic Deaths</a></li>
<li class="chapter" data-level="10.7" data-path="rwpd.html"><a href="rwpd.html#exercises-10"><i class="fa fa-check"></i><b>10.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="rwabdv.html"><a href="rwabdv.html"><i class="fa fa-check"></i><b>11</b> Regression with a Binary Dependent Variable</a>
<ul>
<li class="chapter" data-level="11.1" data-path="rwabdv.html"><a href="rwabdv.html#binary-dependent-variables-and-the-linear-probability-model"><i class="fa fa-check"></i><b>11.1</b> Binary Dependent Variables and the Linear Probability Model</a></li>
<li class="chapter" data-level="11.2" data-path="rwabdv.html"><a href="rwabdv.html#palr"><i class="fa fa-check"></i><b>11.2</b> Probit and Logit Regression</a>
<ul>
<li class="chapter" data-level="" data-path="rwabdv.html"><a href="rwabdv.html#probit-regression"><i class="fa fa-check"></i>Probit Regression</a></li>
<li class="chapter" data-level="" data-path="rwabdv.html"><a href="rwabdv.html#logit-regression"><i class="fa fa-check"></i>Logit Regression</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="rwabdv.html"><a href="rwabdv.html#estimation-and-inference-in-the-logit-and-probit-models"><i class="fa fa-check"></i><b>11.3</b> Estimation and Inference in the Logit and Probit Models</a></li>
<li class="chapter" data-level="11.4" data-path="rwabdv.html"><a href="rwabdv.html#application-to-the-boston-hmda-data"><i class="fa fa-check"></i><b>11.4</b> Application to the Boston HMDA Data</a></li>
<li class="chapter" data-level="11.5" data-path="rwabdv.html"><a href="rwabdv.html#exercises-11"><i class="fa fa-check"></i><b>11.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ivr.html"><a href="ivr.html"><i class="fa fa-check"></i><b>12</b> Instrumental Variables Regression</a>
<ul>
<li class="chapter" data-level="12.1" data-path="ivr.html"><a href="ivr.html#TIVEWASRAASI"><i class="fa fa-check"></i><b>12.1</b> The IV Estimator with a Single Regressor and a Single Instrument</a></li>
<li class="chapter" data-level="12.2" data-path="ivr.html"><a href="ivr.html#TGIVRM"><i class="fa fa-check"></i><b>12.2</b> The General IV Regression Model</a></li>
<li class="chapter" data-level="12.3" data-path="ivr.html"><a href="ivr.html#civ"><i class="fa fa-check"></i><b>12.3</b> Checking Instrument Validity</a></li>
<li class="chapter" data-level="12.4" data-path="ivr.html"><a href="ivr.html#attdfc"><i class="fa fa-check"></i><b>12.4</b> Application to the Demand for Cigarettes</a></li>
<li class="chapter" data-level="12.5" data-path="ivr.html"><a href="ivr.html#where-do-valid-instruments-come-from"><i class="fa fa-check"></i><b>12.5</b> Where Do Valid Instruments Come From?</a></li>
<li class="chapter" data-level="12.6" data-path="ivr.html"><a href="ivr.html#exercises-12"><i class="fa fa-check"></i><b>12.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="eaqe.html"><a href="eaqe.html"><i class="fa fa-check"></i><b>13</b> Experiments and Quasi-Experiments</a>
<ul>
<li class="chapter" data-level="13.1" data-path="eaqe.html"><a href="eaqe.html#poceaie"><i class="fa fa-check"></i><b>13.1</b> Potential Outcomes, Causal Effects and Idealized Experiments</a></li>
<li class="chapter" data-level="13.2" data-path="eaqe.html"><a href="eaqe.html#threats-to-validity-of-experiments"><i class="fa fa-check"></i><b>13.2</b> Threats to Validity of Experiments</a></li>
<li class="chapter" data-level="13.3" data-path="eaqe.html"><a href="eaqe.html#experimental-estimates-of-the-effect-of-class-size-reductions"><i class="fa fa-check"></i><b>13.3</b> Experimental Estimates of the Effect of Class Size Reductions</a>
<ul>
<li class="chapter" data-level="" data-path="eaqe.html"><a href="eaqe.html#experimental-design-and-the-data-set"><i class="fa fa-check"></i>Experimental Design and the Data Set</a></li>
<li class="chapter" data-level="" data-path="eaqe.html"><a href="eaqe.html#analysis-of-the-star-data"><i class="fa fa-check"></i>Analysis of the STAR Data</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="eaqe.html"><a href="eaqe.html#qe"><i class="fa fa-check"></i><b>13.4</b> Quasi Experiments</a>
<ul>
<li class="chapter" data-level="" data-path="eaqe.html"><a href="eaqe.html#the-differences-in-differences-estimator"><i class="fa fa-check"></i>The Differences-in-Differences Estimator</a></li>
<li class="chapter" data-level="" data-path="eaqe.html"><a href="eaqe.html#regression-discontinuity-estimators"><i class="fa fa-check"></i>Regression Discontinuity Estimators</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="eaqe.html"><a href="eaqe.html#exercises-13"><i class="fa fa-check"></i><b>13.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="ittsraf.html"><a href="ittsraf.html"><i class="fa fa-check"></i><b>14</b> Introduction to Time Series Regression and Forecasting</a>
<ul>
<li class="chapter" data-level="14.1" data-path="ittsraf.html"><a href="ittsraf.html#using-regression-models-for-forecasting"><i class="fa fa-check"></i><b>14.1</b> Using Regression Models for Forecasting</a></li>
<li class="chapter" data-level="14.2" data-path="ittsraf.html"><a href="ittsraf.html#tsdasc"><i class="fa fa-check"></i><b>14.2</b> Time Series Data and Serial Correlation</a>
<ul>
<li class="chapter" data-level="" data-path="ittsraf.html"><a href="ittsraf.html#notation-lags-differences-logarithms-and-growth-rates"><i class="fa fa-check"></i>Notation, Lags, Differences, Logarithms and Growth Rates</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="ittsraf.html"><a href="ittsraf.html#autoregressions"><i class="fa fa-check"></i><b>14.3</b> Autoregressions</a>
<ul>
<li class="chapter" data-level="" data-path="ittsraf.html"><a href="ittsraf.html#autoregressive-models-of-order-p"><i class="fa fa-check"></i>Autoregressive Models of Order <span class="math inline">\(p\)</span></a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="ittsraf.html"><a href="ittsraf.html#cybtmpi"><i class="fa fa-check"></i><b>14.4</b> Can You Beat the Market? (Part I)</a></li>
<li class="chapter" data-level="14.5" data-path="ittsraf.html"><a href="ittsraf.html#apatadlm"><i class="fa fa-check"></i><b>14.5</b> Additional Predictors and The ADL Model</a>
<ul>
<li class="chapter" data-level="" data-path="ittsraf.html"><a href="ittsraf.html#forecast-uncertainty-and-forecast-intervals"><i class="fa fa-check"></i>Forecast Uncertainty and Forecast Intervals</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="ittsraf.html"><a href="ittsraf.html#llsuic"><i class="fa fa-check"></i><b>14.6</b> Lag Length Selection using Information Criteria</a></li>
<li class="chapter" data-level="14.7" data-path="ittsraf.html"><a href="ittsraf.html#nit"><i class="fa fa-check"></i><b>14.7</b> Nonstationarity I: Trends</a></li>
<li class="chapter" data-level="14.8" data-path="ittsraf.html"><a href="ittsraf.html#niib"><i class="fa fa-check"></i><b>14.8</b> Nonstationarity II: Breaks</a></li>
<li class="chapter" data-level="14.9" data-path="ittsraf.html"><a href="ittsraf.html#can-you-beat-the-market-part-ii"><i class="fa fa-check"></i><b>14.9</b> Can You Beat the Market? (Part II)</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="eodce.html"><a href="eodce.html"><i class="fa fa-check"></i><b>15</b> Estimation of Dynamic Causal Effects</a>
<ul>
<li class="chapter" data-level="15.1" data-path="eodce.html"><a href="eodce.html#the-orange-juice-data"><i class="fa fa-check"></i><b>15.1</b> The Orange Juice Data</a></li>
<li class="chapter" data-level="15.2" data-path="eodce.html"><a href="eodce.html#dynamic-causal-effects"><i class="fa fa-check"></i><b>15.2</b> Dynamic Causal Effects</a></li>
<li class="chapter" data-level="15.3" data-path="eodce.html"><a href="eodce.html#dynamic-multipliers-and-cumulative-dynamic-multipliers"><i class="fa fa-check"></i><b>15.3</b> Dynamic Multipliers and Cumulative Dynamic Multipliers</a></li>
<li class="chapter" data-level="15.4" data-path="eodce.html"><a href="eodce.html#hac-standard-errors"><i class="fa fa-check"></i><b>15.4</b> HAC Standard Errors</a></li>
<li class="chapter" data-level="15.5" data-path="eodce.html"><a href="eodce.html#estimation-of-dynamic-causal-effects-with-strictly-exogeneous-regressors"><i class="fa fa-check"></i><b>15.5</b> Estimation of Dynamic Causal Effects with Strictly Exogeneous Regressors</a></li>
<li class="chapter" data-level="15.6" data-path="eodce.html"><a href="eodce.html#orange-juice-prices-and-cold-weather"><i class="fa fa-check"></i><b>15.6</b> Orange Juice Prices and Cold Weather</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="atitsr.html"><a href="atitsr.html"><i class="fa fa-check"></i><b>16</b> Additional Topics in Time Series Regression</a>
<ul>
<li class="chapter" data-level="16.1" data-path="atitsr.html"><a href="atitsr.html#vector-autoregressions"><i class="fa fa-check"></i><b>16.1</b> Vector Autoregressions</a></li>
<li class="chapter" data-level="16.2" data-path="atitsr.html"><a href="atitsr.html#ooiatdfglsurt"><i class="fa fa-check"></i><b>16.2</b> Orders of Integration and the DF-GLS Unit Root Test</a></li>
<li class="chapter" data-level="16.3" data-path="atitsr.html"><a href="atitsr.html#cointegration"><i class="fa fa-check"></i><b>16.3</b> Cointegration</a></li>
<li class="chapter" data-level="16.4" data-path="atitsr.html"><a href="atitsr.html#volatility-clustering-and-autoregressive-conditional-heteroskedasticity"><i class="fa fa-check"></i><b>16.4</b> Volatility Clustering and Autoregressive Conditional Heteroskedasticity</a>
<ul>
<li class="chapter" data-level="" data-path="atitsr.html"><a href="atitsr.html#arch-and-garch-models"><i class="fa fa-check"></i>ARCH and GARCH Models</a></li>
<li class="chapter" data-level="" data-path="atitsr.html"><a href="atitsr.html#application-to-stock-price-volatility"><i class="fa fa-check"></i>Application to Stock Price Volatility</a></li>
<li class="chapter" data-level="" data-path="atitsr.html"><a href="atitsr.html#summary-8"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Econometrics with R - THIS IS A FORK of the oriinal work</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="eaqe" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">13</span> Experiments and Quasi-Experiments<a href="eaqe.html#eaqe" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter discusses statistical tools that are commonly applied in program evaluation, where interest lies in measuring the causal effects of programs, policies or other interventions. An optimal research design for this purpose is what statisticians call an ideal randomized controlled experiment. The basic idea is to randomly assign subjects to two different groups, one that receives the treatment (the treatment group) and one that does not (the control group) and to compare outcomes for both groups in order to get an estimate of the average treatment effect.</p>
<p>Such <em>experimental</em> data is fundamentally different from <em>observational</em> data. For example, one might use a randomized controlled experiment to measure how much the performance of students in a standardized test differs between two classes where one has a “regular”” student-teacher ratio and the other one has fewer students. The data produced by such an experiment would be different from, e.g., the observed cross-section data on the students’ performance used throughout Chapters <a href="lrwor.html#lrwor">4</a> to <a href="nrf.html#nrf">8</a> where class sizes are not randomly assigned to students but instead are the results of an economic decision where educational objectives and budgetary aspects were balanced.</p>
<p>For economists, randomized controlled experiments are often difficult or even infeasible to implement. For example, due to ethic, moral and legal reasons it is practically impossible for a business owner to estimate the causal effect on the productivity of workers of setting them under psychological stress using an experiment where workers are randomly assigned either to the treatment group that is under time pressure or to the control group where work is under regular conditions, at best without knowledge of being in an experiment (see the box <em>The Hawthorne Effect</em> on p. 528 of the book).</p>
<p>However, sometimes external circumstances produce what is called a <em>quasi-experiment</em> or <em>natural experiment</em>. This “as if” randomness allows for estimation of causal effects that are of interest for economists using tools which are very similar to those valid for ideal randomized controlled experiments. These tools draw heavily on the theory of multiple regression and also on IV regression (see Chapter <a href="ivr.html#ivr">12</a>). We will review the core aspects of these methods and demonstrate how to apply them in R using the STAR data set (see the <a href="https://dataverse.harvard.edu/dataset.xhtml?persistentId=hdl:1902.1/10766">description</a> of the data set).</p>
<p>The following packages and their dependencies are needed for reproduction of the code chunks presented throughout this chapter:</p>
<ul>
<li><tt>AER</tt> <span class="citation">(<a href="#ref-R-AER">Christian Kleiber and Zeileis 2008</a>)</span>,</li>
<li><tt>dplyr</tt> <span class="citation">(<a href="#ref-R-dplyr">Wickham et al. 2023</a>)</span>,</li>
<li><tt>MASS</tt> <span class="citation">(<a href="#ref-R-MASS">Ripley 2023</a>)</span>,</li>
<li><tt>mvtnorm</tt> <span class="citation">(<a href="#ref-R-mvtnorm">Genz et al. 2023</a>)</span>,</li>
<li><tt>rddtools</tt> <span class="citation">(<a href="#ref-R-rddtools">Stigler and Quast 2022</a>)</span>,</li>
<li><tt>scales</tt> <span class="citation">(<a href="#ref-R-scales">Wickham, Pedersen, and Seidel 2023</a>)</span>,</li>
<li><tt>stargazer</tt><span class="citation">(<a href="#ref-R-stargazer">Hlavac 2022</a>)</span>,</li>
<li><tt>tidyr</tt> <span class="citation">(<a href="#ref-R-tidyr">Wickham, Vaughan, and Girlich 2023</a>)</span>.</li>
</ul>
<p>Make sure the following code chunk runs without any errors.</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="eaqe.html#cb307-1" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb307-2"><a href="eaqe.html#cb307-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb307-3"><a href="eaqe.html#cb307-3" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb307-4"><a href="eaqe.html#cb307-4" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb307-5"><a href="eaqe.html#cb307-5" tabindex="-1"></a><span class="fu">library</span>(rddtools)</span>
<span id="cb307-6"><a href="eaqe.html#cb307-6" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb307-7"><a href="eaqe.html#cb307-7" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb307-8"><a href="eaqe.html#cb307-8" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span></code></pre></div>
<div id="poceaie" class="section level2 hasAnchor" number="13.1">
<h2><span class="header-section-number">13.1</span> Potential Outcomes, Causal Effects and Idealized Experiments<a href="eaqe.html#poceaie" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We now briefly recap the idea of the average causal effect and how it can be estimated using the <em>differences estimator</em>. We advise you to work through Chapter 13.1 of the book for a better understanding.</p>
<div id="potential-outcomes-and-the-average-causal-effect" class="section level4 unnumbered hasAnchor">
<h4>Potential Outcomes and the average causal effect<a href="eaqe.html#potential-outcomes-and-the-average-causal-effect" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A <em>potential outcome</em> is the outcome for an individual under a potential treatment. For this individual, the causal effect of the treatment is the difference between the potential outcome if the individual receives the treatment and the potential outcome if she does not. Since this causal effect may be different for different individuals and it is not possible to measure the causal effect for a single individual, one is interested in studying the <em>average causal effect</em> of the treatment, hence also called the <em>average treatment effect</em>.</p>
<p>In an ideal randomized controlled experiment the following conditions are fulfilled:</p>
<ol style="list-style-type: decimal">
<li>The subjects are selected at random from the population.</li>
<li>The subjects are randomly assigned to treatment and control group.</li>
</ol>
<p>Condition 1 guarantees that the subjects’ potential outcomes are drawn randomly from the same population distribution such that the expected value of the causal effect in the sample is equal to the average causal effect in the population. Condition 2 ensures that the receipt of treatment is independent from the subjects’ potential outcomes. If both conditions are fulfilled, the expected causal effect is the expected outcome in the treatment group minus the expected outcome in the control group. Using conditional expectations we have <span class="math display">\[\text{Average causal effect} =  E(Y_i\vert X_i=1) -  E(Y_i\vert X_i=0),\]</span> where <span class="math inline">\(X_i\)</span> is a binary treatment indicator.</p>
<p>The average causal effect can be estimated using the <em>differences estimator</em>, which is nothing but the OLS estimator in the simple regression model
<span class="math display" id="eq:diffest">\[\begin{align}
  Y_i = \beta_0 + \beta_1 X_i + u_i \ \ , \ \ i=1,\dots,n, \tag{13.1}
\end{align}\]</span>
where random assignment ensures that <span class="math inline">\(E(u_i\vert X_i) = 0\)</span>.</p>
<p>The OLS estimator in the regression model
<span class="math display" id="eq:diffestwar">\[\begin{align}
  Y_i = \beta_0 + \beta_1 X_i + \beta_2 W_{1i} + \dots + \beta_{1+r} W_{ri} + u_i \ \ , \ \ i=1,\dots,n \tag{13.2}
\end{align}\]</span>
with additional regressors <span class="math inline">\(W_1,\dots,W_r\)</span> is called the <em>differences estimator with additional regressors</em>. It is assumed that treatment assignment <span class="math inline">\(X_i\)</span> is random and independent of the pretreatment characteristic <span class="math inline">\(W_i\)</span>. This assumption is called <em>conditional mean independence</em> and implies <span class="math display">\[E(u_i\vert X_i , W_i) = E(u_i\vert W_i) = 0,\]</span> so the conditional expectation of the error <span class="math inline">\(u_i\)</span> given the treatment indicator <span class="math inline">\(X_i\)</span> and the pretreatment characteristic <span class="math inline">\(W_i\)</span> does not depend on the <span class="math inline">\(X_i\)</span>. Conditional mean independence replaces the first least squares assumption in Key Concept 6.4 and thus ensures that the differences estimator of <span class="math inline">\(\beta_1\)</span> is unbiased. The <em>differences estimator with additional regressors</em> is more efficient than the <em>differences estimator</em> if the additional regressors explain some of the variation in the <span class="math inline">\(Y_i\)</span>.</p>
</div>
</div>
<div id="threats-to-validity-of-experiments" class="section level2 hasAnchor" number="13.2">
<h2><span class="header-section-number">13.2</span> Threats to Validity of Experiments<a href="eaqe.html#threats-to-validity-of-experiments" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The concepts of internal and external validity discussed in Key Concept 9.1 are also applicable for studies based on experimental and quasi-experimental data. Chapter 13.2 of the book provides a thorough explanation of the particular threats to internal and external validity of experiments including examples. We limit ourselves to a short repetition of the threats listed there. Consult the book for a more detailed explanation.</p>
<div id="threats-to-internal-validity-1" class="section level4 unnumbered hasAnchor">
<h4>Threats to Internal Validity<a href="eaqe.html#threats-to-internal-validity-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li><p><strong>Failure to Randomize</strong></p>
<p>If the subjects are not randomly assigned to the treatment group, then the outcomes will be contaminated with the effect of the subjects’ individual characteristics or preferences and it is not possible to obtain an unbiased estimate of the treatment effect. One can test for nonrandom assignment using a significance test (<span class="math inline">\(F\)</span>-Test) on the coefficients in the regression model <span class="math display">\[X_i = \beta_0 + \beta_1 W_{1i} + \dots +\beta_2 W_{ri} + u_i \ \ , \ \ i=1,\dots,n.\]</span></p></li>
<li><p><strong>Failure to Follow the Treatment Protocol</strong></p>
<p>If subjects do not follow the treatment protocol, i.e., some subjects in the treatment group manage to avoid receiving the treatment and/or some subjects in the control group manage to receive the treatment (<em>partial compliance</em>), there is correlation between <span class="math inline">\(X_i\)</span> und <span class="math inline">\(u_i\)</span> such that the OLS estimator of the average treatment effect will be biased. If there are data on <em>both</em> treatment actually received (<span class="math inline">\(X_i\)</span>) and initial random assignment (<span class="math inline">\(Z_i\)</span>), IV regression of the models <a href="eaqe.html#eq:diffest">(13.1)</a> and <a href="eaqe.html#eq:diffestwar">(13.2)</a> is a remedy.</p></li>
<li><p><strong>Attrition</strong></p>
<p>Attrition may result in a nonrandomly selected sample. If subjects systematically drop out of the study after being assigned to the control or the treatment group (systematic means that the reason of the dropout is related to the treatment) there will be correlation between <span class="math inline">\(X_i\)</span> and <span class="math inline">\(u_i\)</span> and hence bias in the OLS estimator of the treatment effect.</p></li>
<li><p><strong>Experimental Effects</strong></p>
<p>If human subjects in treatment group and/or control group know that they are in an experiment, they might adapt their behaviour in a way that prevents unbiased estimation of the treatment effect.</p></li>
<li><p><strong>Small Sample Sizes</strong></p>
<p>As we know from the theory of linear regression, small sample sizes lead to imprecise estimation of the coefficients and thus imply imprecise estimation of the causal effect. Furthermore, confidence intervals and hypothesis test may produce wrong inference when the sample size is small.</p></li>
</ol>
</div>
<div id="threats-to-external-validity-1" class="section level4 unnumbered hasAnchor">
<h4>Threats to External Validity<a href="eaqe.html#threats-to-external-validity-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li><p><strong>Nonrepresentative Sample</strong></p>
<p>If the population studied and the population of interest are not sufficiently similar, there is no justification in generalizing the results.</p></li>
<li><p><strong>Nonrepresentative Program or Policy</strong></p>
<p>If the program or policy for the population studied differs considerably from the program (to be) applied to population(s) of interest, the results cannot be generalized. For example, a small-scale program with low funding might have different effects than a widely available scaled-up program that is actually implemented. There are other factors like duration and the extent of monitoring that should be considered here.</p></li>
<li><p><strong>General Equilibrium Effects</strong></p>
<p>If market and/or environmental conditions cannot be kept constant when an internally valid program is implemented broadly, external validity may be doubtful.</p></li>
</ol>
</div>
</div>
<div id="experimental-estimates-of-the-effect-of-class-size-reductions" class="section level2 hasAnchor" number="13.3">
<h2><span class="header-section-number">13.3</span> Experimental Estimates of the Effect of Class Size Reductions<a href="eaqe.html#experimental-estimates-of-the-effect-of-class-size-reductions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="experimental-design-and-the-data-set" class="section level3 unnumbered hasAnchor">
<h3>Experimental Design and the Data Set<a href="eaqe.html#experimental-design-and-the-data-set" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Project <em>Student-Teacher Achievement Ratio</em> (STAR) was a large randomized controlled experiment with the aim of asserting whether a class size reduction is effective in improving education outcomes. It was conducted in 80 Tennessee elementary schools over a period of four years during the 1980s by the State Department of Education.</p>
<p>In the first year, about 6400 students were randomly assigned into one of three interventions: small class (13 to 17 students per teacher), regular class (22 to 25 students per teacher), and regular-with-aide class (22 to 25 students with a full-time teacher’s aide). Teachers were also randomly assigned to the classes they taught. The interventions were initiated as the students entered school in kindergarten and continued through to third grade. Control and treatment groups across grades are summarized in Table <a href="eaqe.html#tab:starstructure">13.1</a>.</p>
<table>
<caption><span id="tab:starstructure">Table 13.1: </span> Control and treatment groups in the STAR experiment</caption>
<colgroup>
<col width="16%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>K</th>
<th>1</th>
<th>2</th>
<th>3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Treatment 1</td>
<td>Small class</td>
<td>Small class</td>
<td>Small class</td>
<td>Small class</td>
</tr>
<tr class="even">
<td>Treatment 2</td>
<td>Regular class + aide</td>
<td>Regular class + aide</td>
<td>Regular class + aide</td>
<td>Regular class + aide</td>
</tr>
<tr class="odd">
<td>Control</td>
<td>Regular class</td>
<td>Regular class</td>
<td>Regular class</td>
<td>Regular class</td>
</tr>
</tbody>
</table>
<p>Each year, the students’ learning progress was assessed using the sum of the points scored on the math and reading parts of a standardized test (the <a href="https://en.wikipedia.org/wiki/Stanford_Achievement_Test_Series">Stanford Achievement Test</a>).</p>
<p>The STAR data set is part of the package <tt>AER</tt>.</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="eaqe.html#cb308-1" tabindex="-1"></a><span class="co"># load the package AER and the STAR dataset</span></span>
<span id="cb308-2"><a href="eaqe.html#cb308-2" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb308-3"><a href="eaqe.html#cb308-3" tabindex="-1"></a><span class="fu">data</span>(STAR)</span></code></pre></div>
<p><tt>head(STAR)</tt> shows that there is a variety of factor variables that describe student and teacher characteristics as well as various school indicators, all of which are separately recorded for the four different grades. The data is in <em>wide format</em>. That is, each variable has its own column and for each student, the rows contain observations on these variables. Using <tt>dim(STAR)</tt> we find that there are a total of 11598 observations on 47 variables.</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="eaqe.html#cb309-1" tabindex="-1"></a><span class="co"># get an overview</span></span>
<span id="cb309-2"><a href="eaqe.html#cb309-2" tabindex="-1"></a><span class="fu">head</span>(STAR, <span class="dv">2</span>)</span>
<span id="cb309-3"><a href="eaqe.html#cb309-3" tabindex="-1"></a><span class="co">#&gt;      gender ethnicity   birth stark star1 star2   star3 readk read1 read2 read3</span></span>
<span id="cb309-4"><a href="eaqe.html#cb309-4" tabindex="-1"></a><span class="co">#&gt; 1122 female      afam 1979 Q3  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; regular    NA    NA    NA   580</span></span>
<span id="cb309-5"><a href="eaqe.html#cb309-5" tabindex="-1"></a><span class="co">#&gt; 1137 female      cauc 1980 Q1 small small small   small   447   507   568   587</span></span>
<span id="cb309-6"><a href="eaqe.html#cb309-6" tabindex="-1"></a><span class="co">#&gt;      mathk math1 math2 math3   lunchk lunch1   lunch2 lunch3 schoolk school1</span></span>
<span id="cb309-7"><a href="eaqe.html#cb309-7" tabindex="-1"></a><span class="co">#&gt; 1122    NA    NA    NA   564     &lt;NA&gt;   &lt;NA&gt;     &lt;NA&gt;   free    &lt;NA&gt;    &lt;NA&gt;</span></span>
<span id="cb309-8"><a href="eaqe.html#cb309-8" tabindex="-1"></a><span class="co">#&gt; 1137   473   538   579   593 non-free   free non-free   free   rural   rural</span></span>
<span id="cb309-9"><a href="eaqe.html#cb309-9" tabindex="-1"></a><span class="co">#&gt;      school2  school3  degreek  degree1  degree2  degree3 ladderk ladder1</span></span>
<span id="cb309-10"><a href="eaqe.html#cb309-10" tabindex="-1"></a><span class="co">#&gt; 1122    &lt;NA&gt; suburban     &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt; bachelor    &lt;NA&gt;    &lt;NA&gt;</span></span>
<span id="cb309-11"><a href="eaqe.html#cb309-11" tabindex="-1"></a><span class="co">#&gt; 1137   rural    rural bachelor bachelor bachelor bachelor  level1  level1</span></span>
<span id="cb309-12"><a href="eaqe.html#cb309-12" tabindex="-1"></a><span class="co">#&gt;         ladder2    ladder3 experiencek experience1 experience2 experience3</span></span>
<span id="cb309-13"><a href="eaqe.html#cb309-13" tabindex="-1"></a><span class="co">#&gt; 1122       &lt;NA&gt;     level1          NA          NA          NA          30</span></span>
<span id="cb309-14"><a href="eaqe.html#cb309-14" tabindex="-1"></a><span class="co">#&gt; 1137 apprentice apprentice           7           7           3           1</span></span>
<span id="cb309-15"><a href="eaqe.html#cb309-15" tabindex="-1"></a><span class="co">#&gt;      tethnicityk tethnicity1 tethnicity2 tethnicity3 systemk system1 system2</span></span>
<span id="cb309-16"><a href="eaqe.html#cb309-16" tabindex="-1"></a><span class="co">#&gt; 1122        &lt;NA&gt;        &lt;NA&gt;        &lt;NA&gt;        cauc    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;</span></span>
<span id="cb309-17"><a href="eaqe.html#cb309-17" tabindex="-1"></a><span class="co">#&gt; 1137        cauc        cauc        cauc        cauc      30      30      30</span></span>
<span id="cb309-18"><a href="eaqe.html#cb309-18" tabindex="-1"></a><span class="co">#&gt;      system3 schoolidk schoolid1 schoolid2 schoolid3</span></span>
<span id="cb309-19"><a href="eaqe.html#cb309-19" tabindex="-1"></a><span class="co">#&gt; 1122      22      &lt;NA&gt;      &lt;NA&gt;      &lt;NA&gt;        54</span></span>
<span id="cb309-20"><a href="eaqe.html#cb309-20" tabindex="-1"></a><span class="co">#&gt; 1137      30        63        63        63        63</span></span>
<span id="cb309-21"><a href="eaqe.html#cb309-21" tabindex="-1"></a><span class="fu">dim</span>(STAR)</span>
<span id="cb309-22"><a href="eaqe.html#cb309-22" tabindex="-1"></a><span class="co">#&gt; [1] 11598    47</span></span></code></pre></div>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="eaqe.html#cb310-1" tabindex="-1"></a><span class="co"># get variable names</span></span>
<span id="cb310-2"><a href="eaqe.html#cb310-2" tabindex="-1"></a><span class="fu">names</span>(STAR)</span>
<span id="cb310-3"><a href="eaqe.html#cb310-3" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;gender&quot;      &quot;ethnicity&quot;   &quot;birth&quot;       &quot;stark&quot;       &quot;star1&quot;      </span></span>
<span id="cb310-4"><a href="eaqe.html#cb310-4" tabindex="-1"></a><span class="co">#&gt;  [6] &quot;star2&quot;       &quot;star3&quot;       &quot;readk&quot;       &quot;read1&quot;       &quot;read2&quot;      </span></span>
<span id="cb310-5"><a href="eaqe.html#cb310-5" tabindex="-1"></a><span class="co">#&gt; [11] &quot;read3&quot;       &quot;mathk&quot;       &quot;math1&quot;       &quot;math2&quot;       &quot;math3&quot;      </span></span>
<span id="cb310-6"><a href="eaqe.html#cb310-6" tabindex="-1"></a><span class="co">#&gt; [16] &quot;lunchk&quot;      &quot;lunch1&quot;      &quot;lunch2&quot;      &quot;lunch3&quot;      &quot;schoolk&quot;    </span></span>
<span id="cb310-7"><a href="eaqe.html#cb310-7" tabindex="-1"></a><span class="co">#&gt; [21] &quot;school1&quot;     &quot;school2&quot;     &quot;school3&quot;     &quot;degreek&quot;     &quot;degree1&quot;    </span></span>
<span id="cb310-8"><a href="eaqe.html#cb310-8" tabindex="-1"></a><span class="co">#&gt; [26] &quot;degree2&quot;     &quot;degree3&quot;     &quot;ladderk&quot;     &quot;ladder1&quot;     &quot;ladder2&quot;    </span></span>
<span id="cb310-9"><a href="eaqe.html#cb310-9" tabindex="-1"></a><span class="co">#&gt; [31] &quot;ladder3&quot;     &quot;experiencek&quot; &quot;experience1&quot; &quot;experience2&quot; &quot;experience3&quot;</span></span>
<span id="cb310-10"><a href="eaqe.html#cb310-10" tabindex="-1"></a><span class="co">#&gt; [36] &quot;tethnicityk&quot; &quot;tethnicity1&quot; &quot;tethnicity2&quot; &quot;tethnicity3&quot; &quot;systemk&quot;    </span></span>
<span id="cb310-11"><a href="eaqe.html#cb310-11" tabindex="-1"></a><span class="co">#&gt; [41] &quot;system1&quot;     &quot;system2&quot;     &quot;system3&quot;     &quot;schoolidk&quot;   &quot;schoolid1&quot;  </span></span>
<span id="cb310-12"><a href="eaqe.html#cb310-12" tabindex="-1"></a><span class="co">#&gt; [46] &quot;schoolid2&quot;   &quot;schoolid3&quot;</span></span></code></pre></div>
<p>A majority of the variable names contain a suffix (<tt>k</tt>, <tt>1</tt>, <tt>2</tt> or <tt>3</tt>) stating the grade which the respective variable is referring to. This facilitates regression analysis because it allows to adjust the <tt>formula</tt> argument in <tt>lm()</tt> for each grade by simply changing the variables’ suffixes accordingly.</p>
<p>The outcome produced by <tt>head()</tt> shows that some recorded values are <tt>NA</tt> and thus, there is no data on this variable for the student under consideration. This lies in the nature of the data: for example, take the first observation <code>STAR[1,]</code>.</p>
<p>In the output of <code>head(STAR, 2)</code> we find that the student entered the experiment in third grade in a regular class, which is why the class size is recorded in <tt>star3</tt> and the other class type indicator variables are <tt>NA</tt>. Her math and reading scores for the third grade are available; however, recordings for other grades are not present for the same reason. Obtaining only her non-missing (non-<tt>NA</tt>) recordings is straightforward: simply eliminate the <tt>NA</tt>s using the <tt>!is.na()</tt> function.</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="eaqe.html#cb311-1" tabindex="-1"></a><span class="co"># drop NA recordings for the first observation and print to the console</span></span>
<span id="cb311-2"><a href="eaqe.html#cb311-2" tabindex="-1"></a>STAR[<span class="dv">1</span>, <span class="sc">!</span><span class="fu">is.na</span>(STAR[<span class="dv">1</span>, ])]</span>
<span id="cb311-3"><a href="eaqe.html#cb311-3" tabindex="-1"></a><span class="co">#&gt;      gender ethnicity   birth   star3 read3 math3 lunch3  school3  degree3</span></span>
<span id="cb311-4"><a href="eaqe.html#cb311-4" tabindex="-1"></a><span class="co">#&gt; 1122 female      afam 1979 Q3 regular   580   564   free suburban bachelor</span></span>
<span id="cb311-5"><a href="eaqe.html#cb311-5" tabindex="-1"></a><span class="co">#&gt;      ladder3 experience3 tethnicity3 system3 schoolid3</span></span>
<span id="cb311-6"><a href="eaqe.html#cb311-6" tabindex="-1"></a><span class="co">#&gt; 1122  level1          30        cauc      22        54</span></span></code></pre></div>
<p><code>is.na(STAR[1, ])</code> returns a logical vector with <tt>TRUE</tt> at positions that correspond to <tt><NA></tt> entries for the first observation. The <tt>!</tt> operator is used to invert the result such that we obtain only non-<tt><NA></tt> entries for the first observations.</p>
<p>In general it is not necessary to remove rows with missing data because <tt>lm()</tt> does so by default. Missing data may imply a small sample size and thus may lead to imprecise estimation and wrong inference. This is, however, not an issue for the study at hand since, as we will see below, sample sizes lie beyond 5000 observations for each regression conducted.</p>
</div>
<div id="analysis-of-the-star-data" class="section level3 unnumbered hasAnchor">
<h3>Analysis of the STAR Data<a href="eaqe.html#analysis-of-the-star-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As can be seen from Table <a href="eaqe.html#tab:starstructure">13.1</a> that there are two treatment groups in each grade, small classes with only 13 to 17 students and regular classes with 22 to 25 students and a teaching aide. Thus, two binary variables, each being an indicator for the respective treatment group, are introduced for the differences estimator to capture the treatment effect for each treatment group separately. This yields the population regression model
<span class="math display" id="eq:starpopreg">\[\begin{align}
  Y_i = \beta_0 + \beta_1 SmallClass_i + \beta_2 RegAide_i + u_i, \tag{13.3}
\end{align}\]</span>
with test score <span class="math inline">\(Y_i\)</span> which is the small class indicator <span class="math inline">\(SmallClass_i\)</span> and <span class="math inline">\(RegAide_i\)</span> which is the indicator for a regular class with aide.</p>
<p>We reproduce the results presented in Table 13.1 of the book by performing the regression <a href="eaqe.html#eq:starpopreg">(13.3)</a> for each grade separately. For each student, the dependent variable is simply the sum of the points scored in the math and reading parts, constructed using <tt>I()</tt>.</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="eaqe.html#cb312-1" tabindex="-1"></a><span class="co"># compute differences Estimates for each grades</span></span>
<span id="cb312-2"><a href="eaqe.html#cb312-2" tabindex="-1"></a>fmk <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">I</span>(readk <span class="sc">+</span> mathk) <span class="sc">~</span> stark, <span class="at">data =</span> STAR)</span>
<span id="cb312-3"><a href="eaqe.html#cb312-3" tabindex="-1"></a>fm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">I</span>(read1 <span class="sc">+</span> math1) <span class="sc">~</span> star1, <span class="at">data =</span> STAR)</span>
<span id="cb312-4"><a href="eaqe.html#cb312-4" tabindex="-1"></a>fm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">I</span>(read2 <span class="sc">+</span> math2) <span class="sc">~</span> star2, <span class="at">data =</span> STAR)</span>
<span id="cb312-5"><a href="eaqe.html#cb312-5" tabindex="-1"></a>fm3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">I</span>(read3 <span class="sc">+</span> math3) <span class="sc">~</span> star3, <span class="at">data =</span> STAR)</span></code></pre></div>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="eaqe.html#cb313-1" tabindex="-1"></a><span class="co"># obtain coefficient matrix using robust standard errors</span></span>
<span id="cb313-2"><a href="eaqe.html#cb313-2" tabindex="-1"></a><span class="fu">coeftest</span>(fmk, <span class="at">vcov =</span> vcovHC, <span class="at">type=</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb313-3"><a href="eaqe.html#cb313-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb313-4"><a href="eaqe.html#cb313-4" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb313-5"><a href="eaqe.html#cb313-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb313-6"><a href="eaqe.html#cb313-6" tabindex="-1"></a><span class="co">#&gt;                    Estimate Std. Error  t value  Pr(&gt;|t|)    </span></span>
<span id="cb313-7"><a href="eaqe.html#cb313-7" tabindex="-1"></a><span class="co">#&gt; (Intercept)       918.04289    1.63339 562.0473 &lt; 2.2e-16 ***</span></span>
<span id="cb313-8"><a href="eaqe.html#cb313-8" tabindex="-1"></a><span class="co">#&gt; starksmall         13.89899    2.45409   5.6636 1.554e-08 ***</span></span>
<span id="cb313-9"><a href="eaqe.html#cb313-9" tabindex="-1"></a><span class="co">#&gt; starkregular+aide   0.31394    2.27098   0.1382    0.8901    </span></span>
<span id="cb313-10"><a href="eaqe.html#cb313-10" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb313-11"><a href="eaqe.html#cb313-11" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb313-12"><a href="eaqe.html#cb313-12" tabindex="-1"></a><span class="fu">coeftest</span>(fm1, <span class="at">vcov =</span> vcovHC, <span class="at">type=</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb313-13"><a href="eaqe.html#cb313-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb313-14"><a href="eaqe.html#cb313-14" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb313-15"><a href="eaqe.html#cb313-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb313-16"><a href="eaqe.html#cb313-16" tabindex="-1"></a><span class="co">#&gt;                    Estimate Std. Error  t value  Pr(&gt;|t|)    </span></span>
<span id="cb313-17"><a href="eaqe.html#cb313-17" tabindex="-1"></a><span class="co">#&gt; (Intercept)       1039.3926     1.7846 582.4321 &lt; 2.2e-16 ***</span></span>
<span id="cb313-18"><a href="eaqe.html#cb313-18" tabindex="-1"></a><span class="co">#&gt; star1small          29.7808     2.8311  10.5190 &lt; 2.2e-16 ***</span></span>
<span id="cb313-19"><a href="eaqe.html#cb313-19" tabindex="-1"></a><span class="co">#&gt; star1regular+aide   11.9587     2.6520   4.5093  6.62e-06 ***</span></span>
<span id="cb313-20"><a href="eaqe.html#cb313-20" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb313-21"><a href="eaqe.html#cb313-21" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb313-22"><a href="eaqe.html#cb313-22" tabindex="-1"></a><span class="fu">coeftest</span>(fm2, <span class="at">vcov =</span> vcovHC, <span class="at">type=</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb313-23"><a href="eaqe.html#cb313-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb313-24"><a href="eaqe.html#cb313-24" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb313-25"><a href="eaqe.html#cb313-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb313-26"><a href="eaqe.html#cb313-26" tabindex="-1"></a><span class="co">#&gt;                    Estimate Std. Error  t value  Pr(&gt;|t|)    </span></span>
<span id="cb313-27"><a href="eaqe.html#cb313-27" tabindex="-1"></a><span class="co">#&gt; (Intercept)       1157.8066     1.8151 637.8820 &lt; 2.2e-16 ***</span></span>
<span id="cb313-28"><a href="eaqe.html#cb313-28" tabindex="-1"></a><span class="co">#&gt; star2small          19.3944     2.7117   7.1522  9.55e-13 ***</span></span>
<span id="cb313-29"><a href="eaqe.html#cb313-29" tabindex="-1"></a><span class="co">#&gt; star2regular+aide    3.4791     2.5447   1.3672    0.1716    </span></span>
<span id="cb313-30"><a href="eaqe.html#cb313-30" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb313-31"><a href="eaqe.html#cb313-31" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb313-32"><a href="eaqe.html#cb313-32" tabindex="-1"></a><span class="fu">coeftest</span>(fm3, <span class="at">vcov =</span> vcovHC, <span class="at">type=</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb313-33"><a href="eaqe.html#cb313-33" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb313-34"><a href="eaqe.html#cb313-34" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb313-35"><a href="eaqe.html#cb313-35" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb313-36"><a href="eaqe.html#cb313-36" tabindex="-1"></a><span class="co">#&gt;                     Estimate Std. Error  t value  Pr(&gt;|t|)    </span></span>
<span id="cb313-37"><a href="eaqe.html#cb313-37" tabindex="-1"></a><span class="co">#&gt; (Intercept)       1228.50636    1.68001 731.2483 &lt; 2.2e-16 ***</span></span>
<span id="cb313-38"><a href="eaqe.html#cb313-38" tabindex="-1"></a><span class="co">#&gt; star3small          15.58660    2.39604   6.5051 8.393e-11 ***</span></span>
<span id="cb313-39"><a href="eaqe.html#cb313-39" tabindex="-1"></a><span class="co">#&gt; star3regular+aide   -0.29094    2.27271  -0.1280    0.8981    </span></span>
<span id="cb313-40"><a href="eaqe.html#cb313-40" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb313-41"><a href="eaqe.html#cb313-41" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>We gather the results and present them in a table using <tt>stargazer()</tt>.</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="eaqe.html#cb314-1" tabindex="-1"></a><span class="co"># compute robust standard errors for each model and gather them in a list</span></span>
<span id="cb314-2"><a href="eaqe.html#cb314-2" tabindex="-1"></a>rob_se_1 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(fmk, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb314-3"><a href="eaqe.html#cb314-3" tabindex="-1"></a>                 <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(fm1, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb314-4"><a href="eaqe.html#cb314-4" tabindex="-1"></a>                 <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(fm2, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb314-5"><a href="eaqe.html#cb314-5" tabindex="-1"></a>                 <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(fm3, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))))</span></code></pre></div>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="eaqe.html#cb315-1" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb315-2"><a href="eaqe.html#cb315-2" tabindex="-1"></a></span>
<span id="cb315-3"><a href="eaqe.html#cb315-3" tabindex="-1"></a><span class="fu">stargazer</span>(fmk,fm1,fm2,fm3,</span>
<span id="cb315-4"><a href="eaqe.html#cb315-4" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Project STAR: Differences Estimates&quot;</span>,</span>
<span id="cb315-5"><a href="eaqe.html#cb315-5" tabindex="-1"></a>  <span class="at">header =</span> <span class="cn">FALSE</span>, </span>
<span id="cb315-6"><a href="eaqe.html#cb315-6" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>,</span>
<span id="cb315-7"><a href="eaqe.html#cb315-7" tabindex="-1"></a>  <span class="at">model.numbers =</span> F,</span>
<span id="cb315-8"><a href="eaqe.html#cb315-8" tabindex="-1"></a>  <span class="at">omit.table.layout =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb315-9"><a href="eaqe.html#cb315-9" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">3</span>, </span>
<span id="cb315-10"><a href="eaqe.html#cb315-10" tabindex="-1"></a>  <span class="at">column.labels =</span> <span class="fu">c</span>(<span class="st">&quot;K&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>),</span>
<span id="cb315-11"><a href="eaqe.html#cb315-11" tabindex="-1"></a>  <span class="at">dep.var.caption  =</span> <span class="st">&quot;Dependent Variable: Grade&quot;</span>,</span>
<span id="cb315-12"><a href="eaqe.html#cb315-12" tabindex="-1"></a>  <span class="at">dep.var.labels.include =</span> <span class="cn">FALSE</span>,</span>
<span id="cb315-13"><a href="eaqe.html#cb315-13" tabindex="-1"></a>  <span class="at">se =</span> rob_se_1)</span></code></pre></div>



<table style="text-align:center"><tr><td colspan="5" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"></td><td colspan="4">Dependent Variable: Grade</td></tr>
<tr><td></td><td colspan="4" style="border-bottom: 1px solid black"></td></tr>
<tr><td style="text-align:left"></td><td>K</td><td>1</td><td>2</td><td>3</td></tr>
<tr><td colspan="5" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">starksmall</td><td>13.90<sup>***</sup></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left"></td><td>(2.45)</td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">starkregular+aide</td><td>0.31</td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left"></td><td>(2.27)</td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">star1small</td><td></td><td>29.78<sup>***</sup></td><td></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.83)</td><td></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">star1regular+aide</td><td></td><td>11.96<sup>***</sup></td><td></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(2.65)</td><td></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">star2small</td><td></td><td></td><td>19.39<sup>***</sup></td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td>(2.71)</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">star2regular+aide</td><td></td><td></td><td>3.48</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td>(2.54)</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">star3small</td><td></td><td></td><td></td><td>15.59<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td>(2.40)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">star3regular+aide</td><td></td><td></td><td></td><td>-0.29</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td>(2.27)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">Constant</td><td>918.04<sup>***</sup></td><td>1,039.39<sup>***</sup></td><td>1,157.81<sup>***</sup></td><td>1,228.51<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(1.63)</td><td>(1.78)</td><td>(1.82)</td><td>(1.68)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td colspan="5" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">Observations</td><td>5,786</td><td>6,379</td><td>6,049</td><td>5,967</td></tr>
<tr><td style="text-align:left">R<sup>2</sup></td><td>0.01</td><td>0.02</td><td>0.01</td><td>0.01</td></tr>
<tr><td style="text-align:left">Adjusted R<sup>2</sup></td><td>0.01</td><td>0.02</td><td>0.01</td><td>0.01</td></tr>
<tr><td style="text-align:left">Residual Std. Error</td><td>73.49 (df = 5783)</td><td>90.50 (df = 6376)</td><td>83.69 (df = 6046)</td><td>72.91 (df = 5964)</td></tr>
<tr><td style="text-align:left">F Statistic</td><td>21.26<sup>***</sup> (df = 2; 5783)</td><td>56.34<sup>***</sup> (df = 2; 6376)</td><td>28.71<sup>***</sup> (df = 2; 6046)</td><td>30.25<sup>***</sup> (df = 2; 5964)</td></tr>
<tr><td colspan="5" style="border-bottom: 1px solid black"></td></tr></table>
<caption><p style='text-align:center'><span id="tab:psde">Table 13.2: </span> Project STAR - Differences Estimates</p></caption>


<p>The estimates presented in Table <a href="eaqe.html#tab:psde">13.2</a> suggest that the class size reduction improves student performance. Except for grade 1, the estimates of the coefficient on <span class="math inline">\(SmallClass\)</span> are roughly of the same magnitude (the estimates lie between 13.90 and 19.39 points) and they are statistically significant at <span class="math inline">\(1\%\)</span>. Furthermore, a teaching aide has little, possibly zero, effect on the performance of the students.</p>
<p>Following the book, we augment the regression model <a href="eaqe.html#eq:starpopreg">(13.3)</a> by different sets of regressors for two reasons:</p>
<ol style="list-style-type: decimal">
<li>If the additional regressors explain some of the observed variation in the dependent variable, we obtain more efficient estimates of the coefficients of interest.</li>
<li>If the treatment is not received at random due to failures to follow the treatment protocol (see Chapter 13.3 of the book), the estimates obtained using <a href="eaqe.html#eq:starpopreg">(13.3)</a> may be biased. Adding additional regressors may solve or mitigate this problem.</li>
</ol>
<p>In particular, we consider the following student and teacher characteristics</p>
<ul>
<li><span class="math inline">\(experience\)</span> — Teacher’s years of experience</li>
<li><span class="math inline">\(boy\)</span> — Student is a boy (dummy)</li>
<li><span class="math inline">\(lunch\)</span> — Free lunch eligibility (dummy)</li>
<li><span class="math inline">\(black\)</span> — Student is African-American (dummy)</li>
<li><span class="math inline">\(race\)</span> — Student’s race is other than black or white (dummy)</li>
<li><span class="math inline">\(\text{schoolid}\)</span> — School indicator variables</li>
</ul>
<p>in the four population regression specifications
<span class="math display" id="eq:augstarpopreg3" id="eq:augstarpopreg2" id="eq:augstarpopreg1">\[\begin{align}
Y_i =&amp; \beta_0 + \beta_1 SmallClass_i + \beta_2 RegAide_i + u_i, \tag{13.4} \\
Y_i =&amp; \beta_0 + \beta_1 SmallClass_i + \beta_2 RegAide_i + \beta_3 experience_i + u_i, \tag{13.5} \\
Y_i =&amp; \beta_0 + \beta_1 SmallClass_i + \beta_2 RegAide_i + \beta_3 experience_i + schoolid + u_i, \tag{13.6}
\end{align}\]</span>
and
<span class="math display" id="eq:augstarpopreg4">\[\begin{align}
Y_i =&amp; \beta_0 + \beta_1 SmallClass_i + \beta_2 RegAide_i + \beta_3 experience_i + \beta_4 boy + \beta_5 lunch \\
&amp; + \beta_6 black + \beta_7 race + schoolid + u_i. \tag{13.7}
\end{align}\]</span></p>
<p>Prior to estimation, we perform some subsetting and data wrangling using functions from the packages <tt>dplyr</tt> and <tt>tidyr</tt>. These are both part of <tt>tidyverse</tt>, a collection of <tt>R</tt> packages designed for data science and handling big datasets (see the <a href="https://www.tidyverse.org/">official site</a> for more on <tt>tidyverse</tt> packages). The functions <tt>%&gt;%</tt>, <tt>transmute()</tt> and <tt>mutate()</tt> are sufficient for us here:</p>
<ul>
<li><tt>%&gt;%</tt> allows to chain function calls.</li>
<li><tt>transmute()</tt> allows to subset the data set by naming the variables to be kept.</li>
<li><tt>mutate()</tt> is convenient for adding new variables based on existing ones while preserving the latter.</li>
</ul>
<p>The regression models <a href="eaqe.html#eq:augstarpopreg1">(13.4)</a> to <a href="eaqe.html#eq:augstarpopreg4">(13.7)</a> require the variables <tt>gender</tt>, <tt>ethnicity</tt>, <tt>stark</tt>, <tt>readk</tt>, <tt>mathk</tt>, <tt>lunchk</tt>, <tt>experiencek</tt> and <tt>schoolidk</tt>. After dropping the remaining variables using <tt>transmute()</tt>, we use <tt>mutate()</tt> to add three additional binary variables which are derivatives of existing ones: <tt>black</tt>, <tt>race</tt> and <tt>boy</tt>. They are generated using logical statements within the function <tt>ifelse()</tt>.</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="eaqe.html#cb316-1" tabindex="-1"></a><span class="co"># load packages &#39;dplyr&#39; and &#39;tidyr&#39; for data wrangling functionalities</span></span>
<span id="cb316-2"><a href="eaqe.html#cb316-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb316-3"><a href="eaqe.html#cb316-3" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb316-4"><a href="eaqe.html#cb316-4" tabindex="-1"></a></span>
<span id="cb316-5"><a href="eaqe.html#cb316-5" tabindex="-1"></a><span class="co"># generate subset with kindergarten data</span></span>
<span id="cb316-6"><a href="eaqe.html#cb316-6" tabindex="-1"></a>STARK <span class="ot">&lt;-</span> STAR <span class="sc">%&gt;%</span> </span>
<span id="cb316-7"><a href="eaqe.html#cb316-7" tabindex="-1"></a>      <span class="fu">transmute</span>(gender,</span>
<span id="cb316-8"><a href="eaqe.html#cb316-8" tabindex="-1"></a>                ethnicity,</span>
<span id="cb316-9"><a href="eaqe.html#cb316-9" tabindex="-1"></a>                stark,</span>
<span id="cb316-10"><a href="eaqe.html#cb316-10" tabindex="-1"></a>                readk,</span>
<span id="cb316-11"><a href="eaqe.html#cb316-11" tabindex="-1"></a>                mathk,</span>
<span id="cb316-12"><a href="eaqe.html#cb316-12" tabindex="-1"></a>                lunchk,</span>
<span id="cb316-13"><a href="eaqe.html#cb316-13" tabindex="-1"></a>                experiencek,</span>
<span id="cb316-14"><a href="eaqe.html#cb316-14" tabindex="-1"></a>                schoolidk) <span class="sc">%&gt;%</span> </span>
<span id="cb316-15"><a href="eaqe.html#cb316-15" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">black =</span> <span class="fu">ifelse</span>(ethnicity <span class="sc">==</span> <span class="st">&quot;afam&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb316-16"><a href="eaqe.html#cb316-16" tabindex="-1"></a>             <span class="at">race =</span> <span class="fu">ifelse</span>(ethnicity <span class="sc">==</span> <span class="st">&quot;afam&quot;</span> <span class="sc">|</span> ethnicity <span class="sc">==</span> <span class="st">&quot;cauc&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb316-17"><a href="eaqe.html#cb316-17" tabindex="-1"></a>             <span class="at">boy =</span> <span class="fu">ifelse</span>(gender <span class="sc">==</span> <span class="st">&quot;male&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span></code></pre></div>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="eaqe.html#cb317-1" tabindex="-1"></a><span class="co"># estimate the models </span></span>
<span id="cb317-2"><a href="eaqe.html#cb317-2" tabindex="-1"></a>gradeK1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">I</span>(mathk <span class="sc">+</span> readk) <span class="sc">~</span> stark <span class="sc">+</span> experiencek, </span>
<span id="cb317-3"><a href="eaqe.html#cb317-3" tabindex="-1"></a>              <span class="at">data =</span> STARK)</span>
<span id="cb317-4"><a href="eaqe.html#cb317-4" tabindex="-1"></a></span>
<span id="cb317-5"><a href="eaqe.html#cb317-5" tabindex="-1"></a>gradeK2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">I</span>(mathk <span class="sc">+</span> readk) <span class="sc">~</span> stark <span class="sc">+</span> experiencek <span class="sc">+</span> schoolidk, </span>
<span id="cb317-6"><a href="eaqe.html#cb317-6" tabindex="-1"></a>              <span class="at">data =</span> STARK)</span>
<span id="cb317-7"><a href="eaqe.html#cb317-7" tabindex="-1"></a></span>
<span id="cb317-8"><a href="eaqe.html#cb317-8" tabindex="-1"></a>gradeK3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">I</span>(mathk <span class="sc">+</span> readk) <span class="sc">~</span> stark <span class="sc">+</span> experiencek <span class="sc">+</span> boy <span class="sc">+</span> lunchk </span>
<span id="cb317-9"><a href="eaqe.html#cb317-9" tabindex="-1"></a>              <span class="sc">+</span> black <span class="sc">+</span> race <span class="sc">+</span> schoolidk, </span>
<span id="cb317-10"><a href="eaqe.html#cb317-10" tabindex="-1"></a>              <span class="at">data =</span> STARK)</span></code></pre></div>
<p>For brevity, we exclude the coefficients for the indicator dummies in the output of the <tt>coeftest()</tt>by subsetting the matrices.</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="eaqe.html#cb318-1" tabindex="-1"></a><span class="co"># obtain robust inference on the significance of coefficients</span></span>
<span id="cb318-2"><a href="eaqe.html#cb318-2" tabindex="-1"></a><span class="fu">coeftest</span>(gradeK1, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb318-3"><a href="eaqe.html#cb318-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb318-4"><a href="eaqe.html#cb318-4" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb318-5"><a href="eaqe.html#cb318-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb318-6"><a href="eaqe.html#cb318-6" tabindex="-1"></a><span class="co">#&gt;                    Estimate Std. Error  t value  Pr(&gt;|t|)    </span></span>
<span id="cb318-7"><a href="eaqe.html#cb318-7" tabindex="-1"></a><span class="co">#&gt; (Intercept)       904.72124    2.22235 407.1020 &lt; 2.2e-16 ***</span></span>
<span id="cb318-8"><a href="eaqe.html#cb318-8" tabindex="-1"></a><span class="co">#&gt; starksmall         14.00613    2.44704   5.7237 1.095e-08 ***</span></span>
<span id="cb318-9"><a href="eaqe.html#cb318-9" tabindex="-1"></a><span class="co">#&gt; starkregular+aide  -0.60058    2.25430  -0.2664    0.7899    </span></span>
<span id="cb318-10"><a href="eaqe.html#cb318-10" tabindex="-1"></a><span class="co">#&gt; experiencek         1.46903    0.16929   8.6778 &lt; 2.2e-16 ***</span></span>
<span id="cb318-11"><a href="eaqe.html#cb318-11" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb318-12"><a href="eaqe.html#cb318-12" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb318-13"><a href="eaqe.html#cb318-13" tabindex="-1"></a><span class="fu">coeftest</span>(gradeK2, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, ]</span>
<span id="cb318-14"><a href="eaqe.html#cb318-14" tabindex="-1"></a><span class="co">#&gt;                      Estimate Std. Error     t value     Pr(&gt;|t|)</span></span>
<span id="cb318-15"><a href="eaqe.html#cb318-15" tabindex="-1"></a><span class="co">#&gt; (Intercept)       925.6748750  7.6527218 120.9602155 0.000000e+00</span></span>
<span id="cb318-16"><a href="eaqe.html#cb318-16" tabindex="-1"></a><span class="co">#&gt; starksmall         15.9330822  2.2411750   7.1092540 1.310324e-12</span></span>
<span id="cb318-17"><a href="eaqe.html#cb318-17" tabindex="-1"></a><span class="co">#&gt; starkregular+aide   1.2151960  2.0353415   0.5970477 5.504993e-01</span></span>
<span id="cb318-18"><a href="eaqe.html#cb318-18" tabindex="-1"></a><span class="co">#&gt; experiencek         0.7431059  0.1697619   4.3773429 1.222880e-05</span></span>
<span id="cb318-19"><a href="eaqe.html#cb318-19" tabindex="-1"></a><span class="fu">coeftest</span>(gradeK3, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, ]</span>
<span id="cb318-20"><a href="eaqe.html#cb318-20" tabindex="-1"></a><span class="co">#&gt;                      Estimate Std. Error     t value     Pr(&gt;|t|)</span></span>
<span id="cb318-21"><a href="eaqe.html#cb318-21" tabindex="-1"></a><span class="co">#&gt; (Intercept)       937.6831330 14.3726687  65.2407117 0.000000e+00</span></span>
<span id="cb318-22"><a href="eaqe.html#cb318-22" tabindex="-1"></a><span class="co">#&gt; starksmall         15.8900507  2.1551817   7.3729516 1.908960e-13</span></span>
<span id="cb318-23"><a href="eaqe.html#cb318-23" tabindex="-1"></a><span class="co">#&gt; starkregular+aide   1.7869378  1.9614592   0.9110247 3.623211e-01</span></span>
<span id="cb318-24"><a href="eaqe.html#cb318-24" tabindex="-1"></a><span class="co">#&gt; experiencek         0.6627251  0.1659298   3.9940097 6.578846e-05</span></span>
<span id="cb318-25"><a href="eaqe.html#cb318-25" tabindex="-1"></a><span class="co">#&gt; boy               -12.0905123  1.6726331  -7.2284306 5.533119e-13</span></span>
<span id="cb318-26"><a href="eaqe.html#cb318-26" tabindex="-1"></a><span class="co">#&gt; lunchkfree        -34.7033021  1.9870366 -17.4648529 1.437931e-66</span></span>
<span id="cb318-27"><a href="eaqe.html#cb318-27" tabindex="-1"></a><span class="co">#&gt; black             -25.4305130  3.4986918  -7.2685776 4.125252e-13</span></span></code></pre></div>
<p>We now use <tt>stargazer()</tt> to gather all relevant information in a structured table.</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="eaqe.html#cb319-1" tabindex="-1"></a><span class="co"># compute robust standard errors for each model and gather them in a list</span></span>
<span id="cb319-2"><a href="eaqe.html#cb319-2" tabindex="-1"></a>rob_se_2 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(fmk, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb319-3"><a href="eaqe.html#cb319-3" tabindex="-1"></a>                 <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(gradeK1, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb319-4"><a href="eaqe.html#cb319-4" tabindex="-1"></a>                 <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(gradeK2, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb319-5"><a href="eaqe.html#cb319-5" tabindex="-1"></a>                 <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(gradeK3, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))))</span></code></pre></div>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="eaqe.html#cb320-1" tabindex="-1"></a><span class="fu">stargazer</span>(fmk, gradeK1, gradeK2, gradeK3,</span>
<span id="cb320-2"><a href="eaqe.html#cb320-2" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Project STAR - Differences Estimates with </span></span>
<span id="cb320-3"><a href="eaqe.html#cb320-3" tabindex="-1"></a><span class="st">  Additional Regressors for Kindergarten&quot;</span>,</span>
<span id="cb320-4"><a href="eaqe.html#cb320-4" tabindex="-1"></a>  <span class="at">header =</span> <span class="cn">FALSE</span>, </span>
<span id="cb320-5"><a href="eaqe.html#cb320-5" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>,</span>
<span id="cb320-6"><a href="eaqe.html#cb320-6" tabindex="-1"></a>  <span class="at">model.numbers =</span> F,</span>
<span id="cb320-7"><a href="eaqe.html#cb320-7" tabindex="-1"></a>  <span class="at">omit.table.layout =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb320-8"><a href="eaqe.html#cb320-8" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">3</span>, </span>
<span id="cb320-9"><a href="eaqe.html#cb320-9" tabindex="-1"></a>  <span class="at">column.labels =</span> <span class="fu">c</span>(<span class="st">&quot;(1)&quot;</span>, <span class="st">&quot;(2)&quot;</span>, <span class="st">&quot;(3)&quot;</span>, <span class="st">&quot;(4)&quot;</span>),</span>
<span id="cb320-10"><a href="eaqe.html#cb320-10" tabindex="-1"></a>  <span class="at">dep.var.caption  =</span> <span class="st">&quot;Dependent Variable: Test Score in Kindergarten&quot;</span>,</span>
<span id="cb320-11"><a href="eaqe.html#cb320-11" tabindex="-1"></a>  <span class="at">dep.var.labels.include =</span> <span class="cn">FALSE</span>,</span>
<span id="cb320-12"><a href="eaqe.html#cb320-12" tabindex="-1"></a>  <span class="at">se =</span> rob_se_2) </span></code></pre></div>



<table style="text-align:center"><tr><td colspan="5" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"></td><td colspan="4">Dependent Variable: Test Score in Kindergarten</td></tr>
<tr><td></td><td colspan="4" style="border-bottom: 1px solid black"></td></tr>
<tr><td style="text-align:left"></td><td>(1)</td><td>(2)</td><td>(3)</td><td>(4)</td></tr>
<tr><td colspan="5" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">starksmall</td><td>13.899<sup>***</sup></td><td>14.006<sup>***</sup></td><td>15.933<sup>***</sup></td><td>15.890<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(2.454)</td><td>(2.447)</td><td>(2.241)</td><td>(2.155)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">starkregular+aide</td><td>0.314</td><td>-0.601</td><td>1.215</td><td>1.787</td></tr>
<tr><td style="text-align:left"></td><td>(2.271)</td><td>(2.254)</td><td>(2.035)</td><td>(1.961)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">experiencek</td><td></td><td>1.469<sup>***</sup></td><td>0.743<sup>***</sup></td><td>0.663<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(0.169)</td><td>(0.170)</td><td>(0.166)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">boy</td><td></td><td></td><td></td><td>-12.091<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td>(1.673)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">lunchkfree</td><td></td><td></td><td></td><td>-34.703<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td>(1.987)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">black</td><td></td><td></td><td></td><td>-25.431<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td>(3.499)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">race</td><td></td><td></td><td></td><td>8.501</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td>(12.520)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td style="text-align:left">Constant</td><td>918.043<sup>***</sup></td><td>904.721<sup>***</sup></td><td>925.675<sup>***</sup></td><td>937.683<sup>***</sup></td></tr>
<tr><td style="text-align:left"></td><td>(1.633)</td><td>(2.222)</td><td>(7.653)</td><td>(14.373)</td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td></td><td></td></tr>
<tr><td colspan="5" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">School indicators?</td><td>no</td><td>no</td><td>yes</td><td>yes</td></tr>
<tr><td style="text-align:left">Observations</td><td>5,786</td><td>5,766</td><td>5,766</td><td>5,748</td></tr>
<tr><td style="text-align:left">R<sup>2</sup></td><td>0.007</td><td>0.020</td><td>0.234</td><td>0.291</td></tr>
<tr><td style="text-align:left">Adjusted R<sup>2</sup></td><td>0.007</td><td>0.020</td><td>0.223</td><td>0.281</td></tr>
<tr><td style="text-align:left">Residual Std. Error</td><td>73.490 (df = 5783)</td><td>73.085 (df = 5762)</td><td>65.075 (df = 5684)</td><td>62.663 (df = 5662)</td></tr>
<tr><td style="text-align:left">F Statistic</td><td>21.263<sup>***</sup> (df = 2; 5783)</td><td>39.861<sup>***</sup> (df = 3; 5762)</td><td>21.413<sup>***</sup> (df = 81; 5684)</td><td>27.364<sup>***</sup> (df = 85; 5662)</td></tr>
<tr><td colspan="5" style="border-bottom: 1px solid black"></td></tr></table>
<caption><p style='text-align:center'><span id="tab:psdewarfk">Table 13.3: </span> Project STAR - Differences Estimates with Additional Regressors for Kindergarten</p></caption>


<p>The results in column (1) of Table <a href="eaqe.html#tab:psdewarfk">13.3</a> same as the results obtained for <a href="eaqe.html#eq:starpopreg">(13.3)</a>. Columns (2) to (4) reveal that adding student characteristics and school fixed effects does not lead to substantially different estimates of the treatment effects. This result makes it more plausible that the estimates of the effects obtained using model <a href="eaqe.html#eq:starpopreg">(13.3)</a> do not suffer from failure of random assignment. There is some decrease in the standard errors and some increase in <span class="math inline">\(\bar{R}^2\)</span>, implying that the estimates are more precise.</p>
<p>Because teachers were randomly assigned to classes, inclusion of school fixed effect allows us to estimate the causal effect of a teacher’s experience on test scores of students in kindergarten. Regression (3) predicts the average effect of 10 years experience on test scores to be <span class="math inline">\(10\cdot 0.74=7.4\)</span> points. Be aware that the other estimates on student characteristics in regression (4) <em>do not</em> have causal interpretation due to nonrandom assignment (see Chapter 13.3 of the book for a detailed discussion).</p>
<p>Are the estimated effects presented in Table <a href="eaqe.html#tab:psdewarfk">13.3</a> large or small in a practical sense? Let us translate the predicted changes in test scores to units of standard deviation in order to allow for a comparison (see Section <a href="asbomr.html#etsacs">9.4</a> for a similar argument).</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="eaqe.html#cb321-1" tabindex="-1"></a><span class="co"># compute the sample standard deviations of test scores</span></span>
<span id="cb321-2"><a href="eaqe.html#cb321-2" tabindex="-1"></a>SSD <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;K&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(<span class="fu">na.omit</span>(STAR<span class="sc">$</span>readk <span class="sc">+</span> STAR<span class="sc">$</span>mathk)),</span>
<span id="cb321-3"><a href="eaqe.html#cb321-3" tabindex="-1"></a>         <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(<span class="fu">na.omit</span>(STAR<span class="sc">$</span>read1 <span class="sc">+</span> STAR<span class="sc">$</span>math1)),</span>
<span id="cb321-4"><a href="eaqe.html#cb321-4" tabindex="-1"></a>         <span class="st">&quot;2&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(<span class="fu">na.omit</span>(STAR<span class="sc">$</span>read2 <span class="sc">+</span> STAR<span class="sc">$</span>math2)),</span>
<span id="cb321-5"><a href="eaqe.html#cb321-5" tabindex="-1"></a>         <span class="st">&quot;3&quot;</span> <span class="ot">=</span> <span class="fu">sd</span>(<span class="fu">na.omit</span>(STAR<span class="sc">$</span>read3 <span class="sc">+</span> STAR<span class="sc">$</span>math3)))</span>
<span id="cb321-6"><a href="eaqe.html#cb321-6" tabindex="-1"></a></span>
<span id="cb321-7"><a href="eaqe.html#cb321-7" tabindex="-1"></a><span class="co"># translate the effects of small classes to standard deviations</span></span>
<span id="cb321-8"><a href="eaqe.html#cb321-8" tabindex="-1"></a>Small <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;K&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">coef</span>(fmk)[<span class="dv">2</span>]<span class="sc">/</span>SSD[<span class="dv">1</span>]),</span>
<span id="cb321-9"><a href="eaqe.html#cb321-9" tabindex="-1"></a>           <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">coef</span>(fm1)[<span class="dv">2</span>]<span class="sc">/</span>SSD[<span class="dv">2</span>]),</span>
<span id="cb321-10"><a href="eaqe.html#cb321-10" tabindex="-1"></a>           <span class="st">&quot;2&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">coef</span>(fm2)[<span class="dv">2</span>]<span class="sc">/</span>SSD[<span class="dv">3</span>]),</span>
<span id="cb321-11"><a href="eaqe.html#cb321-11" tabindex="-1"></a>           <span class="st">&quot;3&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">coef</span>(fm3)[<span class="dv">2</span>]<span class="sc">/</span>SSD[<span class="dv">4</span>]))</span>
<span id="cb321-12"><a href="eaqe.html#cb321-12" tabindex="-1"></a></span>
<span id="cb321-13"><a href="eaqe.html#cb321-13" tabindex="-1"></a><span class="co"># adjust the standard errors</span></span>
<span id="cb321-14"><a href="eaqe.html#cb321-14" tabindex="-1"></a>SmallSE <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;K&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(rob_se_1[[<span class="dv">1</span>]][<span class="dv">2</span>]<span class="sc">/</span>SSD[<span class="dv">1</span>]),</span>
<span id="cb321-15"><a href="eaqe.html#cb321-15" tabindex="-1"></a>             <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(rob_se_1[[<span class="dv">2</span>]][<span class="dv">2</span>]<span class="sc">/</span>SSD[<span class="dv">2</span>]),</span>
<span id="cb321-16"><a href="eaqe.html#cb321-16" tabindex="-1"></a>             <span class="st">&quot;2&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(rob_se_1[[<span class="dv">3</span>]][<span class="dv">2</span>]<span class="sc">/</span>SSD[<span class="dv">3</span>]),</span>
<span id="cb321-17"><a href="eaqe.html#cb321-17" tabindex="-1"></a>             <span class="st">&quot;3&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(rob_se_1[[<span class="dv">4</span>]][<span class="dv">2</span>]<span class="sc">/</span>SSD[<span class="dv">4</span>]))</span>
<span id="cb321-18"><a href="eaqe.html#cb321-18" tabindex="-1"></a></span>
<span id="cb321-19"><a href="eaqe.html#cb321-19" tabindex="-1"></a><span class="co"># translate the effects of regular classes with aide to standard deviations</span></span>
<span id="cb321-20"><a href="eaqe.html#cb321-20" tabindex="-1"></a>RegAide<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;K&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">coef</span>(fmk)[<span class="dv">3</span>]<span class="sc">/</span>SSD[<span class="dv">1</span>]),</span>
<span id="cb321-21"><a href="eaqe.html#cb321-21" tabindex="-1"></a>            <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">coef</span>(fm1)[<span class="dv">3</span>]<span class="sc">/</span>SSD[<span class="dv">2</span>]),</span>
<span id="cb321-22"><a href="eaqe.html#cb321-22" tabindex="-1"></a>            <span class="st">&quot;2&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">coef</span>(fm2)[<span class="dv">3</span>]<span class="sc">/</span>SSD[<span class="dv">3</span>]),</span>
<span id="cb321-23"><a href="eaqe.html#cb321-23" tabindex="-1"></a>            <span class="st">&quot;3&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">coef</span>(fm3)[<span class="dv">3</span>]<span class="sc">/</span>SSD[<span class="dv">4</span>]))</span>
<span id="cb321-24"><a href="eaqe.html#cb321-24" tabindex="-1"></a></span>
<span id="cb321-25"><a href="eaqe.html#cb321-25" tabindex="-1"></a><span class="co"># adjust the standard errors</span></span>
<span id="cb321-26"><a href="eaqe.html#cb321-26" tabindex="-1"></a>RegAideSE <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;K&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(rob_se_1[[<span class="dv">1</span>]][<span class="dv">3</span>]<span class="sc">/</span>SSD[<span class="dv">1</span>]),</span>
<span id="cb321-27"><a href="eaqe.html#cb321-27" tabindex="-1"></a>               <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(rob_se_1[[<span class="dv">2</span>]][<span class="dv">3</span>]<span class="sc">/</span>SSD[<span class="dv">2</span>]),</span>
<span id="cb321-28"><a href="eaqe.html#cb321-28" tabindex="-1"></a>               <span class="st">&quot;2&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(rob_se_1[[<span class="dv">3</span>]][<span class="dv">3</span>]<span class="sc">/</span>SSD[<span class="dv">3</span>]),</span>
<span id="cb321-29"><a href="eaqe.html#cb321-29" tabindex="-1"></a>               <span class="st">&quot;3&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(rob_se_1[[<span class="dv">4</span>]][<span class="dv">3</span>]<span class="sc">/</span>SSD[<span class="dv">4</span>]))</span>
<span id="cb321-30"><a href="eaqe.html#cb321-30" tabindex="-1"></a></span>
<span id="cb321-31"><a href="eaqe.html#cb321-31" tabindex="-1"></a><span class="co"># gather the results in a data.frame and round</span></span>
<span id="cb321-32"><a href="eaqe.html#cb321-32" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">round</span>(<span class="fu">data.frame</span>(</span>
<span id="cb321-33"><a href="eaqe.html#cb321-33" tabindex="-1"></a>                        Small, SmallSE, RegAide, RegAideSE, SSD),</span>
<span id="cb321-34"><a href="eaqe.html#cb321-34" tabindex="-1"></a>                        <span class="at">digits =</span>  <span class="dv">2</span>))</span></code></pre></div>
<p>It is fairly easy to turn the <tt>data.frame</tt> <tt>df</tt> into a table.</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="eaqe.html#cb322-1" tabindex="-1"></a><span class="co"># generate a simple table using stargazer</span></span>
<span id="cb322-2"><a href="eaqe.html#cb322-2" tabindex="-1"></a><span class="fu">stargazer</span>(df,</span>
<span id="cb322-3"><a href="eaqe.html#cb322-3" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">&quot;Estimated Class Size Effects </span></span>
<span id="cb322-4"><a href="eaqe.html#cb322-4" tabindex="-1"></a><span class="st">          (in Units of Standard Deviations)&quot;</span>,</span>
<span id="cb322-5"><a href="eaqe.html#cb322-5" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">&quot;html&quot;</span>, </span>
<span id="cb322-6"><a href="eaqe.html#cb322-6" tabindex="-1"></a>          <span class="at">summary =</span> <span class="cn">FALSE</span>,</span>
<span id="cb322-7"><a href="eaqe.html#cb322-7" tabindex="-1"></a>          <span class="at">header =</span> <span class="cn">FALSE</span></span>
<span id="cb322-8"><a href="eaqe.html#cb322-8" tabindex="-1"></a>          )</span></code></pre></div>



<table style="text-align:center"><tr><td colspan="5" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"></td><td>K</td><td>1</td><td>2</td><td>3</td></tr>
<tr><td colspan="5" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">Small</td><td>0.190</td><td>0.330</td><td>0.230</td><td>0.210</td></tr>
<tr><td style="text-align:left">SmallSE</td><td>0.030</td><td>0.030</td><td>0.030</td><td>0.030</td></tr>
<tr><td style="text-align:left">RegAide</td><td>0</td><td>0.130</td><td>0.040</td><td>0</td></tr>
<tr><td style="text-align:left">RegAideSE</td><td>0.030</td><td>0.030</td><td>0.030</td><td>0.030</td></tr>
<tr><td style="text-align:left">SSD</td><td>73.750</td><td>91.280</td><td>84.080</td><td>73.270</td></tr>
<tr><td colspan="5" style="border-bottom: 1px solid black"></td></tr></table>
<caption><p style='text-align:center'><span id="tab:ecse">Table 13.4: </span> Estimated Class Size Effects 
          (in Units of Standard Deviations)</p></caption>


<p>The estimated effect of a small class is largest for grade 1. As pointed out in the book, this is probably because students in the control group for grade 1 did poorly on the test for some unknown reason or simply due to random variation. The difference between the estimated effect of being in a small class and being in a regular class with an aide is roughly 0.2 standard deviations for all grades. This leads to the conclusion that the effect of being in a regular sized class with an aide is zero and the effect of being in a small class is roughly the same for all grades.</p>
<p>The remainder of Chapter 13.3 in the book discusses to what extent these experimental estimates are comparable with observational estimates obtained using data on school districts in California and Massachusetts in Chapter <a href="asbomr.html#asbomr">9</a>. It turns out that the estimates are indeed very similar. Please refer to the aforementioned section in the book for a more detailed discussion.</p>
</div>
</div>
<div id="qe" class="section level2 hasAnchor" number="13.4">
<h2><span class="header-section-number">13.4</span> Quasi Experiments<a href="eaqe.html#qe" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In quasi-experiments, “as if” randomness is exploited to use methods similar to those that have been discussed in the previous chapter. There are two types of quasi-experiments:<a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a></p>
<ol style="list-style-type: decimal">
<li><p>Random variations in individual circumstances allow to view the treatment “as if” it was randomly determined.</p></li>
<li><p>The treatment is only partially determined by “as if” random variation.</p></li>
</ol>
<p>The former allows to estimate the effect using either model <a href="eaqe.html#eq:diffestwar">(13.2)</a>, i.e., the <em>difference estimator with additional regressors</em>, or, if there is doubt that the “as if” randomness does not entirely ensure that there are no systematic differences between control and treatment group, using the <em>differences-in-differences</em> (DID) estimator. In the latter case, an IV approach for estimation of a model like <a href="eaqe.html#eq:diffestwar">(13.2)</a> which uses the source of “as if” randomness in treatment assignment as the instrument may be applied.</p>
<p>Some more advanced techniques that are helpful in settings where the treatment assignment is (partially) determined by a threshold in a so-called running variable are <em>sharp regression discontinuity design</em> (RDD) and <em>fuzzy regression discontinuity design</em> (FRDD).</p>
<p>We briefly review these techniques and, since the book does not provide any empirical examples in this section, we will use our own simulated data in a minimal example to discuss how DID, RDD and FRDD can be applied in <tt>R</tt>.</p>
<div id="the-differences-in-differences-estimator" class="section level3 unnumbered hasAnchor">
<h3>The Differences-in-Differences Estimator<a href="eaqe.html#the-differences-in-differences-estimator" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In quasi-experiments the source of “as if” randomness in treatment assignment can often not entirely prevent systematic differences between control and treatment groups. This problem was encountered by <span class="citation">Card and Krueger (<a href="#ref-card1994">1994</a>)</span> who use geography as the “as if” random treatment assignment to study the effect on employment in fast-food restaurants caused by an increase in the state minimum wage in New Jersey in the year of 1992. Their idea was to use the fact that the increase in minimum wage applied to employees in New Jersey (treatment group) but not to those living in neighboring Pennsylvania (control group).</p>
<p>It is quite conceivable that such a wage hike is not correlated with other determinants of employment. However, there still might be some state-specific differences and thus differences between control and treatment group. This would render the <em>differences estimator</em> biased and inconsistent. <span class="citation">Card and Krueger (<a href="#ref-card1994">1994</a>)</span> solved this by using a DID estimator: they collected data in February 1992 (before the treatment) and November 1992 (after the treatment) for the same restaurants and estimated the effect of the wage hike by analyzing differences in the differences in employment for New Jersey and Pennsylvania before and after the increase.<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a> The DID estimator is</p>
<p><span class="math display" id="eq:DID">\[\begin{align}
  \widehat{\beta}_1^{\text{diffs-in-diffs}} =&amp; \, (\overline{Y}^{\text{treatment,after}} - \overline{Y}^{\text{treatment,before}}) - (\overline{Y}^{\text{control,after}} - \overline{Y}^{\text{control,before}}) \\
  =&amp; \Delta \overline{Y}^{\text{treatment}} - \Delta \overline{Y}^{\text{control}}, \tag{13.8}
\end{align}\]</span></p>
<p>with</p>
<ul>
<li><p><span class="math inline">\(\overline{Y}^{\text{treatment,before}}\)</span> - the sample average in the treatment group before the treatment</p></li>
<li><p><span class="math inline">\(\overline{Y}^{\text{treatment,after}}\)</span> - the sample average in the treatment group after the treatment</p></li>
<li><p><span class="math inline">\(\overline{Y}^{\text{treatment,before}}\)</span> - the sample average in the control group before the treatment</p></li>
<li><p><span class="math inline">\(\overline{Y}^{\text{treatment,after}}\)</span> - the sample average in the control group after the treatment.</p></li>
</ul>
<p>We now use <tt>R</tt> to reproduce Figure 13.1 of the book.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="eaqe.html#cb323-1" tabindex="-1"></a><span class="co"># initialize plot and add control group</span></span>
<span id="cb323-2"><a href="eaqe.html#cb323-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">8</span>), </span>
<span id="cb323-3"><a href="eaqe.html#cb323-3" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;p&quot;</span>,</span>
<span id="cb323-4"><a href="eaqe.html#cb323-4" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">12</span>),</span>
<span id="cb323-5"><a href="eaqe.html#cb323-5" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">1.3</span>),</span>
<span id="cb323-6"><a href="eaqe.html#cb323-6" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;The Differences-in-Differences Estimator&quot;</span>,</span>
<span id="cb323-7"><a href="eaqe.html#cb323-7" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Period&quot;</span>,</span>
<span id="cb323-8"><a href="eaqe.html#cb323-8" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>,</span>
<span id="cb323-9"><a href="eaqe.html#cb323-9" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb323-10"><a href="eaqe.html#cb323-10" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb323-11"><a href="eaqe.html#cb323-11" tabindex="-1"></a>     <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb323-12"><a href="eaqe.html#cb323-12" tabindex="-1"></a>     <span class="at">yaxt =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb323-13"><a href="eaqe.html#cb323-13" tabindex="-1"></a></span>
<span id="cb323-14"><a href="eaqe.html#cb323-14" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;before&quot;</span>, <span class="st">&quot;after&quot;</span>))</span>
<span id="cb323-15"><a href="eaqe.html#cb323-15" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">13</span>))</span>
<span id="cb323-16"><a href="eaqe.html#cb323-16" tabindex="-1"></a></span>
<span id="cb323-17"><a href="eaqe.html#cb323-17" tabindex="-1"></a><span class="co"># add treatment group</span></span>
<span id="cb323-18"><a href="eaqe.html#cb323-18" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">11</span>), </span>
<span id="cb323-19"><a href="eaqe.html#cb323-19" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>,</span>
<span id="cb323-20"><a href="eaqe.html#cb323-20" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb323-21"><a href="eaqe.html#cb323-21" tabindex="-1"></a></span>
<span id="cb323-22"><a href="eaqe.html#cb323-22" tabindex="-1"></a><span class="co"># add line segments</span></span>
<span id="cb323-23"><a href="eaqe.html#cb323-23" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">11</span>), <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span>
<span id="cb323-24"><a href="eaqe.html#cb323-24" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">8</span>), <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>)</span>
<span id="cb323-25"><a href="eaqe.html#cb323-25" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">9</span>), <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb323-26"><a href="eaqe.html#cb323-26" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">11</span>), <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb323-27"><a href="eaqe.html#cb323-27" tabindex="-1"></a></span>
<span id="cb323-28"><a href="eaqe.html#cb323-28" tabindex="-1"></a><span class="co"># add annotations</span></span>
<span id="cb323-29"><a href="eaqe.html#cb323-29" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="fu">expression</span>(<span class="fu">hat</span>(beta)[<span class="dv">1</span>]<span class="sc">^</span>{DID}), <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">pos =</span> <span class="dv">4</span>)</span>
<span id="cb323-30"><a href="eaqe.html#cb323-30" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">0</span>, <span class="fl">5.5</span>, <span class="st">&quot;s. mean control&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span> , <span class="at">pos =</span> <span class="dv">4</span>)</span>
<span id="cb323-31"><a href="eaqe.html#cb323-31" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">0</span>, <span class="fl">6.8</span>, <span class="st">&quot;s. mean treatment&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span> , <span class="at">pos =</span> <span class="dv">4</span>)</span>
<span id="cb323-32"><a href="eaqe.html#cb323-32" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span>, <span class="fl">7.9</span>, <span class="st">&quot;s. mean control&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span> , <span class="at">pos =</span> <span class="dv">4</span>)</span>
<span id="cb323-33"><a href="eaqe.html#cb323-33" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span>, <span class="fl">11.1</span>, <span class="st">&quot;s. mean treatment&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span> , <span class="at">pos =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-550-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The DID estimator <a href="eaqe.html#eq:DID">(13.8)</a> can also be written in regression notation: <span class="math inline">\(\widehat{\beta}_1^{\text{DID}}\)</span> is the OLS estimator of <span class="math inline">\(\beta_1\)</span> in
<span class="math display" id="eq:did">\[\begin{align}
  \Delta Y_i = \beta_0 + \beta_1 X_i + u_i, \tag{13.9}
\end{align}\]</span>
where <span class="math inline">\(\Delta Y_i\)</span> denotes the difference in pre- and post-treatment outcomes of individual <span class="math inline">\(i\)</span> and <span class="math inline">\(X_i\)</span> is the treatment indicator.</p>
<p>Adding additional regressors that measure pre-treatment characteristics to <a href="eaqe.html#eq:did">(13.9)</a> we obtain
<span class="math display" id="eq:didwar">\[\begin{align}
  \Delta Y_i = \beta_0 + \beta_1 X_i + \beta_2 W_{1i} + \dots + \beta_{1+r} W_{ri} + u_i, \tag{13.10}
\end{align}\]</span>
the <em>difference-in-differences estimator</em> with additional regressors. The additional regressors may lead to a more precise estimate of <span class="math inline">\(\beta_1\)</span>.</p>
<p>We keep things simple and focus on estimation of the treatment effect using DID in the simplest case, that is a control and a treatment group observed for two time periods — one before and one after the treatment. In particular, we will see that there are three different ways to proceed.</p>
<p>First, we simulate pre- and post-treatment data using <tt>R</tt>.</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="eaqe.html#cb324-1" tabindex="-1"></a><span class="co"># set sample size</span></span>
<span id="cb324-2"><a href="eaqe.html#cb324-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb324-3"><a href="eaqe.html#cb324-3" tabindex="-1"></a></span>
<span id="cb324-4"><a href="eaqe.html#cb324-4" tabindex="-1"></a><span class="co"># define treatment effect</span></span>
<span id="cb324-5"><a href="eaqe.html#cb324-5" tabindex="-1"></a>TEffect <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb324-6"><a href="eaqe.html#cb324-6" tabindex="-1"></a></span>
<span id="cb324-7"><a href="eaqe.html#cb324-7" tabindex="-1"></a><span class="co"># generate treatment dummy</span></span>
<span id="cb324-8"><a href="eaqe.html#cb324-8" tabindex="-1"></a>TDummy <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, n<span class="sc">/</span><span class="dv">2</span>), <span class="fu">rep</span>(<span class="dv">1</span>, n<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb324-9"><a href="eaqe.html#cb324-9" tabindex="-1"></a></span>
<span id="cb324-10"><a href="eaqe.html#cb324-10" tabindex="-1"></a><span class="co"># simulate pre- and post-treatment values of the dependent variable</span></span>
<span id="cb324-11"><a href="eaqe.html#cb324-11" tabindex="-1"></a>y_pre <span class="ot">&lt;-</span> <span class="dv">7</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb324-12"><a href="eaqe.html#cb324-12" tabindex="-1"></a>y_pre[<span class="dv">1</span><span class="sc">:</span>n<span class="sc">/</span><span class="dv">2</span>] <span class="ot">&lt;-</span> y_pre[<span class="dv">1</span><span class="sc">:</span>n<span class="sc">/</span><span class="dv">2</span>] <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb324-13"><a href="eaqe.html#cb324-13" tabindex="-1"></a>y_post <span class="ot">&lt;-</span> <span class="dv">7</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">+</span> TEffect <span class="sc">*</span> TDummy <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb324-14"><a href="eaqe.html#cb324-14" tabindex="-1"></a>y_post[<span class="dv">1</span><span class="sc">:</span>n<span class="sc">/</span><span class="dv">2</span>] <span class="ot">&lt;-</span> y_post[<span class="dv">1</span><span class="sc">:</span>n<span class="sc">/</span><span class="dv">2</span>] <span class="sc">-</span> <span class="dv">1</span> </span></code></pre></div>
<p>Next we plot the data. The function <tt>jitter()</tt> is used to add some artificial dispersion in the horizontal component of the points so that there is less overplotting. The function <tt>alpha()</tt> from the package <tt>scales</tt> allows to adjust the opacity of colors used in plots.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="eaqe.html#cb325-1" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb325-2"><a href="eaqe.html#cb325-2" tabindex="-1"></a></span>
<span id="cb325-3"><a href="eaqe.html#cb325-3" tabindex="-1"></a>pre <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(y_pre[TDummy<span class="sc">==</span><span class="dv">0</span>]))</span>
<span id="cb325-4"><a href="eaqe.html#cb325-4" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(y_pre[TDummy<span class="sc">==</span><span class="dv">0</span>]))</span>
<span id="cb325-5"><a href="eaqe.html#cb325-5" tabindex="-1"></a></span>
<span id="cb325-6"><a href="eaqe.html#cb325-6" tabindex="-1"></a><span class="co"># plot control group in t=1</span></span>
<span id="cb325-7"><a href="eaqe.html#cb325-7" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">jitter</span>(pre, <span class="fl">0.6</span>), </span>
<span id="cb325-8"><a href="eaqe.html#cb325-8" tabindex="-1"></a>     y_pre[TDummy <span class="sc">==</span> <span class="dv">0</span>], </span>
<span id="cb325-9"><a href="eaqe.html#cb325-9" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">16</span>), </span>
<span id="cb325-10"><a href="eaqe.html#cb325-10" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">alpha</span>(<span class="st">&quot;steelblue&quot;</span>, <span class="fl">0.3</span>),</span>
<span id="cb325-11"><a href="eaqe.html#cb325-11" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, </span>
<span id="cb325-12"><a href="eaqe.html#cb325-12" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">1.5</span>),</span>
<span id="cb325-13"><a href="eaqe.html#cb325-13" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>,</span>
<span id="cb325-14"><a href="eaqe.html#cb325-14" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Period&quot;</span>,</span>
<span id="cb325-15"><a href="eaqe.html#cb325-15" tabindex="-1"></a>     <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb325-16"><a href="eaqe.html#cb325-16" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Artificial Data for DID Estimation&quot;</span>)</span>
<span id="cb325-17"><a href="eaqe.html#cb325-17" tabindex="-1"></a></span>
<span id="cb325-18"><a href="eaqe.html#cb325-18" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;before&quot;</span>, <span class="st">&quot;after&quot;</span>))</span>
<span id="cb325-19"><a href="eaqe.html#cb325-19" tabindex="-1"></a></span>
<span id="cb325-20"><a href="eaqe.html#cb325-20" tabindex="-1"></a><span class="co"># add treatment group in t=1</span></span>
<span id="cb325-21"><a href="eaqe.html#cb325-21" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">jitter</span>(pre, <span class="fl">0.6</span>), </span>
<span id="cb325-22"><a href="eaqe.html#cb325-22" tabindex="-1"></a>       y_pre[TDummy <span class="sc">==</span> <span class="dv">1</span>], </span>
<span id="cb325-23"><a href="eaqe.html#cb325-23" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">alpha</span>(<span class="st">&quot;darkred&quot;</span>, <span class="fl">0.3</span>), </span>
<span id="cb325-24"><a href="eaqe.html#cb325-24" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb325-25"><a href="eaqe.html#cb325-25" tabindex="-1"></a></span>
<span id="cb325-26"><a href="eaqe.html#cb325-26" tabindex="-1"></a><span class="co"># add control group in t=2</span></span>
<span id="cb325-27"><a href="eaqe.html#cb325-27" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">jitter</span>(post, <span class="fl">0.6</span>),</span>
<span id="cb325-28"><a href="eaqe.html#cb325-28" tabindex="-1"></a>       y_post[TDummy <span class="sc">==</span> <span class="dv">0</span>], </span>
<span id="cb325-29"><a href="eaqe.html#cb325-29" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">alpha</span>(<span class="st">&quot;steelblue&quot;</span>, <span class="fl">0.5</span>),</span>
<span id="cb325-30"><a href="eaqe.html#cb325-30" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb325-31"><a href="eaqe.html#cb325-31" tabindex="-1"></a></span>
<span id="cb325-32"><a href="eaqe.html#cb325-32" tabindex="-1"></a><span class="co"># add treatment group in t=2</span></span>
<span id="cb325-33"><a href="eaqe.html#cb325-33" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">jitter</span>(post, <span class="fl">0.6</span>), </span>
<span id="cb325-34"><a href="eaqe.html#cb325-34" tabindex="-1"></a>       y_post[TDummy <span class="sc">==</span> <span class="dv">1</span>], </span>
<span id="cb325-35"><a href="eaqe.html#cb325-35" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">alpha</span>(<span class="st">&quot;darkred&quot;</span>, <span class="fl">0.5</span>),</span>
<span id="cb325-36"><a href="eaqe.html#cb325-36" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-552-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>After the treatment, both the control and treatment groups have a higher mean, but the increase is stronger in the treatment group. Using DID we may estimate how much of that difference is due to the treatment.</p>
<p>It is straightforward to compute the DID estimate in the fashion of <a href="eaqe.html#eq:DID">(13.8)</a>.</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="eaqe.html#cb326-1" tabindex="-1"></a><span class="co"># compute the DID estimator for the treatment effect &#39;by hand&#39;</span></span>
<span id="cb326-2"><a href="eaqe.html#cb326-2" tabindex="-1"></a><span class="fu">mean</span>(y_post[TDummy <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span> <span class="fu">mean</span>(y_pre[TDummy <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span> </span>
<span id="cb326-3"><a href="eaqe.html#cb326-3" tabindex="-1"></a>(<span class="fu">mean</span>(y_post[TDummy <span class="sc">==</span> <span class="dv">0</span>]) <span class="sc">-</span> <span class="fu">mean</span>(y_pre[TDummy <span class="sc">==</span> <span class="dv">0</span>]))</span>
<span id="cb326-4"><a href="eaqe.html#cb326-4" tabindex="-1"></a><span class="co">#&gt; [1] 3.960268</span></span></code></pre></div>
<p>Notice that the estimate is close to <span class="math inline">\(4\)</span>, the value chosen as the treatment effect <tt>TEffect</tt> above. Since <a href="eaqe.html#eq:did">(13.9)</a> is a simple linear model, we may perform OLS estimation of this regression specification using <tt>lm()</tt>.</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="eaqe.html#cb327-1" tabindex="-1"></a><span class="co"># compute the DID estimator using a linear model</span></span>
<span id="cb327-2"><a href="eaqe.html#cb327-2" tabindex="-1"></a><span class="fu">lm</span>(<span class="fu">I</span>(y_post <span class="sc">-</span> y_pre) <span class="sc">~</span> TDummy)</span>
<span id="cb327-3"><a href="eaqe.html#cb327-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb327-4"><a href="eaqe.html#cb327-4" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb327-5"><a href="eaqe.html#cb327-5" tabindex="-1"></a><span class="co">#&gt; lm(formula = I(y_post - y_pre) ~ TDummy)</span></span>
<span id="cb327-6"><a href="eaqe.html#cb327-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb327-7"><a href="eaqe.html#cb327-7" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb327-8"><a href="eaqe.html#cb327-8" tabindex="-1"></a><span class="co">#&gt; (Intercept)       TDummy  </span></span>
<span id="cb327-9"><a href="eaqe.html#cb327-9" tabindex="-1"></a><span class="co">#&gt;       2.104        3.960</span></span></code></pre></div>
<p>We find that the estimates coincide. Furthermore, one can show that the DID estimate obtained by estimating specification <a href="eaqe.html#eq:did">(13.9)</a> is the same as the OLS estimate of <span class="math inline">\(\beta_{TE}\)</span> in
<span class="math display" id="eq:DIDint">\[\begin{align}
  Y_i =&amp; \beta_0 + \beta_1 D_i + \beta_2 Period_i + \beta_{TE} (Period_i \times D_i) + \varepsilon_i, \tag{13.11}
\end{align}\]</span>
where <span class="math inline">\(D_i\)</span> is the binary treatment indicator, <span class="math inline">\(Period_i\)</span> is a binary indicator for the after-treatment period and the <span class="math inline">\(Period_i \times D_i\)</span> is the interaction of both.</p>
<p>As for <a href="eaqe.html#eq:did">(13.9)</a>, estimation of <a href="eaqe.html#eq:DIDint">(13.11)</a> using <tt>R</tt> is straightforward. See Chapter <a href="nrf.html#nrf">8</a> for a discussion of interaction terms.</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="eaqe.html#cb328-1" tabindex="-1"></a><span class="co"># prepare data for DID regression using the interaction term </span></span>
<span id="cb328-2"><a href="eaqe.html#cb328-2" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;Y&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(y_pre,y_post),</span>
<span id="cb328-3"><a href="eaqe.html#cb328-3" tabindex="-1"></a>                <span class="st">&quot;Treatment&quot;</span> <span class="ot">=</span> TDummy, </span>
<span id="cb328-4"><a href="eaqe.html#cb328-4" tabindex="-1"></a>                <span class="st">&quot;Period&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;1&quot;</span>, n), <span class="fu">rep</span>(<span class="st">&quot;2&quot;</span>, n)))</span>
<span id="cb328-5"><a href="eaqe.html#cb328-5" tabindex="-1"></a></span>
<span id="cb328-6"><a href="eaqe.html#cb328-6" tabindex="-1"></a><span class="co"># estimate the model</span></span>
<span id="cb328-7"><a href="eaqe.html#cb328-7" tabindex="-1"></a><span class="fu">lm</span>(Y <span class="sc">~</span> Treatment <span class="sc">*</span> Period, <span class="at">data =</span> d)</span>
<span id="cb328-8"><a href="eaqe.html#cb328-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb328-9"><a href="eaqe.html#cb328-9" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb328-10"><a href="eaqe.html#cb328-10" tabindex="-1"></a><span class="co">#&gt; lm(formula = Y ~ Treatment * Period, data = d)</span></span>
<span id="cb328-11"><a href="eaqe.html#cb328-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb328-12"><a href="eaqe.html#cb328-12" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb328-13"><a href="eaqe.html#cb328-13" tabindex="-1"></a><span class="co">#&gt;       (Intercept)          Treatment            Period2  Treatment:Period2  </span></span>
<span id="cb328-14"><a href="eaqe.html#cb328-14" tabindex="-1"></a><span class="co">#&gt;             5.858              1.197              2.104              3.960</span></span></code></pre></div>
<p>As expected, the estimate of the coefficient on the interaction of the treatment dummy and the time dummy coincide with the estimates obtained using <a href="eaqe.html#eq:DID">(13.8)</a> and OLS estimation of <a href="eaqe.html#eq:did">(13.9)</a>.</p>
</div>
<div id="regression-discontinuity-estimators" class="section level3 unnumbered hasAnchor">
<h3>Regression Discontinuity Estimators<a href="eaqe.html#regression-discontinuity-estimators" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consider the model
<span class="math display" id="eq:SRDDsetting">\[\begin{align}
  Y_i =&amp; \beta_0 + \beta_1 X_i + \beta_2 W_i + u_i \tag{13.12}
\end{align}\]</span>
and let
<span class="math display">\[\begin{align*}
X_i =&amp;
  \begin{cases}
    1, &amp; W_i \geq c \\
    0, &amp; W_i &lt; c,
  \end{cases}
\end{align*}\]</span>
so that the receipt of treatment, <span class="math inline">\(X_i\)</span>, is determined by some threshold <span class="math inline">\(c\)</span> of a continuous variable <span class="math inline">\(W_i\)</span>, the so called running variable. The idea of <em>regression discontinuity design</em> is to use observations with a <span class="math inline">\(W_i\)</span> close to <span class="math inline">\(c\)</span> for estimation of <span class="math inline">\(\beta_1\)</span>. <span class="math inline">\(\beta_1\)</span> is the average treatment effect for individuals with <span class="math inline">\(W_i = c\)</span> which is assumed to be a good approximation to the treatment effect in the population. <a href="eaqe.html#eq:SRDDsetting">(13.12)</a> is called a <em>sharp regression discontinuity design</em> because treatment assignment is deterministic and discontinuous at the cutoff: all observations with <span class="math inline">\(W_i &lt; c\)</span> do not receive treatment and all observations where <span class="math inline">\(W_i \geq c\)</span> are treated.</p>
<p>The subsequent code chunks show how to estimate a linear SRDD using <tt>R</tt> and how to produce plots in the way of Figure 13.2 of the book.</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="eaqe.html#cb329-1" tabindex="-1"></a><span class="co"># generate some sample data</span></span>
<span id="cb329-2"><a href="eaqe.html#cb329-2" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb329-3"><a href="eaqe.html#cb329-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> W <span class="sc">+</span> <span class="dv">10</span> <span class="sc">*</span> (W<span class="sc">&gt;=</span><span class="dv">0</span>) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>)</span></code></pre></div>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="eaqe.html#cb330-1" tabindex="-1"></a><span class="co"># load the package &#39;rddtools&#39;</span></span>
<span id="cb330-2"><a href="eaqe.html#cb330-2" tabindex="-1"></a><span class="fu">library</span>(rddtools)</span>
<span id="cb330-3"><a href="eaqe.html#cb330-3" tabindex="-1"></a></span>
<span id="cb330-4"><a href="eaqe.html#cb330-4" tabindex="-1"></a><span class="co"># construct rdd_data </span></span>
<span id="cb330-5"><a href="eaqe.html#cb330-5" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">rdd_data</span>(y, W, <span class="at">cutpoint =</span> <span class="dv">0</span>)</span>
<span id="cb330-6"><a href="eaqe.html#cb330-6" tabindex="-1"></a></span>
<span id="cb330-7"><a href="eaqe.html#cb330-7" tabindex="-1"></a><span class="co"># plot the sample data</span></span>
<span id="cb330-8"><a href="eaqe.html#cb330-8" tabindex="-1"></a><span class="fu">plot</span>(data,</span>
<span id="cb330-9"><a href="eaqe.html#cb330-9" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb330-10"><a href="eaqe.html#cb330-10" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.35</span>, </span>
<span id="cb330-11"><a href="eaqe.html#cb330-11" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;W&quot;</span>, </span>
<span id="cb330-12"><a href="eaqe.html#cb330-12" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-557-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The argument <tt>nbins</tt> sets the number of bins the running variable is divided into for aggregation. The dots represent bin averages of the outcome variable.</p>
<p>We may use the function <tt>rdd_reg_lm()</tt> to estimate the treatment effect using model <a href="eaqe.html#eq:SRDDsetting">(13.12)</a> for the artificial data generated above. By choosing <tt>slope = “same”</tt> we restrict the slopes of the estimated regression function to be the same on both sides of the jump at the cutpoint <span class="math inline">\(W=0\)</span>.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="eaqe.html#cb331-1" tabindex="-1"></a><span class="co"># estimate the sharp RDD model</span></span>
<span id="cb331-2"><a href="eaqe.html#cb331-2" tabindex="-1"></a>rdd_mod <span class="ot">&lt;-</span> <span class="fu">rdd_reg_lm</span>(<span class="at">rdd_object =</span> data, </span>
<span id="cb331-3"><a href="eaqe.html#cb331-3" tabindex="-1"></a>                      <span class="at">slope =</span> <span class="st">&quot;same&quot;</span>)</span>
<span id="cb331-4"><a href="eaqe.html#cb331-4" tabindex="-1"></a><span class="fu">summary</span>(rdd_mod)</span>
<span id="cb331-5"><a href="eaqe.html#cb331-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb331-6"><a href="eaqe.html#cb331-6" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb331-7"><a href="eaqe.html#cb331-7" tabindex="-1"></a><span class="co">#&gt; lm(formula = y ~ ., data = dat_step1, weights = weights)</span></span>
<span id="cb331-8"><a href="eaqe.html#cb331-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb331-9"><a href="eaqe.html#cb331-9" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb331-10"><a href="eaqe.html#cb331-10" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb331-11"><a href="eaqe.html#cb331-11" tabindex="-1"></a><span class="co">#&gt; -3.2361 -0.6779 -0.0039  0.7113  3.0096 </span></span>
<span id="cb331-12"><a href="eaqe.html#cb331-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb331-13"><a href="eaqe.html#cb331-13" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb331-14"><a href="eaqe.html#cb331-14" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb331-15"><a href="eaqe.html#cb331-15" tabindex="-1"></a><span class="co">#&gt; (Intercept)  2.93889    0.07082   41.50   &lt;2e-16 ***</span></span>
<span id="cb331-16"><a href="eaqe.html#cb331-16" tabindex="-1"></a><span class="co">#&gt; D           10.12692    0.12631   80.18   &lt;2e-16 ***</span></span>
<span id="cb331-17"><a href="eaqe.html#cb331-17" tabindex="-1"></a><span class="co">#&gt; x            1.88249    0.11074   17.00   &lt;2e-16 ***</span></span>
<span id="cb331-18"><a href="eaqe.html#cb331-18" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb331-19"><a href="eaqe.html#cb331-19" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb331-20"><a href="eaqe.html#cb331-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb331-21"><a href="eaqe.html#cb331-21" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 1.019 on 997 degrees of freedom</span></span>
<span id="cb331-22"><a href="eaqe.html#cb331-22" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.972,  Adjusted R-squared:  0.972 </span></span>
<span id="cb331-23"><a href="eaqe.html#cb331-23" tabindex="-1"></a><span class="co">#&gt; F-statistic: 1.732e+04 on 2 and 997 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>The coefficient estimate of interest is labeled <tt>D</tt>. The estimate is very close to the treatment effect chosen in the DGP above.</p>
<p>It is easy to visualize the result: simply call <tt>plot()</tt> on the estimated model object.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="eaqe.html#cb332-1" tabindex="-1"></a><span class="co"># plot the RDD model along with binned observations</span></span>
<span id="cb332-2"><a href="eaqe.html#cb332-2" tabindex="-1"></a><span class="fu">plot</span>(rdd_mod,</span>
<span id="cb332-3"><a href="eaqe.html#cb332-3" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.35</span>, </span>
<span id="cb332-4"><a href="eaqe.html#cb332-4" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb332-5"><a href="eaqe.html#cb332-5" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;W&quot;</span>, </span>
<span id="cb332-6"><a href="eaqe.html#cb332-6" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-559-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>As above, the dots represent averages of binned observations.</p>
<p>So far we assumed that crossing of the threshold determines receipt of treatment so that the jump of the population regression functions at the threshold can be regarded as the causal effect of the treatment.</p>
<p>When crossing the threshold <span class="math inline">\(c\)</span> is not the only cause for receipt of the treatment, treatment is no a deterministic function of <span class="math inline">\(W_i\)</span>. Instead, it is useful to think of <span class="math inline">\(c\)</span> as a threshold where the <em>probability</em> of receiving the treatment jumps.</p>
<p>This jump may be due to unobservable variables that have impact on the probability of being treated. Thus, <span class="math inline">\(X_i\)</span> in <a href="eaqe.html#eq:SRDDsetting">(13.12)</a> will be correlated with the error <span class="math inline">\(u_i\)</span> and it becomes more difficult to consistently estimate the treatment effect. In this setting, using a <em>fuzzy regression discontinuity design</em> which is based an IV approach may be a remedy: take the binary variable <span class="math inline">\(Z_i\)</span> as an indicator for crossing of the threshold,
<span class="math display">\[\begin{align*}
  Z_i = \begin{cases}
    1, &amp; W_i \geq c \\
    0, &amp; W_i &lt; c,
  \end{cases}
\end{align*}\]</span>
and assume that <span class="math inline">\(Z_i\)</span> relates to <span class="math inline">\(Y_i\)</span> only through the treatment indicator <span class="math inline">\(X_i\)</span>. Then <span class="math inline">\(Z_i\)</span> and <span class="math inline">\(u_i\)</span> are uncorrelated but <span class="math inline">\(Z_i\)</span> influences receipt of treatment so it is correlated with <span class="math inline">\(X_i\)</span>. Thus, <span class="math inline">\(Z_i\)</span> is a valid instrument for <span class="math inline">\(X_i\)</span> and <a href="eaqe.html#eq:SRDDsetting">(13.12)</a> can be estimated using TSLS.</p>
<p>The following code chunk generates sample data where observations with a value of the running variable <span class="math inline">\(W_i\)</span> below the cutoff <span class="math inline">\(c=0\)</span> do not receive treatment and observations with <span class="math inline">\(W_i \geq 0\)</span> do receive treatment with a probability of <span class="math inline">\(80\%\)</span> so that treatment status is only partially determined by the running variable and the cutoff. Treatment leads to an increase in <span class="math inline">\(Y\)</span> by <span class="math inline">\(2\)</span> units. Observations with <span class="math inline">\(W_i \geq 0\)</span> that do not receive treatment are called <em>no-shows</em>: think of an individual that was assigned to receive the treatment but somehow manages to avoid it.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="eaqe.html#cb333-1" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb333-2"><a href="eaqe.html#cb333-2" tabindex="-1"></a></span>
<span id="cb333-3"><a href="eaqe.html#cb333-3" tabindex="-1"></a><span class="co"># generate sample data</span></span>
<span id="cb333-4"><a href="eaqe.html#cb333-4" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb333-5"><a href="eaqe.html#cb333-5" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.7</span>, <span class="fl">0.7</span>, <span class="dv">1</span>), <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb333-6"><a href="eaqe.html#cb333-6" tabindex="-1"></a></span>
<span id="cb333-7"><a href="eaqe.html#cb333-7" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb333-8"><a href="eaqe.html#cb333-8" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">mvrnorm</span>(<span class="dv">2000</span>, mu, sigma))</span>
<span id="cb333-9"><a href="eaqe.html#cb333-9" tabindex="-1"></a><span class="fu">colnames</span>(d) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;W&quot;</span>, <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb333-10"><a href="eaqe.html#cb333-10" tabindex="-1"></a></span>
<span id="cb333-11"><a href="eaqe.html#cb333-11" tabindex="-1"></a><span class="co"># introduce fuzziness</span></span>
<span id="cb333-12"><a href="eaqe.html#cb333-12" tabindex="-1"></a>d<span class="sc">$</span>treatProb <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(d<span class="sc">$</span>W <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.8</span>)</span>
<span id="cb333-13"><a href="eaqe.html#cb333-13" tabindex="-1"></a></span>
<span id="cb333-14"><a href="eaqe.html#cb333-14" tabindex="-1"></a>fuzz <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="at">X =</span> d<span class="sc">$</span>treatProb, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="at">prob =</span> x))</span>
<span id="cb333-15"><a href="eaqe.html#cb333-15" tabindex="-1"></a></span>
<span id="cb333-16"><a href="eaqe.html#cb333-16" tabindex="-1"></a><span class="co"># treatment effect</span></span>
<span id="cb333-17"><a href="eaqe.html#cb333-17" tabindex="-1"></a>d<span class="sc">$</span>Y <span class="ot">&lt;-</span> d<span class="sc">$</span>Y <span class="sc">+</span> fuzz <span class="sc">*</span> <span class="dv">2</span></span></code></pre></div>
<p><tt>sapply()</tt> applies the function provided to <tt>FUN</tt> to every element of the argument <tt>X</tt>. Here, since <tt>d$treatProb</tt> is a vector, the result is a vector, too.</p>
<p>We plot all observations and use blue color to mark individuals that did not receive the treatment and use red color for those who received the treatment.</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="eaqe.html#cb334-1" tabindex="-1"></a><span class="co"># generate a colored plot of treatment and control group</span></span>
<span id="cb334-2"><a href="eaqe.html#cb334-2" tabindex="-1"></a><span class="fu">plot</span>(d<span class="sc">$</span>W, d<span class="sc">$</span>Y,</span>
<span id="cb334-3"><a href="eaqe.html#cb334-3" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;steelblue&quot;</span>, <span class="st">&quot;darkred&quot;</span>)[<span class="fu">factor</span>(fuzz)], </span>
<span id="cb334-4"><a href="eaqe.html#cb334-4" tabindex="-1"></a>     <span class="at">pch=</span> <span class="dv">20</span>, </span>
<span id="cb334-5"><a href="eaqe.html#cb334-5" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb334-6"><a href="eaqe.html#cb334-6" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>),</span>
<span id="cb334-7"><a href="eaqe.html#cb334-7" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="dv">5</span>),</span>
<span id="cb334-8"><a href="eaqe.html#cb334-8" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;W&quot;</span>,</span>
<span id="cb334-9"><a href="eaqe.html#cb334-9" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb334-10"><a href="eaqe.html#cb334-10" tabindex="-1"></a></span>
<span id="cb334-11"><a href="eaqe.html#cb334-11" tabindex="-1"></a><span class="co"># add a dashed vertical line at cutoff</span></span>
<span id="cb334-12"><a href="eaqe.html#cb334-12" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb334-13"><a href="eaqe.html#cb334-13" tabindex="-1"></a><span class="co">#add legend</span></span>
<span id="cb334-14"><a href="eaqe.html#cb334-14" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="at">pch=</span><span class="dv">20</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;steelblue&quot;</span>,<span class="st">&quot;darkred&quot;</span>),</span>
<span id="cb334-15"><a href="eaqe.html#cb334-15" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Do not receive treatment&quot;</span>,<span class="st">&quot;Receive treatment&quot;</span>))</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-561-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Obviously, receipt of treatment is no longer a deterministic function of the running variable <span class="math inline">\(W\)</span>. Some observations with <span class="math inline">\(W\geq0\)</span> <em>did not</em> receive the treatment. We may estimate a FRDD by additionally setting <tt>treatProb</tt> as the assignment variable <tt>z</tt> in <tt>rdd_data()</tt>. Then <tt>rdd_reg_lm()</tt> applies the following TSLS procedure: treatment is predicted using <span class="math inline">\(W_i\)</span> and the cutoff dummy <span class="math inline">\(Z_i\)</span>, the instrumental variable, in the first stage regression. The fitted values from the first stage regression are used to obtain a consistent estimate of the treatment effect using the second stage where the outcome <span class="math inline">\(Y\)</span> is regressed on the fitted values and the running variable <span class="math inline">\(W\)</span>.</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="eaqe.html#cb335-1" tabindex="-1"></a><span class="co"># estimate the Fuzzy RDD</span></span>
<span id="cb335-2"><a href="eaqe.html#cb335-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">rdd_data</span>(d<span class="sc">$</span>Y, d<span class="sc">$</span>W, </span>
<span id="cb335-3"><a href="eaqe.html#cb335-3" tabindex="-1"></a>                 <span class="at">cutpoint =</span> <span class="dv">0</span>, </span>
<span id="cb335-4"><a href="eaqe.html#cb335-4" tabindex="-1"></a>                 <span class="at">z =</span> d<span class="sc">$</span>treatProb)</span>
<span id="cb335-5"><a href="eaqe.html#cb335-5" tabindex="-1"></a></span>
<span id="cb335-6"><a href="eaqe.html#cb335-6" tabindex="-1"></a>frdd_mod <span class="ot">&lt;-</span> <span class="fu">rdd_reg_lm</span>(<span class="at">rdd_object =</span> data, </span>
<span id="cb335-7"><a href="eaqe.html#cb335-7" tabindex="-1"></a>                       <span class="at">slope =</span> <span class="st">&quot;same&quot;</span>)</span>
<span id="cb335-8"><a href="eaqe.html#cb335-8" tabindex="-1"></a>frdd_mod</span>
<span id="cb335-9"><a href="eaqe.html#cb335-9" tabindex="-1"></a><span class="co">#&gt; </span><span class="al">###</span><span class="co"> RDD regression: parametric </span><span class="al">###</span></span>
<span id="cb335-10"><a href="eaqe.html#cb335-10" tabindex="-1"></a><span class="co">#&gt;  Polynomial order:  1 </span></span>
<span id="cb335-11"><a href="eaqe.html#cb335-11" tabindex="-1"></a><span class="co">#&gt;  Slopes:  same </span></span>
<span id="cb335-12"><a href="eaqe.html#cb335-12" tabindex="-1"></a><span class="co">#&gt;  Number of obs: 2000 (left: 999, right: 1001)</span></span>
<span id="cb335-13"><a href="eaqe.html#cb335-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb335-14"><a href="eaqe.html#cb335-14" tabindex="-1"></a><span class="co">#&gt;  Coefficient:</span></span>
<span id="cb335-15"><a href="eaqe.html#cb335-15" tabindex="-1"></a><span class="co">#&gt;   Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb335-16"><a href="eaqe.html#cb335-16" tabindex="-1"></a><span class="co">#&gt; D 1.981297   0.084696  23.393 &lt; 2.2e-16 ***</span></span>
<span id="cb335-17"><a href="eaqe.html#cb335-17" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb335-18"><a href="eaqe.html#cb335-18" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The estimate is close to <span class="math inline">\(2\)</span>, the population treatment effect. We may call <tt>plot()</tt> on the model object to obtain a figure consisting of binned data and the estimated regression function.</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="eaqe.html#cb336-1" tabindex="-1"></a><span class="co"># plot estimated FRDD function</span></span>
<span id="cb336-2"><a href="eaqe.html#cb336-2" tabindex="-1"></a><span class="fu">plot</span>(frdd_mod, </span>
<span id="cb336-3"><a href="eaqe.html#cb336-3" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.5</span>, </span>
<span id="cb336-4"><a href="eaqe.html#cb336-4" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="fl">0.4</span>,</span>
<span id="cb336-5"><a href="eaqe.html#cb336-5" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>),</span>
<span id="cb336-6"><a href="eaqe.html#cb336-6" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="dv">5</span>),</span>
<span id="cb336-7"><a href="eaqe.html#cb336-7" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;W&quot;</span>,</span>
<span id="cb336-8"><a href="eaqe.html#cb336-8" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-563-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>What if we used a SRDD instead, thereby ignoring the fact that treatment is not perfectly determined by the cutoff in <span class="math inline">\(W\)</span>? We may get an impression of the consequences by estimating an SRDD using the previously simulated data.</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="eaqe.html#cb337-1" tabindex="-1"></a><span class="co"># estimate SRDD</span></span>
<span id="cb337-2"><a href="eaqe.html#cb337-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">rdd_data</span>(d<span class="sc">$</span>Y, </span>
<span id="cb337-3"><a href="eaqe.html#cb337-3" tabindex="-1"></a>                 d<span class="sc">$</span>W, </span>
<span id="cb337-4"><a href="eaqe.html#cb337-4" tabindex="-1"></a>                 <span class="at">cutpoint =</span> <span class="dv">0</span>)</span>
<span id="cb337-5"><a href="eaqe.html#cb337-5" tabindex="-1"></a></span>
<span id="cb337-6"><a href="eaqe.html#cb337-6" tabindex="-1"></a>srdd_mod <span class="ot">&lt;-</span> <span class="fu">rdd_reg_lm</span>(<span class="at">rdd_object =</span> data, </span>
<span id="cb337-7"><a href="eaqe.html#cb337-7" tabindex="-1"></a>                       <span class="at">slope =</span> <span class="st">&quot;same&quot;</span>)</span>
<span id="cb337-8"><a href="eaqe.html#cb337-8" tabindex="-1"></a>srdd_mod</span>
<span id="cb337-9"><a href="eaqe.html#cb337-9" tabindex="-1"></a><span class="co">#&gt; </span><span class="al">###</span><span class="co"> RDD regression: parametric </span><span class="al">###</span></span>
<span id="cb337-10"><a href="eaqe.html#cb337-10" tabindex="-1"></a><span class="co">#&gt;  Polynomial order:  1 </span></span>
<span id="cb337-11"><a href="eaqe.html#cb337-11" tabindex="-1"></a><span class="co">#&gt;  Slopes:  same </span></span>
<span id="cb337-12"><a href="eaqe.html#cb337-12" tabindex="-1"></a><span class="co">#&gt;  Number of obs: 2000 (left: 999, right: 1001)</span></span>
<span id="cb337-13"><a href="eaqe.html#cb337-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb337-14"><a href="eaqe.html#cb337-14" tabindex="-1"></a><span class="co">#&gt;  Coefficient:</span></span>
<span id="cb337-15"><a href="eaqe.html#cb337-15" tabindex="-1"></a><span class="co">#&gt;   Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb337-16"><a href="eaqe.html#cb337-16" tabindex="-1"></a><span class="co">#&gt; D 1.585038   0.067756  23.393 &lt; 2.2e-16 ***</span></span>
<span id="cb337-17"><a href="eaqe.html#cb337-17" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb337-18"><a href="eaqe.html#cb337-18" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The estimate obtained using a SRDD is suggestive of a substantial downward bias. In fact, this procedure is inconsistent for the true causal effect so increasing the sample would not alleviate the bias.</p>
<p>The book continues with a discussion of potential problems with quasi-experiments. As for all empirical studies, these potential problems are related to internal and external validity. This part is followed by a technical discussion of treatment effect estimation when the causal effect of treatment is heterogeneous in the population. We encourage you to work on these sections on your own.</p>
<div id="summary-5" class="section level4 unnumbered hasAnchor">
<h4>Summary<a href="eaqe.html#summary-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This chapter has introduced the concept of causal effects in randomized controlled experiments and quasi-experiments where variations in circumstances or accidents of nature are treated as sources of “as if” random assignment to treatment. We have also discussed methods that allow for consistent estimation of these effects in both settings. These included the <em>differences estimator</em>, the <em>differences-in-differences estimator</em> as well as <em>sharp</em> and <em>fuzzy regression discontinuity design</em> estimators. It was shown how to apply these estimation techniques in <tt>R</tt>.</p>
<p>In an empirical application we have shown how to replicate the results of the analysis of the STAR data presented in Chapter 13.3 of the book using <tt>R</tt>. This study uses a randomized controlled experiment to assess whether smaller classes improve students’ performance on standardized tests. Being related to a randomized controlled experiment, the data of this study is fundamentally different to those used in the cross-section studies in Chapters <a href="lrwor.html#lrwor">4</a> to <a href="nrf.html#nrf">8</a>. We therefore have motivated usage of a <em>differences estimator</em>.</p>
<p>Chapter <a href="ivr.html#attdfc">12.4</a> demonstrated how estimates of treatment effects can be obtained when the design of the study is a quasi-experiment that allows for <em>differences-in-differences</em> or <em>regression discontinuity design</em> estimators. In particular, we have introduced functions of the package <tt>rddtools</tt> that are convenient for estimation as well as graphical analysis when estimating a regression discontinuity design.</p>
</div>
</div>
</div>
<div id="exercises-13" class="section level2 hasAnchor" number="13.5">
<h2><span class="header-section-number">13.5</span> Exercises<a href="eaqe.html#exercises-13" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The subsequent exercises guide you in reproducing some of the results presented in one of the most famous DID studies by <span class="citation">Card and Krueger (<a href="#ref-card1994">1994</a>)</span>. The authors use geography as the “as if” random treatment assignment to study the effect on employment in fast food restaurants caused by an increase in the state minimum wage in New Jersey in the year of 1992, see Chapter <a href="eaqe.html#qe">13.4</a>.</p>
<p>The study is based on survey data collected in February 1992 and in November 1992, after New Jersey’s minimum wage rose by <span class="math inline">\(\$0.80\)</span> from <span class="math inline">\(\$4.25\)</span> to <span class="math inline">\(\$5.05\)</span> in April 1992.</p>
<p>Estimating the effect of the wage increase simply by computing the change in employment in New Jersey (as you are asked to do in Exercise 3) would fail to control for omitted variables. By using Pennsylvania as a control in a difference-in-differences (DID) model one can control for variables with a common influence on New Jersey (treatment group) and Pennsylvania (control group). This reduces the risk of omitted variable bias enormously and even works when these variables are unobserved.</p>
<p>For the DID approach to work we must assume that New Jersey and Pennsylvania have parallel trends over time, i.e., we assume that the (unobserved) factors influence employment in Pennsylvania and New Jersey in the same manner. This allows to interpret an observed change in employment in Pennsylvania as the change New Jersey would have experienced if there was no increase in minimum wage (and vice versa).</p>
<p>Against to what standard economic theory would suggest, the authors did not find evidence that the increased minimum wage induced an increase in unemployment in New Jersey using the DID approach: quite the contrary, their results suggest that the <span class="math inline">\(\$0.80\)</span> minimum wage increase in New Jersey led to a 2.75 full-time equivalent (FTE) increase in employment.</p>
<div id="the-data-from-card-krueger-1994" class="section level4 unnumbered hasAnchor DCexercise">
<h4>1. The Data from Card &amp; Krueger (1994)<a href="eaqe.html#the-data-from-card-krueger-1994" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><tt>fastfood.dat</tt>, the dataset used by Card &amp; Krueger (1994) can be downloaded <a href="http://www.stat.ucla.edu/projects/datasets/fastfood.dta">here</a>. See this <a href="http://www.stat.ucla.edu/projects/datasets/fastfood-explanation.html">link</a> for a detailed explanation of the variables.</p>
<p>This exercise asks you to import the dataset in <tt>R</tt> and to perform some formatting necessary for the subsequent analysis. This can be tedious using base <tt>R</tt> functions but is easily done using the <tt>dplyr</tt> package introducted in Chapter <a href="arosur.html#aattggoe">3.6</a>.</p>
<p>The URL to the dataset is saved in <tt>data_URL</tt>.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Attach the packages <tt>dplyr</tt> and <tt>foreign</tt>.</p></li>
<li><p>Read in the dataset <tt>fastfood.dta</tt> using <tt>data_URL</tt> and assign it to a <tt>data.frame</tt> named <tt>dat</tt>.</p></li>
</ul>
<p>In their study, Card &amp; Krueger (1994) measure employment in full time equivalents which they define as the number of full time employees (<tt>empft</tt> and <tt>empft2</tt>) plus the number of managers (<tt>nmgrs</tt> and <tt>nmgrs2</tt>) plus 0.5 times the number part-time employees (<tt>emppt</tt> / <tt>emppt2</tt>).
- Define full-time employment before (<tt>FTE</tt>) and after the wage increase (<tt>FTE2</tt>) and add both variables to <tt>dat</tt></p>
<iframe src="DCL/ex13_1.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p><tt>read.dta()</tt> from the <tt>foreign</tt> package reads <tt>.dta</tt> files, a format used by the statistical software package <em>STATA</em>.</p></li>
<li><p><tt>mutate()</tt> generates new columns using existing ones.</p></li>
</ul>
</div>
<div id="state-specific-estimates-of-full-time-employment-i" class="section level4 unnumbered hasAnchor DCexercise">
<h4>2. State Specific Estimates of Full-Time Employment — I<a href="eaqe.html#state-specific-estimates-of-full-time-employment-i" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This exercise asks you to perform a quick calculation of state specific sample means in order to check whether our data on full-time employment is in alignment with the data used by Card &amp; Krueger (1994).</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Generate subsets of <tt>dat</tt> to seperate observations for New Jersey and Pennsylvania. Save them as <tt>dat_NJ</tt> and <tt>dat_PA</tt>.</p></li>
<li><p>Compute sample means of full-time employment equivalents for New Jersey and Pennsylvania both before and after the minium wage increase in New Jersey. It suffices if your code prints the correct values to the console.</p></li>
</ul>
<iframe src="DCL/ex13_2.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li>You may use <tt>group_by()</tt> in conjunction with <tt>summarise()</tt> to compute groupwise means. Both function come with the <tt>dplyr</tt> package.</li>
</ul>
</div>
<div id="state-specific-estimates-of-full-time-employment-ii" class="section level4 unnumbered hasAnchor DCexercise">
<h4>3. State Specific Estimates of Full-Time Employment — II<a href="eaqe.html#state-specific-estimates-of-full-time-employment-ii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A naive approach to investigate the impact of the minimum wage increase on employment is to use the estimated difference in mean employment before and after the wage increase for New Jersey fast food restaurants.</p>
<p>This exercise asks you to do the aforementioned and further to test if the estimated difference is significantly different from zero using a <em>robust</em> <span class="math inline">\(t\)</span>-test.</p>
<p>The subsets <tt>dat_NJ</tt> and <tt>dat_PA</tt> from the previous exercise are available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Use <tt>dat_NJ</tt> for a robust test of the hypothesis that there is no difference in full-time employment before and after the wage hike in New Jersey at the level of <span class="math inline">\(5\%\)</span>.</li>
</ul>
<iframe src="DCL/ex13_3.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li>The testing problem amounts to a two-sample <span class="math inline">\(t\)</span>-test which is conveniently done using <tt>t.test()</tt>.</li>
</ul>
</div>
<div id="preparing-the-data-for-regression" class="section level4 unnumbered hasAnchor DCexercise">
<h4>4. Preparing the Data for Regression<a href="eaqe.html#preparing-the-data-for-regression" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The estimations done in Exercise 3 and the difference-in-differences approach we are working towards can be shown to produce the same results OLS applied to specific regression models, see Chapters <a href="eaqe.html#poceaie">13.1</a> and <a href="arosur.html#aattggoe">3.6</a>.</p>
<p>This exercise asks you to construct a dataset which is more convenient for this purpose than the dataset <tt>dat</tt>.</p>
<p><strong>Instructions:</strong></p>
<p>Generate the dataset <tt>reg_dat</tt> from <tt>dat</tt> in <em>long format</em>, i.e., make sure that for each restaurant (identified by <tt>sheet</tt>) one observation before and one after the minimum wage increase (identified by <tt>D</tt>) are included.</p>
<p>Only consider the following variables:</p>
<ul>
<li><p><tt>id</tt>: sheet number (unique store id)</p></li>
<li><p><tt>chain</tt>: chain 1=Burger King; 2=KFC; 3=Roy Rogers; 4=Wendys</p></li>
<li><p><tt>state</tt>: 1 if New Jersey; 0 if Pennsylvania</p></li>
<li><p><tt>empl</tt>: measure of full-time employment (<tt>FTE</tt> / <tt>FTE2</tt>)</p></li>
<li><p><tt>D</tt>: dummy indicating if the observation was made before or after the minimum wage increase in New Jersey.</p></li>
</ul>
<iframe src="DCL/ex13_4.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>The original dataset <tt>dat</tt> has 410 observations of 48 variables (check this using <tt>dim(dat)</tt>). The dataset <tt>reg_dat</tt> you are asked to generate must consist of 820 observations of the variables listed above.</p></li>
<li><p>It is straightforward to generate a <tt>data.frame</tt> from the columns of another <tt>data.frame</tt> using <tt>data.frame(…)</tt>.</p></li>
<li><p>Use <tt>rbind()</tt> to combine two objects of type <tt>data.frame</tt> by row.</p></li>
</ul>
</div>
<div id="a-difference-estimate-using-data-from-card-krueger-1994-ii" class="section level4 unnumbered hasAnchor DCexercise">
<h4>5. A Difference Estimate using Data from Card &amp; Krueger (1994) — II<a href="eaqe.html#a-difference-estimate-using-data-from-card-krueger-1994-ii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><tt>reg_dat</tt> from Exercise 4 is a <em>panel dataset</em> as it has two observations for each fast food restaurant <span class="math inline">\(i=1,\dots,410\)</span>, at time periods <span class="math inline">\(t=0,1\)</span>.</p>
<p>Thus we may write down the simple regression model</p>
<p><span class="math display">\[employment_{i,t} = \beta_0 + \beta_1 D_t + \varepsilon_{i,t},\]</span></p>
<p>where <span class="math inline">\(D_t\)</span> is a dummy variable which equals <span class="math inline">\(0\)</span> if the observation was made before the minimum wage change (<span class="math inline">\(t=0\)</span>) and <span class="math inline">\(1\)</span> after the minimum wage change (<span class="math inline">\(t=1\)</span>), i.e.,</p>
<p><span class="math display">\[\begin{align*}
D_t = \begin{cases}
0, &amp; \, \text{if $t=0$ (before wage change),} \\
1, &amp; \, \text{if $t=1$ (after wage change)}
\end{cases}
\end{align*}\]</span></p>
<p>and assume that observations for <em>New Jersey restaurants only</em> are used in computing <span class="math inline">\(\hat\beta_1\)</span>, the OLS estimator of <span class="math inline">\(\beta_1\)</span>, which is also called the <em>differences estimator</em>.</p>
<p>The dataset <tt>reg_dat</tt> from Exercise 4 and the New Jersey subset <tt>dat_NJ</tt> are available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Estimate <span class="math inline">\(\beta_1\)</span> in the model above using OLS. Save the estimated model to <tt>emp_mod</tt>.</p></li>
<li><p>Obtain a robust summary of the results and interpret your findings.</p></li>
</ul>
<iframe src="DCL/ex13_5.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>Remember that dependencies of the <tt>AER</tt> package include functions for robust inference on regression models.</p></li>
<li><p>The argument <tt>subset</tt> in <tt>lm()</tt> takes a logical vector which identifies observations used for estimation.</p></li>
</ul>
</div>
<div id="a-difference-estimate-using-data-from-card-krueger-1994-ii-1" class="section level4 unnumbered hasAnchor DCexercise">
<h4>6. A Difference Estimate using Data from Card &amp; Krueger (1994) — II<a href="eaqe.html#a-difference-estimate-using-data-from-card-krueger-1994-ii-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The estimate obtained using <tt>t.test()</tt> on the New Jersey subset in Exercise 3 and the OLS estimate of <span class="math inline">\(\hat\beta_1\)</span> in Exercise 5 are numercially the same. This also holds for the reported <span class="math inline">\(t\)</span>-statistics if the same standard error formulas are used (<tt>t.test(…, var.equal = T)</tt> and <tt>coeftest(…, vcov. = vcovHC, type = “HC1”)</tt>).</p>
<p>This exercise asks you to check that the above statement is true.</p>
<p>The data from the previous exercises, the result of <tt>t.test(…)</tt> from Exercise 3 as well as the regression model object <tt>emp_mod</tt> from Exercise 5 are available in your working environment. The <tt>AER</tt> package has been attached.</p>
<p><em>No submission correctness tests are run.</em></p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Check that the estimate of <span class="math inline">\(\beta_1\)</span> in Exercise 5 is equal to the estimated difference in mean employment of New Jersey fastfood restaurants before and after the minimum wage increase from Exercise 3.</p></li>
<li><p>Convince yourself that the <span class="math inline">\(t\)</span>-statistics reported by <tt>coeftest(…)</tt> in Exercise 5 and <tt>t.test(…)</tt> in Exercise 3 match.</p></li>
</ul>
<iframe src="DCL/ex13_6.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<div id="a-difference-in-differences-estimate-ii" class="section level4 unnumbered hasAnchor DCexercise">
<h4>7. A Difference-in-Differences Estimate — II<a href="eaqe.html#a-difference-in-differences-estimate-ii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>As mentioned in Chapter <a href="arosur.html#aattggoe">3.6</a>, the approach discussed in Exercises 5 and 6 is naive: <span class="math inline">\(\hat\beta_1\)</span> is a biased estimate of the average effect of the minimum wage increase on employment because we cannot control for other determinants of employment that correlate with <span class="math inline">\(D_t\)</span>. As an example, think about macro-economic developments which have a positive impact on the labor market such that employment is higher in the period after the minimum wage increase. It is likely that <span class="math inline">\(D_t\)</span> is positively correlated with the error term such that <span class="math inline">\(\hat\beta_1\)</span> <em>overestimates</em> the effect of the wage hike on employment.</p>
<p>This motivates usage of the difference-in-differences (DID) estimator outlined in Chapter <a href="arosur.html#aattggoe">3.6</a>.</p>
<p>Consider the liner regression model</p>
<p><span class="math display">\[employment_{i,t} = \beta_0 + \beta_1 D_t + \beta_2 state_i + \beta_3 (D_t \times state_i) + \varepsilon_{i,t},\]</span></p>
<p>where we use indices <span class="math inline">\(i\)</span> and <span class="math inline">\(t\)</span> just as in the simple regression model in Exercise 5.
In this model, <span class="math inline">\(\beta_3\)</span> is the coefficient we are interested in as it is interpreted as the average difference in employment of New Jersey fastfood restaurants before and after the wage increase after controlling for unobservables which are common to New Jersey and Pennsylvania, the control group. The OLS estimator of <span class="math inline">\(\beta_3\)</span> is called a DID estimator.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Estimate the above model using OLS and obtain a robust summary.</p></li>
<li><p>Interpret your findings.</p></li>
</ul>
<iframe src="DCL/ex13_7.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-card1994" class="csl-entry">
Card, D., and Alan B. Krueger. 1994. <span>“<span>M</span>inimum <span>W</span>ages and <span>E</span>mployment: <span>A</span> <span>C</span>ase <span>S</span>tudy of the <span>F</span>ast-<span>F</span>ood <span>I</span>ndustry in <span>N</span>ew <span>J</span>ersey and <span>P</span>ennsylvania.”</span> <em>The American Economic Review</em> 84 (4): 772–93.
</div>
<div id="ref-R-mvtnorm" class="csl-entry">
Genz, Alan, Frank Bretz, Tetsuhisa Miwa, Xuefei Mi, and Torsten Hothorn. 2023. <em><span class="nocase">mvtnorm: Multivariate Normal and t Distributions</span></em> (version 1.2-3). <a href="http://mvtnorm.R-forge.R-project.org">http://mvtnorm.R-forge.R-project.org</a>.
</div>
<div id="ref-R-stargazer" class="csl-entry">
Hlavac, Marek. 2022. <em>Stargazer: Well-Formatted Regression and Summary Statistics Tables</em>. Bratislava, Slovakia: Social Policy Institute. <a href="https://CRAN.R-project.org/package=stargazer">https://CRAN.R-project.org/package=stargazer</a>.
</div>
<div id="ref-R-AER" class="csl-entry">
Kleiber, Christian, and Achim Zeileis. 2008. <em>Applied Econometrics with <span>R</span></em>. New York: Springer-Verlag. <a href="https://CRAN.R-project.org/package=AER">https://CRAN.R-project.org/package=AER</a>.
</div>
<div id="ref-R-MASS" class="csl-entry">
Ripley, Brian. 2023. <em><span class="nocase">MASS: Support Functions and Datasets for Venables and Ripley’s MASS</span></em> (version 7.3-60). <a href="http://www.stats.ox.ac.uk/pub/MASS4/">http://www.stats.ox.ac.uk/pub/MASS4/</a>.
</div>
<div id="ref-R-rddtools" class="csl-entry">
Stigler, Matthieu, and Bastiaan Quast. 2022. <em><span class="nocase">rddtools: Toolbox for Regression Discontinuity Design (RDD)</span></em> (version 1.6.0). <a href="https://qua.st/rddtools/">https://qua.st/rddtools/</a>.
</div>
<div id="ref-R-dplyr" class="csl-entry">
Wickham, Hadley, Romain François, Lionel Henry, Kirill Müller, and Davis Vaughan. 2023. <em><span class="nocase">dplyr: A Grammar of Data Manipulation</span></em> (version 1.1.3). <a href="https://dplyr.tidyverse.org">https://dplyr.tidyverse.org</a>.
</div>
<div id="ref-R-scales" class="csl-entry">
Wickham, Hadley, Thomas Lin Pedersen, and Dana Seidel. 2023. <em><span class="nocase">scales: Scale Functions for Visualization</span></em> (version 1.3.0). <a href="https://scales.r-lib.org">https://scales.r-lib.org</a>.
</div>
<div id="ref-R-tidyr" class="csl-entry">
Wickham, Hadley, Davis Vaughan, and Maximilian Girlich. 2023. <em><span class="nocase">tidyr: Tidy Messy Data</span></em> (version 1.3.0). <a href="https://tidyr.tidyverse.org">https://tidyr.tidyverse.org</a>.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="9">
<li id="fn9"><p>See Chapter 13.4 of the book for some example studies that are based on quasi-experiments.<a href="eaqe.html#fnref9" class="footnote-back">↩︎</a></p></li>
<li id="fn10"><p>Also see the box <em>What is the Effect on Employment of the Minimum Wage?</em> in Chapter 13.4 of the book.<a href="eaqe.html#fnref10" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ivr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ittsraf.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mca91/EconometricsWithR/edit/master/13-ch13.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
