<!DOCTYPE html>
<html lang="en-US" xml:lang="en-US">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10 Regression with Panel Data | Introduction to Econometrics with R</title>
  <meta name="description" content="Beginners with little background in statistics and econometrics often have a hard time understanding the benefits of having programming skills for learning and applying Econometrics. ‘Introduction to Econometrics with R’ is an interactive companion to the well-received textbook ‘Introduction to Econometrics’ by James H. Stock and Mark W. Watson (2015). It gives a gentle introduction to the essentials of R programming and guides students in implementing the empirical applications presented throughout the textbook using the newly aquired skills. This is supported by interactive programming exercises generated with DataCamp Light and integration of interactive visualizations of central concepts which are based on the flexible JavaScript library D3.js." />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="10 Regression with Panel Data | Introduction to Econometrics with R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://www.econometrics-with-r.org//images/cover.png" />
  <meta property="og:description" content="Beginners with little background in statistics and econometrics often have a hard time understanding the benefits of having programming skills for learning and applying Econometrics. ‘Introduction to Econometrics with R’ is an interactive companion to the well-received textbook ‘Introduction to Econometrics’ by James H. Stock and Mark W. Watson (2015). It gives a gentle introduction to the essentials of R programming and guides students in implementing the empirical applications presented throughout the textbook using the newly aquired skills. This is supported by interactive programming exercises generated with DataCamp Light and integration of interactive visualizations of central concepts which are based on the flexible JavaScript library D3.js." />
  <meta name="github-repo" content="mca91/EconometricsWithR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10 Regression with Panel Data | Introduction to Econometrics with R" />
  
  <meta name="twitter:description" content="Beginners with little background in statistics and econometrics often have a hard time understanding the benefits of having programming skills for learning and applying Econometrics. ‘Introduction to Econometrics with R’ is an interactive companion to the well-received textbook ‘Introduction to Econometrics’ by James H. Stock and Mark W. Watson (2015). It gives a gentle introduction to the essentials of R programming and guides students in implementing the empirical applications presented throughout the textbook using the newly aquired skills. This is supported by interactive programming exercises generated with DataCamp Light and integration of interactive visualizations of central concepts which are based on the flexible JavaScript library D3.js." />
  <meta name="twitter:image" content="https://www.econometrics-with-r.org//images/cover.png" />

<meta name="author" content="Christoph Hanck, Martin Arnold, Alexander Gerber, and Martin Schmelzer" />


<meta name="date" content="2024-12-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="asbomr.html"/>
<link rel="next" href="rwabdv.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.3/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="toc.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><center><img src="images/logo.png" alt="logo" width="50%" height="50%"style="margin: 15px 0 0 0"></center></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#colophon"><i class="fa fa-check"></i><b>1.1</b> Colophon</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#a-very-short-introduction-to-r-and-rstudio"><i class="fa fa-check"></i><b>1.2</b> A Very Short Introduction to <tt>R</tt> and <em>RStudio</em></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="pt.html"><a href="pt.html"><i class="fa fa-check"></i><b>2</b> Probability Theory</a>
<ul>
<li class="chapter" data-level="2.1" data-path="pt.html"><a href="pt.html#random-variables-and-probability-distributions"><i class="fa fa-check"></i><b>2.1</b> Random Variables and Probability Distributions</a>
<ul>
<li class="chapter" data-level="" data-path="pt.html"><a href="pt.html#probability-distributions-of-discrete-random-variables"><i class="fa fa-check"></i>Probability Distributions of Discrete Random Variables</a></li>
<li class="chapter" data-level="" data-path="pt.html"><a href="pt.html#bernoulli-trials"><i class="fa fa-check"></i>Bernoulli Trials</a></li>
<li class="chapter" data-level="" data-path="pt.html"><a href="pt.html#expected-value-mean-and-variance"><i class="fa fa-check"></i>Expected Value, Mean and Variance</a></li>
<li class="chapter" data-level="" data-path="pt.html"><a href="pt.html#probability-distributions-of-continuous-random-variables"><i class="fa fa-check"></i>Probability Distributions of Continuous Random Variables</a></li>
<li class="chapter" data-level="" data-path="pt.html"><a href="pt.html#the-normal-distribution"><i class="fa fa-check"></i>The Normal Distribution</a></li>
<li class="chapter" data-level="" data-path="pt.html"><a href="pt.html#the-chi-squared-distribution"><i class="fa fa-check"></i>The Chi-Squared Distribution</a></li>
<li class="chapter" data-level="" data-path="pt.html"><a href="pt.html#thetdist"><i class="fa fa-check"></i>The Student t Distribution</a></li>
<li class="chapter" data-level="" data-path="pt.html"><a href="pt.html#the-f-distribution"><i class="fa fa-check"></i>The F Distribution</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="pt.html"><a href="pt.html#RSATDOSA"><i class="fa fa-check"></i><b>2.2</b> Random Sampling and the Distribution of Sample Averages</a>
<ul>
<li class="chapter" data-level="" data-path="pt.html"><a href="pt.html#mean-and-variance-of-the-sample-mean"><i class="fa fa-check"></i>Mean and Variance of the Sample Mean</a></li>
<li class="chapter" data-level="" data-path="pt.html"><a href="pt.html#large-sample-approximations-to-sampling-distributions"><i class="fa fa-check"></i>Large Sample Approximations to Sampling Distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="pt.html"><a href="pt.html#exercises-2"><i class="fa fa-check"></i><b>2.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="arosur.html"><a href="arosur.html"><i class="fa fa-check"></i><b>3</b> A Review of Statistics using R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="arosur.html"><a href="arosur.html#estimation-of-the-population-mean"><i class="fa fa-check"></i><b>3.1</b> Estimation of the Population Mean</a></li>
<li class="chapter" data-level="3.2" data-path="arosur.html"><a href="arosur.html#potsm"><i class="fa fa-check"></i><b>3.2</b> Properties of the Sample Mean</a></li>
<li class="chapter" data-level="3.3" data-path="arosur.html"><a href="arosur.html#hypothesis-tests-concerning-the-population-mean"><i class="fa fa-check"></i><b>3.3</b> Hypothesis Tests concerning the Population Mean</a>
<ul>
<li class="chapter" data-level="" data-path="arosur.html"><a href="arosur.html#the-p-value"><i class="fa fa-check"></i>The p-Value</a></li>
<li class="chapter" data-level="" data-path="arosur.html"><a href="arosur.html#calculating-the-p-value-when-the-standard-deviation-is-known"><i class="fa fa-check"></i>Calculating the p-Value when the Standard Deviation is Known</a></li>
<li class="chapter" data-level="" data-path="arosur.html"><a href="arosur.html#SVSSDASE"><i class="fa fa-check"></i>Sample Variance, Sample Standard Deviation and Standard Error</a></li>
<li class="chapter" data-level="" data-path="arosur.html"><a href="arosur.html#calculating-the-p-value-when-the-standard-deviation-is-unknown"><i class="fa fa-check"></i>Calculating the p-value When the Standard Deviation is Unknown</a></li>
<li class="chapter" data-level="" data-path="arosur.html"><a href="arosur.html#the-t-statistic"><i class="fa fa-check"></i>The t-statistic</a></li>
<li class="chapter" data-level="" data-path="arosur.html"><a href="arosur.html#hypothesis-testing-with-a-prespecified-significance-level"><i class="fa fa-check"></i>Hypothesis Testing with a Prespecified Significance Level</a></li>
<li class="chapter" data-level="" data-path="arosur.html"><a href="arosur.html#one-sided-alternatives"><i class="fa fa-check"></i>One-sided Alternatives</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="arosur.html"><a href="arosur.html#confidence-intervals-for-the-population-mean"><i class="fa fa-check"></i><b>3.4</b> Confidence Intervals for the Population Mean</a></li>
<li class="chapter" data-level="3.5" data-path="arosur.html"><a href="arosur.html#cmfdp"><i class="fa fa-check"></i><b>3.5</b> Comparing Means from Different Populations</a></li>
<li class="chapter" data-level="3.6" data-path="arosur.html"><a href="arosur.html#aattggoe"><i class="fa fa-check"></i><b>3.6</b> An Application to the Gender Gap of Earnings</a></li>
<li class="chapter" data-level="3.7" data-path="arosur.html"><a href="arosur.html#scatterplots-sample-covariance-and-sample-correlation"><i class="fa fa-check"></i><b>3.7</b> Scatterplots, Sample Covariance and Sample Correlation</a></li>
<li class="chapter" data-level="3.8" data-path="arosur.html"><a href="arosur.html#exercises-3"><i class="fa fa-check"></i><b>3.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lrwor.html"><a href="lrwor.html"><i class="fa fa-check"></i><b>4</b> Linear Regression with One Regressor</a>
<ul>
<li class="chapter" data-level="4.1" data-path="lrwor.html"><a href="lrwor.html#simple-linear-regression"><i class="fa fa-check"></i><b>4.1</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="4.2" data-path="lrwor.html"><a href="lrwor.html#estimating-the-coefficients-of-the-linear-regression-model"><i class="fa fa-check"></i><b>4.2</b> Estimating the Coefficients of the Linear Regression Model</a>
<ul>
<li class="chapter" data-level="" data-path="lrwor.html"><a href="lrwor.html#the-ordinary-least-squares-estimator"><i class="fa fa-check"></i>The Ordinary Least Squares Estimator</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="lrwor.html"><a href="lrwor.html#measures-of-fit"><i class="fa fa-check"></i><b>4.3</b> Measures of Fit</a>
<ul>
<li class="chapter" data-level="" data-path="lrwor.html"><a href="lrwor.html#the-coefficient-of-determination"><i class="fa fa-check"></i>The Coefficient of Determination</a></li>
<li class="chapter" data-level="" data-path="lrwor.html"><a href="lrwor.html#the-standard-error-of-the-regression"><i class="fa fa-check"></i>The Standard Error of the Regression</a></li>
<li class="chapter" data-level="" data-path="lrwor.html"><a href="lrwor.html#application-to-the-test-score-data"><i class="fa fa-check"></i>Application to the Test Score Data</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="lrwor.html"><a href="lrwor.html#tlsa"><i class="fa fa-check"></i><b>4.4</b> The Least Squares Assumptions</a>
<ul>
<li class="chapter" data-level="" data-path="lrwor.html"><a href="lrwor.html#assumption-1-the-error-term-has-conditional-mean-of-zero"><i class="fa fa-check"></i>Assumption 1: The Error Term has Conditional Mean of Zero</a></li>
<li class="chapter" data-level="" data-path="lrwor.html"><a href="lrwor.html#assumption-2-independently-and-identically-distributed-data"><i class="fa fa-check"></i>Assumption 2: Independently and Identically Distributed Data</a></li>
<li class="chapter" data-level="" data-path="lrwor.html"><a href="lrwor.html#assumption-3-large-outliers-are-unlikely"><i class="fa fa-check"></i>Assumption 3: Large Outliers are Unlikely</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="lrwor.html"><a href="lrwor.html#tsdotoe"><i class="fa fa-check"></i><b>4.5</b> The Sampling Distribution of the OLS Estimator</a>
<ul>
<li class="chapter" data-level="" data-path="lrwor.html"><a href="lrwor.html#simulation-study-1"><i class="fa fa-check"></i>Simulation Study 1</a></li>
<li class="chapter" data-level="" data-path="lrwor.html"><a href="lrwor.html#simulation-study-2"><i class="fa fa-check"></i>Simulation Study 2</a></li>
<li class="chapter" data-level="" data-path="lrwor.html"><a href="lrwor.html#simulation-study-3"><i class="fa fa-check"></i>Simulation Study 3</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="lrwor.html"><a href="lrwor.html#exercises-4"><i class="fa fa-check"></i><b>4.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="htaciitslrm.html"><a href="htaciitslrm.html"><i class="fa fa-check"></i><b>5</b> Hypothesis Tests and Confidence Intervals in SLR Model</a>
<ul>
<li class="chapter" data-level="5.1" data-path="htaciitslrm.html"><a href="htaciitslrm.html#testing-two-sided-hypotheses-concerning-the-slope-coefficient"><i class="fa fa-check"></i><b>5.1</b> Testing Two-Sided Hypotheses concerning the Slope Coefficient</a></li>
<li class="chapter" data-level="5.2" data-path="htaciitslrm.html"><a href="htaciitslrm.html#cifrc"><i class="fa fa-check"></i><b>5.2</b> Confidence Intervals for Regression Coefficients</a>
<ul>
<li class="chapter" data-level="" data-path="htaciitslrm.html"><a href="htaciitslrm.html#simulation-study-confidence-intervals"><i class="fa fa-check"></i>Simulation Study: Confidence Intervals</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="htaciitslrm.html"><a href="htaciitslrm.html#rwxiabv"><i class="fa fa-check"></i><b>5.3</b> Regression when X is a Binary Variable</a></li>
<li class="chapter" data-level="5.4" data-path="htaciitslrm.html"><a href="htaciitslrm.html#hah"><i class="fa fa-check"></i><b>5.4</b> Heteroskedasticity and Homoskedasticity</a>
<ul>
<li class="chapter" data-level="" data-path="htaciitslrm.html"><a href="htaciitslrm.html#a-real-world-example-for-heteroskedasticity"><i class="fa fa-check"></i>A Real-World Example for Heteroskedasticity</a></li>
<li class="chapter" data-level="" data-path="htaciitslrm.html"><a href="htaciitslrm.html#should-we-care-about-heteroskedasticity"><i class="fa fa-check"></i>Should We Care About Heteroskedasticity?</a></li>
<li class="chapter" data-level="" data-path="htaciitslrm.html"><a href="htaciitslrm.html#computation-of-heteroskedasticity-robust-standard-errors"><i class="fa fa-check"></i>Computation of Heteroskedasticity-Robust Standard Errors</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="htaciitslrm.html"><a href="htaciitslrm.html#the-gauss-markov-theorem"><i class="fa fa-check"></i><b>5.5</b> The Gauss-Markov Theorem</a>
<ul>
<li class="chapter" data-level="" data-path="htaciitslrm.html"><a href="htaciitslrm.html#simulation-study-blue-estimator"><i class="fa fa-check"></i>Simulation Study: BLUE Estimator</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="htaciitslrm.html"><a href="htaciitslrm.html#using-the-t-statistic-in-regression-when-the-sample-size-is-small"><i class="fa fa-check"></i><b>5.6</b> Using the t-Statistic in Regression when the Sample Size Is Small</a></li>
<li class="chapter" data-level="5.7" data-path="htaciitslrm.html"><a href="htaciitslrm.html#exercises-5"><i class="fa fa-check"></i><b>5.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="rmwmr.html"><a href="rmwmr.html"><i class="fa fa-check"></i><b>6</b> Regression Models with Multiple Regressors</a>
<ul>
<li class="chapter" data-level="6.1" data-path="rmwmr.html"><a href="rmwmr.html#omitted-variable-bias"><i class="fa fa-check"></i><b>6.1</b> Omitted Variable Bias</a></li>
<li class="chapter" data-level="6.2" data-path="rmwmr.html"><a href="rmwmr.html#tmrm"><i class="fa fa-check"></i><b>6.2</b> The Multiple Regression Model</a></li>
<li class="chapter" data-level="6.3" data-path="rmwmr.html"><a href="rmwmr.html#mofimr"><i class="fa fa-check"></i><b>6.3</b> Measures of Fit in Multiple Regression</a></li>
<li class="chapter" data-level="6.4" data-path="rmwmr.html"><a href="rmwmr.html#ols-assumptions-in-multiple-regression"><i class="fa fa-check"></i><b>6.4</b> OLS Assumptions in Multiple Regression</a>
<ul>
<li class="chapter" data-level="" data-path="rmwmr.html"><a href="rmwmr.html#multicollinearity"><i class="fa fa-check"></i>Multicollinearity</a></li>
<li class="chapter" data-level="" data-path="rmwmr.html"><a href="rmwmr.html#simulation-study-imperfect-multicollinearity"><i class="fa fa-check"></i>Simulation Study: Imperfect Multicollinearity</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="rmwmr.html"><a href="rmwmr.html#the-distribution-of-the-ols-estimators-in-multiple-regression"><i class="fa fa-check"></i><b>6.5</b> The Distribution of the OLS Estimators in Multiple Regression</a></li>
<li class="chapter" data-level="6.6" data-path="rmwmr.html"><a href="rmwmr.html#exercises-6"><i class="fa fa-check"></i><b>6.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="htaciimr.html"><a href="htaciimr.html"><i class="fa fa-check"></i><b>7</b> Hypothesis Tests and Confidence Intervals in MR Models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="htaciimr.html"><a href="htaciimr.html#hypothesis-tests-and-confidence-intervals-for-a-single-coefficient"><i class="fa fa-check"></i><b>7.1</b> Hypothesis Tests and Confidence Intervals for a Single Coefficient</a></li>
<li class="chapter" data-level="7.2" data-path="htaciimr.html"><a href="htaciimr.html#an-application-to-test-scores-and-the-student-teacher-ratio"><i class="fa fa-check"></i><b>7.2</b> An Application to Test Scores and the Student-Teacher Ratio</a>
<ul>
<li class="chapter" data-level="" data-path="htaciimr.html"><a href="htaciimr.html#another-augmentation-of-the-model"><i class="fa fa-check"></i>Another Augmentation of the Model</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="htaciimr.html"><a href="htaciimr.html#joint-hypothesis-testing-using-the-f-statistic"><i class="fa fa-check"></i><b>7.3</b> Joint Hypothesis Testing using the F-Statistic</a></li>
<li class="chapter" data-level="7.4" data-path="htaciimr.html"><a href="htaciimr.html#confidence-sets-for-multiple-coefficients"><i class="fa fa-check"></i><b>7.4</b> Confidence Sets for Multiple Coefficients</a></li>
<li class="chapter" data-level="7.5" data-path="htaciimr.html"><a href="htaciimr.html#model-specification-for-multiple-regression"><i class="fa fa-check"></i><b>7.5</b> Model Specification for Multiple Regression</a>
<ul>
<li class="chapter" data-level="" data-path="htaciimr.html"><a href="htaciimr.html#model-specification-in-theory-and-in-practice"><i class="fa fa-check"></i>Model Specification in Theory and in Practice</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="htaciimr.html"><a href="htaciimr.html#analysis-of-the-test-score-data-set"><i class="fa fa-check"></i><b>7.6</b> Analysis of the Test Score Data Set</a></li>
<li class="chapter" data-level="7.7" data-path="htaciimr.html"><a href="htaciimr.html#exercises-7"><i class="fa fa-check"></i><b>7.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="nrf.html"><a href="nrf.html"><i class="fa fa-check"></i><b>8</b> Nonlinear Regression Functions</a>
<ul>
<li class="chapter" data-level="8.1" data-path="nrf.html"><a href="nrf.html#a-general-strategy-for-modelling-nonlinear-regression-functions"><i class="fa fa-check"></i><b>8.1</b> A General Strategy for Modelling Nonlinear Regression Functions</a></li>
<li class="chapter" data-level="8.2" data-path="nrf.html"><a href="nrf.html#nfoasiv"><i class="fa fa-check"></i><b>8.2</b> Nonlinear Functions of a Single Independent Variable</a>
<ul>
<li class="chapter" data-level="" data-path="nrf.html"><a href="nrf.html#polynomials"><i class="fa fa-check"></i>Polynomials</a></li>
<li class="chapter" data-level="" data-path="nrf.html"><a href="nrf.html#logarithms"><i class="fa fa-check"></i>Logarithms</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="nrf.html"><a href="nrf.html#interactions-between-independent-variables"><i class="fa fa-check"></i><b>8.3</b> Interactions between Independent Variables</a></li>
<li class="chapter" data-level="8.4" data-path="nrf.html"><a href="nrf.html#nonlinear-effects-on-test-scores-of-the-student-teacher-ratio"><i class="fa fa-check"></i><b>8.4</b> Nonlinear Effects on Test Scores of the Student-Teacher Ratio</a></li>
<li class="chapter" data-level="8.5" data-path="nrf.html"><a href="nrf.html#exercises-8"><i class="fa fa-check"></i><b>8.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="asbomr.html"><a href="asbomr.html"><i class="fa fa-check"></i><b>9</b> Assessing Studies Based on Multiple Regression</a>
<ul>
<li class="chapter" data-level="9.1" data-path="asbomr.html"><a href="asbomr.html#internal-and-external-validity"><i class="fa fa-check"></i><b>9.1</b> Internal and External Validity</a></li>
<li class="chapter" data-level="9.2" data-path="asbomr.html"><a href="asbomr.html#ttivomra"><i class="fa fa-check"></i><b>9.2</b> Threats to Internal Validity of Multiple Regression Analysis</a></li>
<li class="chapter" data-level="9.3" data-path="asbomr.html"><a href="asbomr.html#internal-and-external-validity-when-the-regression-is-used-for-forecasting"><i class="fa fa-check"></i><b>9.3</b> Internal and External Validity when the Regression is used for Forecasting</a></li>
<li class="chapter" data-level="9.4" data-path="asbomr.html"><a href="asbomr.html#etsacs"><i class="fa fa-check"></i><b>9.4</b> Example: Test Scores and Class Size</a></li>
<li class="chapter" data-level="9.5" data-path="asbomr.html"><a href="asbomr.html#exercises-9"><i class="fa fa-check"></i><b>9.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="rwpd.html"><a href="rwpd.html"><i class="fa fa-check"></i><b>10</b> Regression with Panel Data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="rwpd.html"><a href="rwpd.html#panel-data"><i class="fa fa-check"></i><b>10.1</b> Panel Data</a></li>
<li class="chapter" data-level="10.2" data-path="rwpd.html"><a href="rwpd.html#PDWTTP"><i class="fa fa-check"></i><b>10.2</b> Panel Data with Two Time Periods: “Before and After” Comparisons</a></li>
<li class="chapter" data-level="10.3" data-path="rwpd.html"><a href="rwpd.html#fixed-effects-regression"><i class="fa fa-check"></i><b>10.3</b> Fixed Effects Regression</a>
<ul>
<li class="chapter" data-level="" data-path="rwpd.html"><a href="rwpd.html#estimation-and-inference"><i class="fa fa-check"></i>Estimation and Inference</a></li>
<li class="chapter" data-level="" data-path="rwpd.html"><a href="rwpd.html#application-to-traffic-deaths"><i class="fa fa-check"></i>Application to Traffic Deaths</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="rwpd.html"><a href="rwpd.html#regression-with-time-fixed-effects"><i class="fa fa-check"></i><b>10.4</b> Regression with Time Fixed Effects</a></li>
<li class="chapter" data-level="10.5" data-path="rwpd.html"><a href="rwpd.html#tferaaseffer"><i class="fa fa-check"></i><b>10.5</b> The Fixed Effects Regression Assumptions and Standard Errors for Fixed Effects Regression</a></li>
<li class="chapter" data-level="10.6" data-path="rwpd.html"><a href="rwpd.html#drunk-driving-laws-and-traffic-deaths"><i class="fa fa-check"></i><b>10.6</b> Drunk Driving Laws and Traffic Deaths</a></li>
<li class="chapter" data-level="10.7" data-path="rwpd.html"><a href="rwpd.html#exercises-10"><i class="fa fa-check"></i><b>10.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="rwabdv.html"><a href="rwabdv.html"><i class="fa fa-check"></i><b>11</b> Regression with a Binary Dependent Variable</a>
<ul>
<li class="chapter" data-level="11.1" data-path="rwabdv.html"><a href="rwabdv.html#binary-dependent-variables-and-the-linear-probability-model"><i class="fa fa-check"></i><b>11.1</b> Binary Dependent Variables and the Linear Probability Model</a></li>
<li class="chapter" data-level="11.2" data-path="rwabdv.html"><a href="rwabdv.html#palr"><i class="fa fa-check"></i><b>11.2</b> Probit and Logit Regression</a>
<ul>
<li class="chapter" data-level="" data-path="rwabdv.html"><a href="rwabdv.html#probit-regression"><i class="fa fa-check"></i>Probit Regression</a></li>
<li class="chapter" data-level="" data-path="rwabdv.html"><a href="rwabdv.html#logit-regression"><i class="fa fa-check"></i>Logit Regression</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="rwabdv.html"><a href="rwabdv.html#estimation-and-inference-in-the-logit-and-probit-models"><i class="fa fa-check"></i><b>11.3</b> Estimation and Inference in the Logit and Probit Models</a></li>
<li class="chapter" data-level="11.4" data-path="rwabdv.html"><a href="rwabdv.html#application-to-the-boston-hmda-data"><i class="fa fa-check"></i><b>11.4</b> Application to the Boston HMDA Data</a></li>
<li class="chapter" data-level="11.5" data-path="rwabdv.html"><a href="rwabdv.html#exercises-11"><i class="fa fa-check"></i><b>11.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ivr.html"><a href="ivr.html"><i class="fa fa-check"></i><b>12</b> Instrumental Variables Regression</a>
<ul>
<li class="chapter" data-level="12.1" data-path="ivr.html"><a href="ivr.html#TIVEWASRAASI"><i class="fa fa-check"></i><b>12.1</b> The IV Estimator with a Single Regressor and a Single Instrument</a></li>
<li class="chapter" data-level="12.2" data-path="ivr.html"><a href="ivr.html#TGIVRM"><i class="fa fa-check"></i><b>12.2</b> The General IV Regression Model</a></li>
<li class="chapter" data-level="12.3" data-path="ivr.html"><a href="ivr.html#civ"><i class="fa fa-check"></i><b>12.3</b> Checking Instrument Validity</a></li>
<li class="chapter" data-level="12.4" data-path="ivr.html"><a href="ivr.html#attdfc"><i class="fa fa-check"></i><b>12.4</b> Application to the Demand for Cigarettes</a></li>
<li class="chapter" data-level="12.5" data-path="ivr.html"><a href="ivr.html#where-do-valid-instruments-come-from"><i class="fa fa-check"></i><b>12.5</b> Where Do Valid Instruments Come From?</a></li>
<li class="chapter" data-level="12.6" data-path="ivr.html"><a href="ivr.html#exercises-12"><i class="fa fa-check"></i><b>12.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="eaqe.html"><a href="eaqe.html"><i class="fa fa-check"></i><b>13</b> Experiments and Quasi-Experiments</a>
<ul>
<li class="chapter" data-level="13.1" data-path="eaqe.html"><a href="eaqe.html#poceaie"><i class="fa fa-check"></i><b>13.1</b> Potential Outcomes, Causal Effects and Idealized Experiments</a></li>
<li class="chapter" data-level="13.2" data-path="eaqe.html"><a href="eaqe.html#threats-to-validity-of-experiments"><i class="fa fa-check"></i><b>13.2</b> Threats to Validity of Experiments</a></li>
<li class="chapter" data-level="13.3" data-path="eaqe.html"><a href="eaqe.html#experimental-estimates-of-the-effect-of-class-size-reductions"><i class="fa fa-check"></i><b>13.3</b> Experimental Estimates of the Effect of Class Size Reductions</a>
<ul>
<li class="chapter" data-level="" data-path="eaqe.html"><a href="eaqe.html#experimental-design-and-the-data-set"><i class="fa fa-check"></i>Experimental Design and the Data Set</a></li>
<li class="chapter" data-level="" data-path="eaqe.html"><a href="eaqe.html#analysis-of-the-star-data"><i class="fa fa-check"></i>Analysis of the STAR Data</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="eaqe.html"><a href="eaqe.html#qe"><i class="fa fa-check"></i><b>13.4</b> Quasi Experiments</a>
<ul>
<li class="chapter" data-level="" data-path="eaqe.html"><a href="eaqe.html#the-differences-in-differences-estimator"><i class="fa fa-check"></i>The Differences-in-Differences Estimator</a></li>
<li class="chapter" data-level="" data-path="eaqe.html"><a href="eaqe.html#regression-discontinuity-estimators"><i class="fa fa-check"></i>Regression Discontinuity Estimators</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="eaqe.html"><a href="eaqe.html#exercises-13"><i class="fa fa-check"></i><b>13.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="ittsraf.html"><a href="ittsraf.html"><i class="fa fa-check"></i><b>14</b> Introduction to Time Series Regression and Forecasting</a>
<ul>
<li class="chapter" data-level="14.1" data-path="ittsraf.html"><a href="ittsraf.html#using-regression-models-for-forecasting"><i class="fa fa-check"></i><b>14.1</b> Using Regression Models for Forecasting</a></li>
<li class="chapter" data-level="14.2" data-path="ittsraf.html"><a href="ittsraf.html#tsdasc"><i class="fa fa-check"></i><b>14.2</b> Time Series Data and Serial Correlation</a>
<ul>
<li class="chapter" data-level="" data-path="ittsraf.html"><a href="ittsraf.html#notation-lags-differences-logarithms-and-growth-rates"><i class="fa fa-check"></i>Notation, Lags, Differences, Logarithms and Growth Rates</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="ittsraf.html"><a href="ittsraf.html#autoregressions"><i class="fa fa-check"></i><b>14.3</b> Autoregressions</a>
<ul>
<li class="chapter" data-level="" data-path="ittsraf.html"><a href="ittsraf.html#autoregressive-models-of-order-p"><i class="fa fa-check"></i>Autoregressive Models of Order <span class="math inline">\(p\)</span></a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="ittsraf.html"><a href="ittsraf.html#cybtmpi"><i class="fa fa-check"></i><b>14.4</b> Can You Beat the Market? (Part I)</a></li>
<li class="chapter" data-level="14.5" data-path="ittsraf.html"><a href="ittsraf.html#apatadlm"><i class="fa fa-check"></i><b>14.5</b> Additional Predictors and The ADL Model</a>
<ul>
<li class="chapter" data-level="" data-path="ittsraf.html"><a href="ittsraf.html#forecast-uncertainty-and-forecast-intervals"><i class="fa fa-check"></i>Forecast Uncertainty and Forecast Intervals</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="ittsraf.html"><a href="ittsraf.html#llsuic"><i class="fa fa-check"></i><b>14.6</b> Lag Length Selection using Information Criteria</a></li>
<li class="chapter" data-level="14.7" data-path="ittsraf.html"><a href="ittsraf.html#nit"><i class="fa fa-check"></i><b>14.7</b> Nonstationarity I: Trends</a></li>
<li class="chapter" data-level="14.8" data-path="ittsraf.html"><a href="ittsraf.html#niib"><i class="fa fa-check"></i><b>14.8</b> Nonstationarity II: Breaks</a></li>
<li class="chapter" data-level="14.9" data-path="ittsraf.html"><a href="ittsraf.html#can-you-beat-the-market-part-ii"><i class="fa fa-check"></i><b>14.9</b> Can You Beat the Market? (Part II)</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="eodce.html"><a href="eodce.html"><i class="fa fa-check"></i><b>15</b> Estimation of Dynamic Causal Effects</a>
<ul>
<li class="chapter" data-level="15.1" data-path="eodce.html"><a href="eodce.html#the-orange-juice-data"><i class="fa fa-check"></i><b>15.1</b> The Orange Juice Data</a></li>
<li class="chapter" data-level="15.2" data-path="eodce.html"><a href="eodce.html#dynamic-causal-effects"><i class="fa fa-check"></i><b>15.2</b> Dynamic Causal Effects</a></li>
<li class="chapter" data-level="15.3" data-path="eodce.html"><a href="eodce.html#dynamic-multipliers-and-cumulative-dynamic-multipliers"><i class="fa fa-check"></i><b>15.3</b> Dynamic Multipliers and Cumulative Dynamic Multipliers</a></li>
<li class="chapter" data-level="15.4" data-path="eodce.html"><a href="eodce.html#hac-standard-errors"><i class="fa fa-check"></i><b>15.4</b> HAC Standard Errors</a></li>
<li class="chapter" data-level="15.5" data-path="eodce.html"><a href="eodce.html#estimation-of-dynamic-causal-effects-with-strictly-exogeneous-regressors"><i class="fa fa-check"></i><b>15.5</b> Estimation of Dynamic Causal Effects with Strictly Exogeneous Regressors</a></li>
<li class="chapter" data-level="15.6" data-path="eodce.html"><a href="eodce.html#orange-juice-prices-and-cold-weather"><i class="fa fa-check"></i><b>15.6</b> Orange Juice Prices and Cold Weather</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="atitsr.html"><a href="atitsr.html"><i class="fa fa-check"></i><b>16</b> Additional Topics in Time Series Regression</a>
<ul>
<li class="chapter" data-level="16.1" data-path="atitsr.html"><a href="atitsr.html#vector-autoregressions"><i class="fa fa-check"></i><b>16.1</b> Vector Autoregressions</a></li>
<li class="chapter" data-level="16.2" data-path="atitsr.html"><a href="atitsr.html#ooiatdfglsurt"><i class="fa fa-check"></i><b>16.2</b> Orders of Integration and the DF-GLS Unit Root Test</a></li>
<li class="chapter" data-level="16.3" data-path="atitsr.html"><a href="atitsr.html#cointegration"><i class="fa fa-check"></i><b>16.3</b> Cointegration</a></li>
<li class="chapter" data-level="16.4" data-path="atitsr.html"><a href="atitsr.html#volatility-clustering-and-autoregressive-conditional-heteroskedasticity"><i class="fa fa-check"></i><b>16.4</b> Volatility Clustering and Autoregressive Conditional Heteroskedasticity</a>
<ul>
<li class="chapter" data-level="" data-path="atitsr.html"><a href="atitsr.html#arch-and-garch-models"><i class="fa fa-check"></i>ARCH and GARCH Models</a></li>
<li class="chapter" data-level="" data-path="atitsr.html"><a href="atitsr.html#application-to-stock-price-volatility"><i class="fa fa-check"></i>Application to Stock Price Volatility</a></li>
<li class="chapter" data-level="" data-path="atitsr.html"><a href="atitsr.html#summary-8"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Econometrics with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="rwpd" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">10</span> Regression with Panel Data<a href="rwpd.html#rwpd" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Regression using panel data may mitigate omitted variable bias when there is no information on variables that correlate with both the regressors of interest and the dependent variable and if these variables are constant in the time dimension or across entities.
When panel data is available, panel regression methods can be used to improve upon multiple regression models. This is because multiple regression models may produce results that lack internal validity in such a setting, as discussed in Chapter <a href="asbomr.html#asbomr">9</a>.</p>
<p>This chapter covers the following topics:</p>
<ul>
<li>notation for panel data,</li>
<li>fixed effects regression using time and/or entity fixed effects,</li>
<li>computation of standard errors in fixed effects regression models.</li>
</ul>
<p>Following the book, for applications we make use of the dataset <tt>Fatalities</tt> from the <tt>AER</tt> package <span class="citation">(<a href="#ref-R-AER">Christian Kleiber and Zeileis 2008</a>)</span> which is a panel dataset reporting annual state level observations on U.S. traffic fatalities for the period 1982 through 1988. The applications analyze if there are effects of alcohol taxes and drunk driving laws on road fatalities and, if present, <em>how strong</em> these effects are.</p>
<p>We introduce <tt>plm()</tt>, a convenient <tt>R</tt> function that enables us to estimate linear panel regression models which comes with the package <tt>plm</tt> <span class="citation">(<a href="#ref-R-plm">Croissant, Millo, and Tappe 2023</a>)</span>. Usage of <tt>plm()</tt> is very similar as for the function <tt>lm()</tt> which we have used throughout the previous chapters for estimation of simple and multiple regression models.</p>
<p>The following packages and their dependencies are needed for reproduction of the code chunks presented throughout this chapter on your computer:</p>
<ul>
<li><tt>AER</tt></li>
<li><tt>plm</tt></li>
<li><tt>stargazer</tt></li>
</ul>
<p>Check whether the following code chunk runs without any errors.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="rwpd.html#cb235-1" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb235-2"><a href="rwpd.html#cb235-2" tabindex="-1"></a><span class="fu">library</span>(plm)</span>
<span id="cb235-3"><a href="rwpd.html#cb235-3" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span></code></pre></div>
<div id="panel-data" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Panel Data<a href="rwpd.html#panel-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="KC10.1" class="keyconcept">
<h3 class="right">
Key Concept 10.1
</h3>
<h3 class="left">
Notation for Panel Data
</h3>
<p>In contrast to cross-section data where we have observations on <span class="math inline">\(n\)</span> subjects (entities), panel data has observations on <span class="math inline">\(n\)</span> entities at <span class="math inline">\(T\geq2\)</span> time periods. This is denoted as</p>
<p><span class="math display">\[(X_{it},Y_{it}), \ i=1,\dots,n \ \ \ \text{and} \ \ \ t=1,\dots,T \]</span>
where the index <span class="math inline">\(i\)</span> refers to the entity while <span class="math inline">\(t\)</span> refers to the time period.</p>
</div>
<p>Sometimes panel data is also called longitudinal data as it adds a temporal dimension to cross-sectional data. Let us have a look at the dataset <tt>Fatalities</tt> by checking its structure and listing the first few observations.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="rwpd.html#cb236-1" tabindex="-1"></a><span class="co"># load the packagees and the dataset</span></span>
<span id="cb236-2"><a href="rwpd.html#cb236-2" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb236-3"><a href="rwpd.html#cb236-3" tabindex="-1"></a><span class="fu">library</span>(plm)</span>
<span id="cb236-4"><a href="rwpd.html#cb236-4" tabindex="-1"></a><span class="fu">data</span>(Fatalities)</span>
<span id="cb236-5"><a href="rwpd.html#cb236-5" tabindex="-1"></a><span class="co"># pdata.frame() declares the data as panel data.</span></span>
<span id="cb236-6"><a href="rwpd.html#cb236-6" tabindex="-1"></a>Fatalities<span class="ot">&lt;-</span> <span class="fu">pdata.frame</span>(Fatalities, <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;state&quot;</span>, <span class="st">&quot;year&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="rwpd.html#cb237-1" tabindex="-1"></a><span class="co"># obtain the dimension and inspect the structure</span></span>
<span id="cb237-2"><a href="rwpd.html#cb237-2" tabindex="-1"></a><span class="fu">is.data.frame</span>(Fatalities)</span>
<span id="cb237-3"><a href="rwpd.html#cb237-3" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb237-4"><a href="rwpd.html#cb237-4" tabindex="-1"></a><span class="fu">dim</span>(Fatalities)</span>
<span id="cb237-5"><a href="rwpd.html#cb237-5" tabindex="-1"></a><span class="co">#&gt; [1] 336  34</span></span></code></pre></div>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="rwpd.html#cb238-1" tabindex="-1"></a><span class="fu">str</span>(Fatalities)</span>
<span id="cb238-2"><a href="rwpd.html#cb238-2" tabindex="-1"></a><span class="co">#&gt; Classes &#39;pdata.frame&#39; and &#39;data.frame&#39;:  336 obs. of  34 variables:</span></span>
<span id="cb238-3"><a href="rwpd.html#cb238-3" tabindex="-1"></a><span class="co">#&gt;  $ state       : Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-4"><a href="rwpd.html#cb238-4" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-5"><a href="rwpd.html#cb238-5" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-6"><a href="rwpd.html#cb238-6" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-7"><a href="rwpd.html#cb238-7" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-8"><a href="rwpd.html#cb238-8" tabindex="-1"></a><span class="co">#&gt;  $ year        : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-9"><a href="rwpd.html#cb238-9" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-10"><a href="rwpd.html#cb238-10" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-11"><a href="rwpd.html#cb238-11" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-12"><a href="rwpd.html#cb238-12" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-13"><a href="rwpd.html#cb238-13" tabindex="-1"></a><span class="co">#&gt;  $ spirits     : &#39;pseries&#39; Named num  1.37 1.36 1.32 1.28 1.23 ...</span></span>
<span id="cb238-14"><a href="rwpd.html#cb238-14" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-15"><a href="rwpd.html#cb238-15" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-16"><a href="rwpd.html#cb238-16" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-17"><a href="rwpd.html#cb238-17" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-18"><a href="rwpd.html#cb238-18" tabindex="-1"></a><span class="co">#&gt;  $ unemp       : &#39;pseries&#39; Named num  14.4 13.7 11.1 8.9 9.8 ...</span></span>
<span id="cb238-19"><a href="rwpd.html#cb238-19" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-20"><a href="rwpd.html#cb238-20" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-21"><a href="rwpd.html#cb238-21" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-22"><a href="rwpd.html#cb238-22" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-23"><a href="rwpd.html#cb238-23" tabindex="-1"></a><span class="co">#&gt;  $ income      : &#39;pseries&#39; Named num  10544 10733 11109 11333 11662 ...</span></span>
<span id="cb238-24"><a href="rwpd.html#cb238-24" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-25"><a href="rwpd.html#cb238-25" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-26"><a href="rwpd.html#cb238-26" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-27"><a href="rwpd.html#cb238-27" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-28"><a href="rwpd.html#cb238-28" tabindex="-1"></a><span class="co">#&gt;  $ emppop      : &#39;pseries&#39; Named num  50.7 52.1 54.2 55.3 56.5 ...</span></span>
<span id="cb238-29"><a href="rwpd.html#cb238-29" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-30"><a href="rwpd.html#cb238-30" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-31"><a href="rwpd.html#cb238-31" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-32"><a href="rwpd.html#cb238-32" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-33"><a href="rwpd.html#cb238-33" tabindex="-1"></a><span class="co">#&gt;  $ beertax     : &#39;pseries&#39; Named num  1.54 1.79 1.71 1.65 1.61 ...</span></span>
<span id="cb238-34"><a href="rwpd.html#cb238-34" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-35"><a href="rwpd.html#cb238-35" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-36"><a href="rwpd.html#cb238-36" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-37"><a href="rwpd.html#cb238-37" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-38"><a href="rwpd.html#cb238-38" tabindex="-1"></a><span class="co">#&gt;  $ baptist     : &#39;pseries&#39; Named num  30.4 30.3 30.3 30.3 30.3 ...</span></span>
<span id="cb238-39"><a href="rwpd.html#cb238-39" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-40"><a href="rwpd.html#cb238-40" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-41"><a href="rwpd.html#cb238-41" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-42"><a href="rwpd.html#cb238-42" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-43"><a href="rwpd.html#cb238-43" tabindex="-1"></a><span class="co">#&gt;  $ mormon      : &#39;pseries&#39; Named num  0.328 0.343 0.359 0.376 0.393 ...</span></span>
<span id="cb238-44"><a href="rwpd.html#cb238-44" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-45"><a href="rwpd.html#cb238-45" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-46"><a href="rwpd.html#cb238-46" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-47"><a href="rwpd.html#cb238-47" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-48"><a href="rwpd.html#cb238-48" tabindex="-1"></a><span class="co">#&gt;  $ drinkage    : &#39;pseries&#39; Named num  19 19 19 19.7 21 ...</span></span>
<span id="cb238-49"><a href="rwpd.html#cb238-49" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-50"><a href="rwpd.html#cb238-50" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-51"><a href="rwpd.html#cb238-51" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-52"><a href="rwpd.html#cb238-52" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-53"><a href="rwpd.html#cb238-53" tabindex="-1"></a><span class="co">#&gt;  $ dry         : &#39;pseries&#39; Named num  25 23 24 23.6 23.5 ...</span></span>
<span id="cb238-54"><a href="rwpd.html#cb238-54" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-55"><a href="rwpd.html#cb238-55" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-56"><a href="rwpd.html#cb238-56" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-57"><a href="rwpd.html#cb238-57" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-58"><a href="rwpd.html#cb238-58" tabindex="-1"></a><span class="co">#&gt;  $ youngdrivers: &#39;pseries&#39; Named num  0.212 0.211 0.211 0.211 0.213 ...</span></span>
<span id="cb238-59"><a href="rwpd.html#cb238-59" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-60"><a href="rwpd.html#cb238-60" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-61"><a href="rwpd.html#cb238-61" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-62"><a href="rwpd.html#cb238-62" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-63"><a href="rwpd.html#cb238-63" tabindex="-1"></a><span class="co">#&gt;  $ miles       : &#39;pseries&#39; Named num  7234 7836 8263 8727 8953 ...</span></span>
<span id="cb238-64"><a href="rwpd.html#cb238-64" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-65"><a href="rwpd.html#cb238-65" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-66"><a href="rwpd.html#cb238-66" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-67"><a href="rwpd.html#cb238-67" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-68"><a href="rwpd.html#cb238-68" tabindex="-1"></a><span class="co">#&gt;  $ breath      : Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb238-69"><a href="rwpd.html#cb238-69" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-70"><a href="rwpd.html#cb238-70" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-71"><a href="rwpd.html#cb238-71" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-72"><a href="rwpd.html#cb238-72" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-73"><a href="rwpd.html#cb238-73" tabindex="-1"></a><span class="co">#&gt;  $ jail        : Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-74"><a href="rwpd.html#cb238-74" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-75"><a href="rwpd.html#cb238-75" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-76"><a href="rwpd.html#cb238-76" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-77"><a href="rwpd.html#cb238-77" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-78"><a href="rwpd.html#cb238-78" tabindex="-1"></a><span class="co">#&gt;  $ service     : Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-79"><a href="rwpd.html#cb238-79" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-80"><a href="rwpd.html#cb238-80" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-81"><a href="rwpd.html#cb238-81" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-82"><a href="rwpd.html#cb238-82" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-83"><a href="rwpd.html#cb238-83" tabindex="-1"></a><span class="co">#&gt;  $ fatal       : &#39;pseries&#39; Named int  839 930 932 882 1081 1110 1023 724 675 869 ...</span></span>
<span id="cb238-84"><a href="rwpd.html#cb238-84" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-85"><a href="rwpd.html#cb238-85" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-86"><a href="rwpd.html#cb238-86" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-87"><a href="rwpd.html#cb238-87" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-88"><a href="rwpd.html#cb238-88" tabindex="-1"></a><span class="co">#&gt;  $ nfatal      : &#39;pseries&#39; Named int  146 154 165 146 172 181 139 131 112 149 ...</span></span>
<span id="cb238-89"><a href="rwpd.html#cb238-89" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-90"><a href="rwpd.html#cb238-90" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-91"><a href="rwpd.html#cb238-91" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-92"><a href="rwpd.html#cb238-92" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-93"><a href="rwpd.html#cb238-93" tabindex="-1"></a><span class="co">#&gt;  $ sfatal      : &#39;pseries&#39; Named int  99 98 94 98 119 114 89 76 60 81 ...</span></span>
<span id="cb238-94"><a href="rwpd.html#cb238-94" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-95"><a href="rwpd.html#cb238-95" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-96"><a href="rwpd.html#cb238-96" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-97"><a href="rwpd.html#cb238-97" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-98"><a href="rwpd.html#cb238-98" tabindex="-1"></a><span class="co">#&gt;  $ fatal1517   : &#39;pseries&#39; Named int  53 71 49 66 82 94 66 40 40 51 ...</span></span>
<span id="cb238-99"><a href="rwpd.html#cb238-99" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-100"><a href="rwpd.html#cb238-100" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-101"><a href="rwpd.html#cb238-101" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-102"><a href="rwpd.html#cb238-102" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-103"><a href="rwpd.html#cb238-103" tabindex="-1"></a><span class="co">#&gt;  $ nfatal1517  : &#39;pseries&#39; Named int  9 8 7 9 10 11 8 7 7 8 ...</span></span>
<span id="cb238-104"><a href="rwpd.html#cb238-104" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-105"><a href="rwpd.html#cb238-105" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-106"><a href="rwpd.html#cb238-106" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-107"><a href="rwpd.html#cb238-107" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-108"><a href="rwpd.html#cb238-108" tabindex="-1"></a><span class="co">#&gt;  $ fatal1820   : &#39;pseries&#39; Named int  99 108 103 100 120 127 105 81 83 118 ...</span></span>
<span id="cb238-109"><a href="rwpd.html#cb238-109" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-110"><a href="rwpd.html#cb238-110" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-111"><a href="rwpd.html#cb238-111" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-112"><a href="rwpd.html#cb238-112" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-113"><a href="rwpd.html#cb238-113" tabindex="-1"></a><span class="co">#&gt;  $ nfatal1820  : &#39;pseries&#39; Named int  34 26 25 23 23 31 24 16 19 34 ...</span></span>
<span id="cb238-114"><a href="rwpd.html#cb238-114" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-115"><a href="rwpd.html#cb238-115" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-116"><a href="rwpd.html#cb238-116" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-117"><a href="rwpd.html#cb238-117" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-118"><a href="rwpd.html#cb238-118" tabindex="-1"></a><span class="co">#&gt;  $ fatal2124   : &#39;pseries&#39; Named int  120 124 118 114 119 138 123 96 80 123 ...</span></span>
<span id="cb238-119"><a href="rwpd.html#cb238-119" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-120"><a href="rwpd.html#cb238-120" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-121"><a href="rwpd.html#cb238-121" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-122"><a href="rwpd.html#cb238-122" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-123"><a href="rwpd.html#cb238-123" tabindex="-1"></a><span class="co">#&gt;  $ nfatal2124  : &#39;pseries&#39; Named int  32 35 34 45 29 30 25 36 17 33 ...</span></span>
<span id="cb238-124"><a href="rwpd.html#cb238-124" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-125"><a href="rwpd.html#cb238-125" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-126"><a href="rwpd.html#cb238-126" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-127"><a href="rwpd.html#cb238-127" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-128"><a href="rwpd.html#cb238-128" tabindex="-1"></a><span class="co">#&gt;  $ afatal      : &#39;pseries&#39; Named num  309 342 305 277 361 ...</span></span>
<span id="cb238-129"><a href="rwpd.html#cb238-129" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-130"><a href="rwpd.html#cb238-130" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-131"><a href="rwpd.html#cb238-131" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-132"><a href="rwpd.html#cb238-132" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-133"><a href="rwpd.html#cb238-133" tabindex="-1"></a><span class="co">#&gt;  $ pop         : &#39;pseries&#39; Named num  3942002 3960008 3988992 4021008 4049994 ...</span></span>
<span id="cb238-134"><a href="rwpd.html#cb238-134" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-135"><a href="rwpd.html#cb238-135" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-136"><a href="rwpd.html#cb238-136" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-137"><a href="rwpd.html#cb238-137" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-138"><a href="rwpd.html#cb238-138" tabindex="-1"></a><span class="co">#&gt;  $ pop1517     : &#39;pseries&#39; Named num  209000 202000 197000 195000 204000 ...</span></span>
<span id="cb238-139"><a href="rwpd.html#cb238-139" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-140"><a href="rwpd.html#cb238-140" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-141"><a href="rwpd.html#cb238-141" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-142"><a href="rwpd.html#cb238-142" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-143"><a href="rwpd.html#cb238-143" tabindex="-1"></a><span class="co">#&gt;  $ pop1820     : &#39;pseries&#39; Named num  221553 219125 216724 214349 212000 ...</span></span>
<span id="cb238-144"><a href="rwpd.html#cb238-144" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-145"><a href="rwpd.html#cb238-145" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-146"><a href="rwpd.html#cb238-146" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-147"><a href="rwpd.html#cb238-147" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-148"><a href="rwpd.html#cb238-148" tabindex="-1"></a><span class="co">#&gt;  $ pop2124     : &#39;pseries&#39; Named num  290000 290000 288000 284000 263000 ...</span></span>
<span id="cb238-149"><a href="rwpd.html#cb238-149" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-150"><a href="rwpd.html#cb238-150" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-151"><a href="rwpd.html#cb238-151" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-152"><a href="rwpd.html#cb238-152" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-153"><a href="rwpd.html#cb238-153" tabindex="-1"></a><span class="co">#&gt;  $ milestot    : &#39;pseries&#39; Named num  28516 31032 32961 35091 36259 ...</span></span>
<span id="cb238-154"><a href="rwpd.html#cb238-154" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-155"><a href="rwpd.html#cb238-155" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-156"><a href="rwpd.html#cb238-156" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-157"><a href="rwpd.html#cb238-157" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-158"><a href="rwpd.html#cb238-158" tabindex="-1"></a><span class="co">#&gt;  $ unempus     : &#39;pseries&#39; Named num  9.7 9.6 7.5 7.2 7 ...</span></span>
<span id="cb238-159"><a href="rwpd.html#cb238-159" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-160"><a href="rwpd.html#cb238-160" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-161"><a href="rwpd.html#cb238-161" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-162"><a href="rwpd.html#cb238-162" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-163"><a href="rwpd.html#cb238-163" tabindex="-1"></a><span class="co">#&gt;  $ emppopus    : &#39;pseries&#39; Named num  57.8 57.9 59.5 60.1 60.7 ...</span></span>
<span id="cb238-164"><a href="rwpd.html#cb238-164" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-165"><a href="rwpd.html#cb238-165" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-166"><a href="rwpd.html#cb238-166" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-167"><a href="rwpd.html#cb238-167" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-168"><a href="rwpd.html#cb238-168" tabindex="-1"></a><span class="co">#&gt;  $ gsp         : &#39;pseries&#39; Named num  -0.0221 0.0466 0.0628 0.0275 0.0321 ...</span></span>
<span id="cb238-169"><a href="rwpd.html#cb238-169" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:336] &quot;al-1982&quot; &quot;al-1983&quot; &quot;al-1984&quot; &quot;al-1985&quot; ...</span></span>
<span id="cb238-170"><a href="rwpd.html#cb238-170" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:    336 obs. of  2 variables:</span></span>
<span id="cb238-171"><a href="rwpd.html#cb238-171" tabindex="-1"></a><span class="co">#&gt;   .. ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-172"><a href="rwpd.html#cb238-172" tabindex="-1"></a><span class="co">#&gt;   .. ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span>
<span id="cb238-173"><a href="rwpd.html#cb238-173" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;index&quot;)=Classes &#39;pindex&#39; and &#39;data.frame&#39;:   336 obs. of  2 variables:</span></span>
<span id="cb238-174"><a href="rwpd.html#cb238-174" tabindex="-1"></a><span class="co">#&gt;   ..$ state: Factor w/ 48 levels &quot;al&quot;,&quot;az&quot;,&quot;ar&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...</span></span>
<span id="cb238-175"><a href="rwpd.html#cb238-175" tabindex="-1"></a><span class="co">#&gt;   ..$ year : Factor w/ 7 levels &quot;1982&quot;,&quot;1983&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...</span></span></code></pre></div>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="rwpd.html#cb239-1" tabindex="-1"></a><span class="co"># list the first few observations</span></span>
<span id="cb239-2"><a href="rwpd.html#cb239-2" tabindex="-1"></a><span class="fu">head</span>(Fatalities)</span>
<span id="cb239-3"><a href="rwpd.html#cb239-3" tabindex="-1"></a><span class="co">#&gt;         state year spirits unemp   income   emppop  beertax baptist  mormon</span></span>
<span id="cb239-4"><a href="rwpd.html#cb239-4" tabindex="-1"></a><span class="co">#&gt; al-1982    al 1982    1.37  14.4 10544.15 50.69204 1.539379 30.3557 0.32829</span></span>
<span id="cb239-5"><a href="rwpd.html#cb239-5" tabindex="-1"></a><span class="co">#&gt; al-1983    al 1983    1.36  13.7 10732.80 52.14703 1.788991 30.3336 0.34341</span></span>
<span id="cb239-6"><a href="rwpd.html#cb239-6" tabindex="-1"></a><span class="co">#&gt; al-1984    al 1984    1.32  11.1 11108.79 54.16809 1.714286 30.3115 0.35924</span></span>
<span id="cb239-7"><a href="rwpd.html#cb239-7" tabindex="-1"></a><span class="co">#&gt; al-1985    al 1985    1.28   8.9 11332.63 55.27114 1.652542 30.2895 0.37579</span></span>
<span id="cb239-8"><a href="rwpd.html#cb239-8" tabindex="-1"></a><span class="co">#&gt; al-1986    al 1986    1.23   9.8 11661.51 56.51450 1.609907 30.2674 0.39311</span></span>
<span id="cb239-9"><a href="rwpd.html#cb239-9" tabindex="-1"></a><span class="co">#&gt; al-1987    al 1987    1.18   7.8 11944.00 57.50988 1.560000 30.2453 0.41123</span></span>
<span id="cb239-10"><a href="rwpd.html#cb239-10" tabindex="-1"></a><span class="co">#&gt;         drinkage     dry youngdrivers    miles breath jail service fatal nfatal</span></span>
<span id="cb239-11"><a href="rwpd.html#cb239-11" tabindex="-1"></a><span class="co">#&gt; al-1982    19.00 25.0063     0.211572 7233.887     no   no      no   839    146</span></span>
<span id="cb239-12"><a href="rwpd.html#cb239-12" tabindex="-1"></a><span class="co">#&gt; al-1983    19.00 22.9942     0.210768 7836.348     no   no      no   930    154</span></span>
<span id="cb239-13"><a href="rwpd.html#cb239-13" tabindex="-1"></a><span class="co">#&gt; al-1984    19.00 24.0426     0.211484 8262.990     no   no      no   932    165</span></span>
<span id="cb239-14"><a href="rwpd.html#cb239-14" tabindex="-1"></a><span class="co">#&gt; al-1985    19.67 23.6339     0.211140 8726.917     no   no      no   882    146</span></span>
<span id="cb239-15"><a href="rwpd.html#cb239-15" tabindex="-1"></a><span class="co">#&gt; al-1986    21.00 23.4647     0.213400 8952.854     no   no      no  1081    172</span></span>
<span id="cb239-16"><a href="rwpd.html#cb239-16" tabindex="-1"></a><span class="co">#&gt; al-1987    21.00 23.7924     0.215527 9166.302     no   no      no  1110    181</span></span>
<span id="cb239-17"><a href="rwpd.html#cb239-17" tabindex="-1"></a><span class="co">#&gt;         sfatal fatal1517 nfatal1517 fatal1820 nfatal1820 fatal2124 nfatal2124</span></span>
<span id="cb239-18"><a href="rwpd.html#cb239-18" tabindex="-1"></a><span class="co">#&gt; al-1982     99        53          9        99         34       120         32</span></span>
<span id="cb239-19"><a href="rwpd.html#cb239-19" tabindex="-1"></a><span class="co">#&gt; al-1983     98        71          8       108         26       124         35</span></span>
<span id="cb239-20"><a href="rwpd.html#cb239-20" tabindex="-1"></a><span class="co">#&gt; al-1984     94        49          7       103         25       118         34</span></span>
<span id="cb239-21"><a href="rwpd.html#cb239-21" tabindex="-1"></a><span class="co">#&gt; al-1985     98        66          9       100         23       114         45</span></span>
<span id="cb239-22"><a href="rwpd.html#cb239-22" tabindex="-1"></a><span class="co">#&gt; al-1986    119        82         10       120         23       119         29</span></span>
<span id="cb239-23"><a href="rwpd.html#cb239-23" tabindex="-1"></a><span class="co">#&gt; al-1987    114        94         11       127         31       138         30</span></span>
<span id="cb239-24"><a href="rwpd.html#cb239-24" tabindex="-1"></a><span class="co">#&gt;          afatal     pop  pop1517  pop1820  pop2124 milestot unempus emppopus</span></span>
<span id="cb239-25"><a href="rwpd.html#cb239-25" tabindex="-1"></a><span class="co">#&gt; al-1982 309.438 3942002 208999.6 221553.4 290000.1    28516     9.7     57.8</span></span>
<span id="cb239-26"><a href="rwpd.html#cb239-26" tabindex="-1"></a><span class="co">#&gt; al-1983 341.834 3960008 202000.1 219125.5 290000.2    31032     9.6     57.9</span></span>
<span id="cb239-27"><a href="rwpd.html#cb239-27" tabindex="-1"></a><span class="co">#&gt; al-1984 304.872 3988992 197000.0 216724.1 288000.2    32961     7.5     59.5</span></span>
<span id="cb239-28"><a href="rwpd.html#cb239-28" tabindex="-1"></a><span class="co">#&gt; al-1985 276.742 4021008 194999.7 214349.0 284000.3    35091     7.2     60.1</span></span>
<span id="cb239-29"><a href="rwpd.html#cb239-29" tabindex="-1"></a><span class="co">#&gt; al-1986 360.716 4049994 203999.9 212000.0 263000.3    36259     7.0     60.7</span></span>
<span id="cb239-30"><a href="rwpd.html#cb239-30" tabindex="-1"></a><span class="co">#&gt; al-1987 368.421 4082999 204999.8 208998.5 258999.8    37426     6.2     61.5</span></span>
<span id="cb239-31"><a href="rwpd.html#cb239-31" tabindex="-1"></a><span class="co">#&gt;                 gsp</span></span>
<span id="cb239-32"><a href="rwpd.html#cb239-32" tabindex="-1"></a><span class="co">#&gt; al-1982 -0.02212476</span></span>
<span id="cb239-33"><a href="rwpd.html#cb239-33" tabindex="-1"></a><span class="co">#&gt; al-1983  0.04655825</span></span>
<span id="cb239-34"><a href="rwpd.html#cb239-34" tabindex="-1"></a><span class="co">#&gt; al-1984  0.06279784</span></span>
<span id="cb239-35"><a href="rwpd.html#cb239-35" tabindex="-1"></a><span class="co">#&gt; al-1985  0.02748997</span></span>
<span id="cb239-36"><a href="rwpd.html#cb239-36" tabindex="-1"></a><span class="co">#&gt; al-1986  0.03214295</span></span>
<span id="cb239-37"><a href="rwpd.html#cb239-37" tabindex="-1"></a><span class="co">#&gt; al-1987  0.04897637</span></span></code></pre></div>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="rwpd.html#cb240-1" tabindex="-1"></a><span class="co"># summarize the variables &#39;state&#39; and &#39;year&#39;</span></span>
<span id="cb240-2"><a href="rwpd.html#cb240-2" tabindex="-1"></a><span class="fu">summary</span>(Fatalities[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)])</span>
<span id="cb240-3"><a href="rwpd.html#cb240-3" tabindex="-1"></a><span class="co">#&gt;      state       year   </span></span>
<span id="cb240-4"><a href="rwpd.html#cb240-4" tabindex="-1"></a><span class="co">#&gt;  al     :  7   1982:48  </span></span>
<span id="cb240-5"><a href="rwpd.html#cb240-5" tabindex="-1"></a><span class="co">#&gt;  az     :  7   1983:48  </span></span>
<span id="cb240-6"><a href="rwpd.html#cb240-6" tabindex="-1"></a><span class="co">#&gt;  ar     :  7   1984:48  </span></span>
<span id="cb240-7"><a href="rwpd.html#cb240-7" tabindex="-1"></a><span class="co">#&gt;  ca     :  7   1985:48  </span></span>
<span id="cb240-8"><a href="rwpd.html#cb240-8" tabindex="-1"></a><span class="co">#&gt;  co     :  7   1986:48  </span></span>
<span id="cb240-9"><a href="rwpd.html#cb240-9" tabindex="-1"></a><span class="co">#&gt;  ct     :  7   1987:48  </span></span>
<span id="cb240-10"><a href="rwpd.html#cb240-10" tabindex="-1"></a><span class="co">#&gt;  (Other):294   1988:48</span></span></code></pre></div>
<p>We find that the dataset consists of 336 observations on 34 variables. Notice that the variable <tt>state</tt> is a factor variable with 48 levels (one for each of the 48 contiguous federal states of the U.S.).
The variable <tt>year</tt> is also a factor variable that has 7 levels identifying the time period when the observation was made. This gives us <span class="math inline">\(7\times48 = 336\)</span> observations in total. Since all variables are observed for all entities and over all time periods, the panel is <em>balanced</em>. If there were missing data for at least one entity in at least one time period we would call the panel <em>unbalanced</em>.</p>
<div id="example-traffic-deaths-and-alcohol-taxes" class="section level4 unnumbered hasAnchor">
<h4>Example: Traffic Deaths and Alcohol Taxes<a href="rwpd.html#example-traffic-deaths-and-alcohol-taxes" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We start by reproducing Figure 10.1 of the book. To this end we estimate simple regressions using data for years 1982 and 1988 that model the relationship between beer tax (adjusted for 1988 dollars) and the traffic fatality rate, measured as the number of fatalities per 10000 inhabitants. Afterwards, we plot the data and add the corresponding estimated regression functions.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="rwpd.html#cb241-1" tabindex="-1"></a><span class="co"># define the fatality rate</span></span>
<span id="cb241-2"><a href="rwpd.html#cb241-2" tabindex="-1"></a>Fatalities<span class="sc">$</span>fatal_rate <span class="ot">&lt;-</span> Fatalities<span class="sc">$</span>fatal <span class="sc">/</span> Fatalities<span class="sc">$</span>pop <span class="sc">*</span> <span class="dv">10000</span></span>
<span id="cb241-3"><a href="rwpd.html#cb241-3" tabindex="-1"></a></span>
<span id="cb241-4"><a href="rwpd.html#cb241-4" tabindex="-1"></a><span class="co"># subset the data</span></span>
<span id="cb241-5"><a href="rwpd.html#cb241-5" tabindex="-1"></a>Fatalities1982 <span class="ot">&lt;-</span> <span class="fu">subset</span>(Fatalities, year <span class="sc">==</span> <span class="st">&quot;1982&quot;</span>)</span>
<span id="cb241-6"><a href="rwpd.html#cb241-6" tabindex="-1"></a>Fatalities1988 <span class="ot">&lt;-</span> <span class="fu">subset</span>(Fatalities, year <span class="sc">==</span> <span class="st">&quot;1988&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="rwpd.html#cb242-1" tabindex="-1"></a><span class="co"># estimate simple regression models using 1982 and 1988 data</span></span>
<span id="cb242-2"><a href="rwpd.html#cb242-2" tabindex="-1"></a>fatal1982_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(fatal_rate <span class="sc">~</span> beertax, <span class="at">data =</span> Fatalities1982)</span>
<span id="cb242-3"><a href="rwpd.html#cb242-3" tabindex="-1"></a>fatal1988_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(fatal_rate <span class="sc">~</span> beertax, <span class="at">data =</span> Fatalities1988)</span>
<span id="cb242-4"><a href="rwpd.html#cb242-4" tabindex="-1"></a></span>
<span id="cb242-5"><a href="rwpd.html#cb242-5" tabindex="-1"></a><span class="fu">coeftest</span>(fatal1982_mod, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb242-6"><a href="rwpd.html#cb242-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb242-7"><a href="rwpd.html#cb242-7" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb242-8"><a href="rwpd.html#cb242-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb242-9"><a href="rwpd.html#cb242-9" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb242-10"><a href="rwpd.html#cb242-10" tabindex="-1"></a><span class="co">#&gt; (Intercept)  2.01038    0.14957 13.4408   &lt;2e-16 ***</span></span>
<span id="cb242-11"><a href="rwpd.html#cb242-11" tabindex="-1"></a><span class="co">#&gt; beertax      0.14846    0.13261  1.1196   0.2687    </span></span>
<span id="cb242-12"><a href="rwpd.html#cb242-12" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb242-13"><a href="rwpd.html#cb242-13" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb242-14"><a href="rwpd.html#cb242-14" tabindex="-1"></a><span class="fu">coeftest</span>(fatal1988_mod, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb242-15"><a href="rwpd.html#cb242-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb242-16"><a href="rwpd.html#cb242-16" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb242-17"><a href="rwpd.html#cb242-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb242-18"><a href="rwpd.html#cb242-18" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb242-19"><a href="rwpd.html#cb242-19" tabindex="-1"></a><span class="co">#&gt; (Intercept)  1.85907    0.11461 16.2205 &lt; 2.2e-16 ***</span></span>
<span id="cb242-20"><a href="rwpd.html#cb242-20" tabindex="-1"></a><span class="co">#&gt; beertax      0.43875    0.12786  3.4314  0.001279 ** </span></span>
<span id="cb242-21"><a href="rwpd.html#cb242-21" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb242-22"><a href="rwpd.html#cb242-22" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The estimated regression functions are
<span class="math display">\[\begin{align*}
  \widehat{FatalityRate} =&amp; \, \underset{(0.15)}{2.01} + \underset{(0.13)}{0.15} \times BeerTax \quad (1982 \text{ data}), \\
  \widehat{FatalityRate} =&amp; \, \underset{(0.11)}{1.86} + \underset{(0.13)}{0.44} \times BeerTax \quad (1988 \text{ data}).
\end{align*}\]</span></p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="rwpd.html#cb243-1" tabindex="-1"></a><span class="co"># plot the observations and add the estimated regression line for 1982 data</span></span>
<span id="cb243-2"><a href="rwpd.html#cb243-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> <span class="fu">as.double</span>(Fatalities1982<span class="sc">$</span>beertax), </span>
<span id="cb243-3"><a href="rwpd.html#cb243-3" tabindex="-1"></a>     <span class="at">y =</span> <span class="fu">as.double</span>(Fatalities1982<span class="sc">$</span>fatal_rate), </span>
<span id="cb243-4"><a href="rwpd.html#cb243-4" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Beer tax (in 1988 dollars)&quot;</span>,</span>
<span id="cb243-5"><a href="rwpd.html#cb243-5" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Fatality rate (fatalities per 10000)&quot;</span>,</span>
<span id="cb243-6"><a href="rwpd.html#cb243-6" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Traffic Fatality Rates and Beer Taxes in 1982&quot;</span>,</span>
<span id="cb243-7"><a href="rwpd.html#cb243-7" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">4.5</span>),</span>
<span id="cb243-8"><a href="rwpd.html#cb243-8" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, </span>
<span id="cb243-9"><a href="rwpd.html#cb243-9" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>)</span>
<span id="cb243-10"><a href="rwpd.html#cb243-10" tabindex="-1"></a></span>
<span id="cb243-11"><a href="rwpd.html#cb243-11" tabindex="-1"></a><span class="fu">abline</span>(fatal1982_mod, <span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">col=</span><span class="st">&quot;darkred&quot;</span>)</span>
<span id="cb243-12"><a href="rwpd.html#cb243-12" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="at">lty=</span><span class="dv">1</span>,<span class="at">col=</span><span class="st">&quot;darkred&quot;</span>,<span class="st">&quot;Estimated Regression Line&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-421-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="rwpd.html#cb244-1" tabindex="-1"></a></span>
<span id="cb244-2"><a href="rwpd.html#cb244-2" tabindex="-1"></a><span class="co"># plot observations and add estimated regression line for 1988 data</span></span>
<span id="cb244-3"><a href="rwpd.html#cb244-3" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> <span class="fu">as.double</span>(Fatalities1988<span class="sc">$</span>beertax), </span>
<span id="cb244-4"><a href="rwpd.html#cb244-4" tabindex="-1"></a>     <span class="at">y =</span> <span class="fu">as.double</span>(Fatalities1988<span class="sc">$</span>fatal_rate), </span>
<span id="cb244-5"><a href="rwpd.html#cb244-5" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Beer tax (in 1988 dollars)&quot;</span>,</span>
<span id="cb244-6"><a href="rwpd.html#cb244-6" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Fatality rate (fatalities per 10000)&quot;</span>,</span>
<span id="cb244-7"><a href="rwpd.html#cb244-7" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Traffic Fatality Rates and Beer Taxes in 1988&quot;</span>,</span>
<span id="cb244-8"><a href="rwpd.html#cb244-8" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">4.5</span>),</span>
<span id="cb244-9"><a href="rwpd.html#cb244-9" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, </span>
<span id="cb244-10"><a href="rwpd.html#cb244-10" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>)</span>
<span id="cb244-11"><a href="rwpd.html#cb244-11" tabindex="-1"></a></span>
<span id="cb244-12"><a href="rwpd.html#cb244-12" tabindex="-1"></a><span class="fu">abline</span>(fatal1988_mod, <span class="at">lwd =</span> <span class="fl">1.5</span>,<span class="at">col=</span><span class="st">&quot;darkred&quot;</span>)</span>
<span id="cb244-13"><a href="rwpd.html#cb244-13" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>,<span class="at">lty=</span><span class="dv">1</span>,<span class="at">col=</span><span class="st">&quot;darkred&quot;</span>,<span class="st">&quot;Estimated Regression Line&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-421-2.png" width="80%" style="display: block; margin: auto;" /></p>
<p>In both plots, each point represents observations of beer tax and fatality rate for a given state in the respective year. The regression results indicate a positive relationship between the beer tax and the fatality rate for both years. The estimated coefficient on beer tax for the 1988 data is almost three times as large as for the 1982 dataset. This is contrary to our expectations: alcohol taxes are supposed to <em>lower</em> the rate of traffic fatalities. As we known from Chapter <a href="rmwmr.html#rmwmr">6</a>, this is possibly due to omitted variable bias, since both models do not include any covariates, e.g., economic conditions. This could be corrected by using a multiple regression approach. However, this cannot account for omitted <em>unobservable</em> factors that differ from state to state but can be assumed to be constant over the observation span, e.g., the populations’ attitude towards drunk driving. As shown in the next section, panel data allow us to hold such factors constant.</p>
</div>
</div>
<div id="PDWTTP" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> Panel Data with Two Time Periods: “Before and After” Comparisons<a href="rwpd.html#PDWTTP" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Suppose there are only <span class="math inline">\(T=2\)</span> time periods <span class="math inline">\(t=1982,1988\)</span>. This allows us to analyze differences in changes of the fatality rate from year 1982 to 1988. We start by considering the population regression model <span class="math display">\[FatalityRate_{it} = \beta_0 + \beta_1 BeerTax_{it} + \beta_2 Z_{i} + u_{it}\]</span> where the <span class="math inline">\(Z_i\)</span> are state specific characteristics that differ between states but are <em>constant over time</em>. For <span class="math inline">\(t=1982\)</span> and <span class="math inline">\(t=1988\)</span> we have
<span class="math display">\[\begin{align*}
  FatalityRate_{i1982} =&amp;\, \beta_0 + \beta_1 BeerTax_{i1982} + \beta_2 Z_i + u_{i1982}, \\
  FatalityRate_{i1988} =&amp;\, \beta_0 + \beta_1 BeerTax_{i1988} + \beta_2 Z_i + u_{i1988}.
\end{align*}\]</span></p>
<p>We can eliminate the <span class="math inline">\(Z_i\)</span> by regressing the difference in the fatality rate between 1988 and 1982 on the difference in beer tax between those years:
<span class="math display">\[FatalityRate_{i1988} - FatalityRate_{i1982} = \beta_1 (BeerTax_{i1988} - BeerTax_{i1982}) + u_{i1988} - u_{i1982}.\]</span>
This regression model, where the difference in fatality rate between 1988 and 1982 is regressed on the difference in beer tax between those years, yields an estimate for <span class="math inline">\(\beta_1\)</span> that is robust to a possible bias due to omission of <span class="math inline">\(Z_i\)</span>, as these influences are eliminated from the model. Next we will use <tt>R</tt> to estimate a regression based on the differenced data and to plot the estimated regression function.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="rwpd.html#cb245-1" tabindex="-1"></a><span class="co"># compute the differences </span></span>
<span id="cb245-2"><a href="rwpd.html#cb245-2" tabindex="-1"></a>diff_fatal_rate <span class="ot">&lt;-</span> Fatalities1988<span class="sc">$</span>fatal_rate <span class="sc">-</span> Fatalities1982<span class="sc">$</span>fatal_rate</span>
<span id="cb245-3"><a href="rwpd.html#cb245-3" tabindex="-1"></a>diff_beertax <span class="ot">&lt;-</span> Fatalities1988<span class="sc">$</span>beertax <span class="sc">-</span> Fatalities1982<span class="sc">$</span>beertax</span>
<span id="cb245-4"><a href="rwpd.html#cb245-4" tabindex="-1"></a></span>
<span id="cb245-5"><a href="rwpd.html#cb245-5" tabindex="-1"></a><span class="co"># estimate a regression using differenced data</span></span>
<span id="cb245-6"><a href="rwpd.html#cb245-6" tabindex="-1"></a>fatal_diff_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(diff_fatal_rate <span class="sc">~</span> diff_beertax)</span>
<span id="cb245-7"><a href="rwpd.html#cb245-7" tabindex="-1"></a></span>
<span id="cb245-8"><a href="rwpd.html#cb245-8" tabindex="-1"></a><span class="fu">coeftest</span>(fatal_diff_mod, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb245-9"><a href="rwpd.html#cb245-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb245-10"><a href="rwpd.html#cb245-10" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb245-11"><a href="rwpd.html#cb245-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb245-12"><a href="rwpd.html#cb245-12" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span id="cb245-13"><a href="rwpd.html#cb245-13" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -0.072037   0.065355 -1.1022 0.276091   </span></span>
<span id="cb245-14"><a href="rwpd.html#cb245-14" tabindex="-1"></a><span class="co">#&gt; diff_beertax -1.040973   0.355006 -2.9323 0.005229 **</span></span>
<span id="cb245-15"><a href="rwpd.html#cb245-15" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb245-16"><a href="rwpd.html#cb245-16" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Including the intercept allows for a change in the mean fatality rate in the time between 1982 and 1988 in the absence of a change in the beer tax.</p>
<p>We obtain the OLS estimated regression function <span class="math display">\[\widehat{FatalityRate_{i1988} - FatalityRate_{i1982}} = -\underset{(0.065)}{0.072} -\underset{(0.36)}{1.04} \times (BeerTax_{i1988}-BeerTax_{i1982}).\]</span></p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="rwpd.html#cb246-1" tabindex="-1"></a><span class="co"># plot the differenced data</span></span>
<span id="cb246-2"><a href="rwpd.html#cb246-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> <span class="fu">as.double</span>(diff_beertax), </span>
<span id="cb246-3"><a href="rwpd.html#cb246-3" tabindex="-1"></a>     <span class="at">y =</span> <span class="fu">as.double</span>(diff_fatal_rate), </span>
<span id="cb246-4"><a href="rwpd.html#cb246-4" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Change in beer tax (in 1988 dollars)&quot;</span>,</span>
<span id="cb246-5"><a href="rwpd.html#cb246-5" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Change in fatality rate (fatalities per 10000)&quot;</span>,</span>
<span id="cb246-6"><a href="rwpd.html#cb246-6" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Changes in Traffic Fatality Rates and Beer Taxes in 1982-1988&quot;</span>,</span>
<span id="cb246-7"><a href="rwpd.html#cb246-7" tabindex="-1"></a>     <span class="at">cex.main=</span><span class="dv">1</span>,</span>
<span id="cb246-8"><a href="rwpd.html#cb246-8" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.6</span>, <span class="fl">0.6</span>),</span>
<span id="cb246-9"><a href="rwpd.html#cb246-9" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="dv">1</span>),</span>
<span id="cb246-10"><a href="rwpd.html#cb246-10" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, </span>
<span id="cb246-11"><a href="rwpd.html#cb246-11" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>)</span>
<span id="cb246-12"><a href="rwpd.html#cb246-12" tabindex="-1"></a></span>
<span id="cb246-13"><a href="rwpd.html#cb246-13" tabindex="-1"></a><span class="co"># add the regression line to plot</span></span>
<span id="cb246-14"><a href="rwpd.html#cb246-14" tabindex="-1"></a><span class="fu">abline</span>(fatal_diff_mod, <span class="at">lwd =</span> <span class="fl">1.5</span>,<span class="at">col=</span><span class="st">&quot;darkred&quot;</span>)</span>
<span id="cb246-15"><a href="rwpd.html#cb246-15" tabindex="-1"></a><span class="co">#add legend</span></span>
<span id="cb246-16"><a href="rwpd.html#cb246-16" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="at">lty=</span><span class="dv">1</span>,<span class="at">col=</span><span class="st">&quot;darkred&quot;</span>,<span class="st">&quot;Estimated Regression Line&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-423-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The estimated coefficient on beer tax is now negative and significantly different from zero at <span class="math inline">\(5\%\)</span>. Its interpretation is that raising the beer tax by <span class="math inline">\(\$1\)</span> causes traffic fatalities to decrease by <span class="math inline">\(1.04\)</span> per <span class="math inline">\(10000\)</span> people. This is rather large as the average fatality rate is approximately <span class="math inline">\(2\)</span> persons per <span class="math inline">\(10000\)</span> people.</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="rwpd.html#cb247-1" tabindex="-1"></a><span class="co"># compute mean fatality rate over all states for all time periods</span></span>
<span id="cb247-2"><a href="rwpd.html#cb247-2" tabindex="-1"></a><span class="fu">mean</span>(Fatalities<span class="sc">$</span>fatal_rate)</span>
<span id="cb247-3"><a href="rwpd.html#cb247-3" tabindex="-1"></a><span class="co">#&gt; [1] 2.040444</span></span></code></pre></div>
<p>Once more this outcome is likely to be a consequence of omitting factors in the single-year regression that influence the fatality rate and are correlated with the beer tax <em>and</em> change over time. The message is that we need to be more careful and control for such factors before drawing conclusions about the effect of a raise in beer taxes.</p>
<p>The approach presented in this section discards information for years <span class="math inline">\(1983\)</span> to <span class="math inline">\(1987\)</span>. The fixed effects method that allows us to use data for more than <span class="math inline">\(T = 2\)</span> time periods and enables us to add control variables to the analysis.</p>
</div>
<div id="fixed-effects-regression" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Fixed Effects Regression<a href="rwpd.html#fixed-effects-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Consider the panel regression model</p>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 X_{it} + \beta_2 Z_i +  u_{it}\]</span>
where the <span class="math inline">\(Z_i\)</span> are unobserved time-invariant heterogeneities across the entities <span class="math inline">\(i=1,\dots,n\)</span>. We aim to estimate <span class="math inline">\(\beta_1\)</span>, the effect on <span class="math inline">\(Y_i\)</span> of a change in <span class="math inline">\(X_i\)</span> holding constant <span class="math inline">\(Z_i\)</span>. Letting <span class="math inline">\(\alpha_i = \beta_0 + \beta_2 Z_i\)</span> we obtain the model
<span class="math display" id="eq:femodel">\[\begin{align}
Y_{it} = \alpha_i + \beta_1 X_{it} + u_{it} \tag{10.1}.
\end{align}\]</span>
Having individual specific intercepts <span class="math inline">\(\alpha_i\)</span>, <span class="math inline">\(i=1,\dots,n\)</span>, where each of these can be understood as the fixed effect of entity <span class="math inline">\(i\)</span>, this model is called the <em>fixed effects model</em>.
The variation in the <span class="math inline">\(\alpha_i\)</span>, <span class="math inline">\(i=1,\dots,n\)</span> comes from the <span class="math inline">\(Z_i\)</span>. <a href="rwpd.html#eq:femodel">(10.1)</a> can be rewritten as a regression model containing <span class="math inline">\(n-1\)</span> dummy regressors and a constant:
<span class="math display" id="eq:drmodel">\[\begin{align}
Y_{it} = \beta_0 + \beta_1 X_{it} + \gamma_2 D2_i + \gamma_3 D3_i + \cdots + \gamma_n Dn_i + u_{it} \tag{10.2}.
\end{align}\]</span>
Model <a href="rwpd.html#eq:drmodel">(10.2)</a> has <span class="math inline">\(n\)</span> different intercepts — one for every entity. <a href="rwpd.html#eq:femodel">(10.1)</a> and <a href="rwpd.html#eq:drmodel">(10.2)</a> are equivalent representations of the fixed effects model (Note: <span class="math inline">\(\beta_0\)</span> is intercept of the fixed effect model in equation 10.2).</p>
<p>The fixed effects model can be generalized to contain more than just one determinant of <span class="math inline">\(Y\)</span> that is correlated with <span class="math inline">\(X\)</span> and changes over time. Key Concept 10.2 presents the generalized fixed effects regression model.</p>
<div id="KC10.2" class="keyconcept">
<h3 class="right">
Key Concept 10.2
</h3>
<h3 class="left">
The Fixed Effects Regression Model
</h3>
<p>The fixed effects regression model is</p>
<p><span class="math display" id="eq:gfemodel">\[\begin{align}
Y_{it} = \beta_1 X_{1,it} + \cdots + \beta_k X_{k,it} + \alpha_i + u_{it} \tag{10.3}
\end{align}\]</span></p>
<p>with <span class="math inline">\(i=1,\dots,n\)</span> and <span class="math inline">\(t=1,\dots,T\)</span>. The <span class="math inline">\(\alpha_i\)</span> are entity-specific intercepts that capture heterogeneities across entities. An equivalent representation of this model is given by</p>
<p><span class="math display" id="eq:gdrmodel">\[\begin{align}
Y_{it} = \beta_0 + \beta_1 X_{1,it} + \cdots + \beta_k X_{k,it} + \gamma_2 D2_i + \gamma_3 D3_i + \cdots + \gamma_n Dn_i  + u_{it} \tag{10.4}
\end{align}\]</span></p>
<p>where the <span class="math inline">\(D2_i,D3_i,\dots,Dn_i\)</span> are dummy variables.</p>
</div>
<div id="estimation-and-inference" class="section level3 unnumbered hasAnchor">
<h3>Estimation and Inference<a href="rwpd.html#estimation-and-inference" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Software packages use a so-called “entity-demeaned” OLS algorithm which is computationally more efficient than estimating regression models with <span class="math inline">\(k+n\)</span> regressors as needed for models <a href="rwpd.html#eq:gfemodel">(10.3)</a> and <a href="rwpd.html#eq:gdrmodel">(10.4)</a>.</p>
<p>Taking averages across time on both sides of <a href="rwpd.html#eq:femodel">(10.1)</a> we obtain
<span class="math display">\[\begin{align*}
\frac{1}{T} \sum_{t=1}^T Y_{it} =&amp; \, \beta_1 \frac{1}{T} \sum_{t=1}^T X_{it} + \alpha_i + \frac{1}{T} \sum_{t=1}^T u_{it} \\
\overline{Y}_i =&amp; \, \beta_1 \overline{X}_i + \alpha_i + \overline{u}_i.
\end{align*}\]</span>
Subtraction from <a href="rwpd.html#eq:femodel">(10.1)</a> yields
<span class="math display" id="eq:edols">\[\begin{align}
\begin{split}
Y_{it} - \overline{Y}_i =&amp; \, \beta_1(X_{it}-\overline{X}_i) + (u_{it} - \overline{u}_i) \\
\overset{\sim}{Y}_{it} =&amp; \, \beta_1 \overset{\sim}{X}_{it} + \overset{\sim}{u}_{it}.
\end{split} \tag{10.5}
\end{align}\]</span>
In this model, the OLS estimate of the parameter of interest <span class="math inline">\(\beta_1\)</span> is equal to the estimate obtained using <a href="rwpd.html#eq:drmodel">(10.2)</a> — without the need to estimate <span class="math inline">\(n-1\)</span> dummies and an intercept.</p>
<p>We conclude that there are two ways of estimating <span class="math inline">\(\beta_1\)</span> in the fixed effects regression:</p>
<ol style="list-style-type: decimal">
<li><p>OLS of the dummy regression model as shown in <a href="rwpd.html#eq:drmodel">(10.2)</a>.</p></li>
<li><p>OLS using the entity demeaned data as in <a href="rwpd.html#eq:edols">(10.5)</a>.</p></li>
</ol>
<p>Provided that the fixed effects regression assumptions stated in Key Concept 10.3 hold, the sampling distribution of the OLS estimator in the fixed effects regression model is normal in large samples. The variance of the estimates can be estimated and we can compute standard errors, <span class="math inline">\(t\)</span>-statistics and confidence intervals for coefficients. In the next section, we see how to estimate a fixed effects model using <tt>R</tt> and how to obtain a model summary that reports heteroskedasticity-robust standard errors. We leave aside complicated formulas of the estimators. See Chapter 10.5 and Appendix 10.2 of the book for a discussion of theoretical aspects.</p>
</div>
<div id="application-to-traffic-deaths" class="section level3 unnumbered hasAnchor">
<h3>Application to Traffic Deaths<a href="rwpd.html#application-to-traffic-deaths" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Following Key Concept 10.2, the simple fixed effects model for estimation of the relation between traffic fatality rates and the beer taxes is
<span class="math display" id="eq:fatsemod">\[\begin{align}
FatalityRate_{it} = \beta_1 BeerTax_{it} + StateFixedEffects + u_{it}, \tag{10.6}
\end{align}\]</span>
a regression of the traffic fatality rate on beer tax and 48 binary regressors — one for each federal state.</p>
<p>We can simply use the function <tt>lm()</tt> to obtain an estimate of <span class="math inline">\(\beta_1\)</span>.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="rwpd.html#cb248-1" tabindex="-1"></a>fatal_fe_lm_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(fatal_rate <span class="sc">~</span> beertax <span class="sc">+</span> state <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data =</span> Fatalities)</span>
<span id="cb248-2"><a href="rwpd.html#cb248-2" tabindex="-1"></a>fatal_fe_lm_mod</span>
<span id="cb248-3"><a href="rwpd.html#cb248-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb248-4"><a href="rwpd.html#cb248-4" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb248-5"><a href="rwpd.html#cb248-5" tabindex="-1"></a><span class="co">#&gt; lm(formula = fatal_rate ~ beertax + state - 1, data = Fatalities)</span></span>
<span id="cb248-6"><a href="rwpd.html#cb248-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb248-7"><a href="rwpd.html#cb248-7" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb248-8"><a href="rwpd.html#cb248-8" tabindex="-1"></a><span class="co">#&gt; beertax  stateal  stateaz  statear  stateca  stateco  statect  statede  </span></span>
<span id="cb248-9"><a href="rwpd.html#cb248-9" tabindex="-1"></a><span class="co">#&gt; -0.6559   3.4776   2.9099   2.8227   1.9682   1.9933   1.6154   2.1700  </span></span>
<span id="cb248-10"><a href="rwpd.html#cb248-10" tabindex="-1"></a><span class="co">#&gt; statefl  statega  stateid  stateil  statein  stateia  stateks  stateky  </span></span>
<span id="cb248-11"><a href="rwpd.html#cb248-11" tabindex="-1"></a><span class="co">#&gt;  3.2095   4.0022   2.8086   1.5160   2.0161   1.9337   2.2544   2.2601  </span></span>
<span id="cb248-12"><a href="rwpd.html#cb248-12" tabindex="-1"></a><span class="co">#&gt; statela  stateme  statemd  statema  statemi  statemn  statems  statemo  </span></span>
<span id="cb248-13"><a href="rwpd.html#cb248-13" tabindex="-1"></a><span class="co">#&gt;  2.6305   2.3697   1.7712   1.3679   1.9931   1.5804   3.4486   2.1814  </span></span>
<span id="cb248-14"><a href="rwpd.html#cb248-14" tabindex="-1"></a><span class="co">#&gt; statemt  statene  statenv  statenh  statenj  statenm  stateny  statenc  </span></span>
<span id="cb248-15"><a href="rwpd.html#cb248-15" tabindex="-1"></a><span class="co">#&gt;  3.1172   1.9555   2.8769   2.2232   1.3719   3.9040   1.2910   3.1872  </span></span>
<span id="cb248-16"><a href="rwpd.html#cb248-16" tabindex="-1"></a><span class="co">#&gt; statend  stateoh  stateok  stateor  statepa  stateri  statesc  statesd  </span></span>
<span id="cb248-17"><a href="rwpd.html#cb248-17" tabindex="-1"></a><span class="co">#&gt;  1.8542   1.8032   2.9326   2.3096   1.7102   1.2126   4.0348   2.4739  </span></span>
<span id="cb248-18"><a href="rwpd.html#cb248-18" tabindex="-1"></a><span class="co">#&gt; statetn  statetx  stateut  statevt  stateva  statewa  statewv  statewi  </span></span>
<span id="cb248-19"><a href="rwpd.html#cb248-19" tabindex="-1"></a><span class="co">#&gt;  2.6020   2.5602   2.3137   2.5116   2.1874   1.8181   2.5809   1.7184  </span></span>
<span id="cb248-20"><a href="rwpd.html#cb248-20" tabindex="-1"></a><span class="co">#&gt; statewy  </span></span>
<span id="cb248-21"><a href="rwpd.html#cb248-21" tabindex="-1"></a><span class="co">#&gt;  3.2491</span></span></code></pre></div>
<p>As discussed in the previous section, it is also possible to estimate <span class="math inline">\(\beta_1\)</span> by applying OLS to the demeaned data, that is, to run the regression</p>
<p><span class="math display">\[\overset{\sim}{FatalityRate} = \beta_1 \overset{\sim}{BeerTax}_{it} + u_{it}. \]</span></p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="rwpd.html#cb249-1" tabindex="-1"></a><span class="co"># obtain demeaned data</span></span>
<span id="cb249-2"><a href="rwpd.html#cb249-2" tabindex="-1"></a>fatal_demeaned <span class="ot">&lt;-</span> <span class="fu">with</span>(Fatalities,</span>
<span id="cb249-3"><a href="rwpd.html#cb249-3" tabindex="-1"></a>            <span class="fu">data.frame</span>(<span class="at">fatal_rate =</span> fatal_rate <span class="sc">-</span> <span class="fu">ave</span>(fatal_rate, state),</span>
<span id="cb249-4"><a href="rwpd.html#cb249-4" tabindex="-1"></a>            <span class="at">beertax =</span> beertax <span class="sc">-</span> <span class="fu">ave</span>(beertax, state)))</span>
<span id="cb249-5"><a href="rwpd.html#cb249-5" tabindex="-1"></a></span>
<span id="cb249-6"><a href="rwpd.html#cb249-6" tabindex="-1"></a><span class="co"># estimate the regression</span></span>
<span id="cb249-7"><a href="rwpd.html#cb249-7" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(fatal_rate <span class="sc">~</span> beertax <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data =</span> fatal_demeaned))</span></code></pre></div>
<p>The function <tt>ave</tt> is convenient for computing group averages. We use it to obtain state specific averages of the fatality rate and the beer tax.</p>
<p>Alternatively one may use <tt>plm()</tt> from the package with the same name.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="rwpd.html#cb250-1" tabindex="-1"></a><span class="co"># install and load the &#39;plm&#39; package</span></span>
<span id="cb250-2"><a href="rwpd.html#cb250-2" tabindex="-1"></a><span class="do">## install.packages(&quot;plm&quot;)</span></span>
<span id="cb250-3"><a href="rwpd.html#cb250-3" tabindex="-1"></a><span class="fu">library</span>(plm)</span></code></pre></div>
<p>As for <tt>lm()</tt> we have to specify the regression formula and the data to be used in our call of <tt>plm()</tt>. Additionally, it is required to pass a vector of names of entity and time ID variables to the argument <tt>index</tt>. For <tt>Fatalities</tt>, the ID variable for entities is named <tt>state</tt> and the time id variable is <tt>year</tt>. Since the fixed effects estimator is also called the <em>within estimator</em>, we set <tt>model = “within”</tt>. Finally, the function <tt>coeftest()</tt> allows to obtain inference based on robust standard errors.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="rwpd.html#cb251-1" tabindex="-1"></a><span class="co"># estimate the fixed effects regression with plm()</span></span>
<span id="cb251-2"><a href="rwpd.html#cb251-2" tabindex="-1"></a>fatal_fe_mod <span class="ot">&lt;-</span> <span class="fu">plm</span>(fatal_rate <span class="sc">~</span> beertax, </span>
<span id="cb251-3"><a href="rwpd.html#cb251-3" tabindex="-1"></a>                    <span class="at">data =</span> Fatalities,</span>
<span id="cb251-4"><a href="rwpd.html#cb251-4" tabindex="-1"></a>                    <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;state&quot;</span>, <span class="st">&quot;year&quot;</span>), </span>
<span id="cb251-5"><a href="rwpd.html#cb251-5" tabindex="-1"></a>                    <span class="at">model =</span> <span class="st">&quot;within&quot;</span>)</span>
<span id="cb251-6"><a href="rwpd.html#cb251-6" tabindex="-1"></a></span>
<span id="cb251-7"><a href="rwpd.html#cb251-7" tabindex="-1"></a></span>
<span id="cb251-8"><a href="rwpd.html#cb251-8" tabindex="-1"></a><span class="fu">coeftest</span>(fatal_fe_mod, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb251-9"><a href="rwpd.html#cb251-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb251-10"><a href="rwpd.html#cb251-10" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb251-11"><a href="rwpd.html#cb251-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb251-12"><a href="rwpd.html#cb251-12" tabindex="-1"></a><span class="co">#&gt;         Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span id="cb251-13"><a href="rwpd.html#cb251-13" tabindex="-1"></a><span class="co">#&gt; beertax -0.65587    0.28880  -2.271  0.02388 *</span></span>
<span id="cb251-14"><a href="rwpd.html#cb251-14" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb251-15"><a href="rwpd.html#cb251-15" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The estimated coefficient is again <span class="math inline">\(-0.6559\)</span>. Note that <tt>plm()</tt> uses the entity-demeaned OLS algorithm and thus does not report dummy coefficients. The estimated regression function is</p>
<p><span class="math display" id="eq:efemod">\[\begin{align}
\widehat{FatalityRate} = -\underset{(0.29)}{0.66} \times BeerTax + StateFixedEffects. \tag{10.7}
\end{align}\]</span></p>
<p>The coefficient on <span class="math inline">\(BeerTax\)</span> is negative and significant. The interpretation is that the estimated reduction in traffic fatalities due to an increase in the real beer tax by <span class="math inline">\(\$1\)</span> is <span class="math inline">\(0.66\)</span> per <span class="math inline">\(10000\)</span> people, which is still pretty high. Although including state fixed effects eliminates the risk of a bias due to omitted factors that vary across states but not over time, we suspect that there are other omitted variables that vary over time and thus cause a bias.</p>
</div>
</div>
<div id="regression-with-time-fixed-effects" class="section level2 hasAnchor" number="10.4">
<h2><span class="header-section-number">10.4</span> Regression with Time Fixed Effects<a href="rwpd.html#regression-with-time-fixed-effects" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Controlling for variables that are constant across entities but vary over time can be done by including time fixed effects. If there are <em>only</em> time fixed effects, the fixed effects regression model becomes <span class="math display">\[Y_{it} = \beta_0 + \beta_1 X_{it} + \delta_2 B2_t + \cdots + \delta_T BT_t + u_{it},\]</span> where only <span class="math inline">\(T-1\)</span> dummies are included (<span class="math inline">\(B1\)</span> is omitted) since the model includes an intercept. This model eliminates omitted variable bias caused by excluding unobserved variables that evolve over time but are constant across entities.</p>
<p>In some applications it is meaningful to include both entity and time fixed effects. The <em>entity and time fixed effects model</em> is <span class="math display">\[Y_{it} = \beta_0 + \beta_1 X_{it} + \gamma_2 D2_i + \cdots + \gamma_n DT_i + \delta_2 B2_t + \cdots + \delta_T BT_t + u_{it} .\]</span> The combined model allows to eliminate bias from unobservables that change over time but are constant over entities and it controls for factors that differ across entities but are constant over time. Such models can be estimated using the OLS algorithm that is implemented in <tt>R</tt>.</p>
<p>The following code chunk shows how to estimate the combined entity and time fixed effects model of the relation between fatalities and beer tax: <span class="math display">\[FatalityRate_{it} = \beta_1 BeerTax_{it} + StateEffects + TimeFixedEffects + u_{it},\]</span> using both <tt>lm()</tt> and <tt>plm()</tt>. It is straightforward to estimate this regression with <tt>lm()</tt> since it is just an extension of <a href="rwpd.html#eq:fatsemod">(10.6)</a> so we only have to adjust the <tt>formula</tt> argument by adding the additional regressor <tt>year</tt> for time fixed effects. In our call of <tt>plm()</tt> we set another argument <tt>effect = “twoways”</tt> for inclusion of entity <em>and</em> time dummies.</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="rwpd.html#cb252-1" tabindex="-1"></a><span class="co"># estimate a combined time and entity fixed effects regression model</span></span>
<span id="cb252-2"><a href="rwpd.html#cb252-2" tabindex="-1"></a></span>
<span id="cb252-3"><a href="rwpd.html#cb252-3" tabindex="-1"></a><span class="co"># via lm()</span></span>
<span id="cb252-4"><a href="rwpd.html#cb252-4" tabindex="-1"></a>fatal_tefe_lm_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(fatal_rate <span class="sc">~</span> beertax <span class="sc">+</span> state <span class="sc">+</span> year <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data =</span> Fatalities)</span>
<span id="cb252-5"><a href="rwpd.html#cb252-5" tabindex="-1"></a>fatal_tefe_lm_mod</span>
<span id="cb252-6"><a href="rwpd.html#cb252-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb252-7"><a href="rwpd.html#cb252-7" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb252-8"><a href="rwpd.html#cb252-8" tabindex="-1"></a><span class="co">#&gt; lm(formula = fatal_rate ~ beertax + state + year - 1, data = Fatalities)</span></span>
<span id="cb252-9"><a href="rwpd.html#cb252-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb252-10"><a href="rwpd.html#cb252-10" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb252-11"><a href="rwpd.html#cb252-11" tabindex="-1"></a><span class="co">#&gt;  beertax   stateal   stateaz   statear   stateca   stateco   statect   statede  </span></span>
<span id="cb252-12"><a href="rwpd.html#cb252-12" tabindex="-1"></a><span class="co">#&gt; -0.63998   3.51137   2.96451   2.87284   2.02618   2.04984   1.67125   2.22711  </span></span>
<span id="cb252-13"><a href="rwpd.html#cb252-13" tabindex="-1"></a><span class="co">#&gt;  statefl   statega   stateid   stateil   statein   stateia   stateks   stateky  </span></span>
<span id="cb252-14"><a href="rwpd.html#cb252-14" tabindex="-1"></a><span class="co">#&gt;  3.25132   4.02300   2.86242   1.57287   2.07123   1.98709   2.30707   2.31659  </span></span>
<span id="cb252-15"><a href="rwpd.html#cb252-15" tabindex="-1"></a><span class="co">#&gt;  statela   stateme   statemd   statema   statemi   statemn   statems   statemo  </span></span>
<span id="cb252-16"><a href="rwpd.html#cb252-16" tabindex="-1"></a><span class="co">#&gt;  2.67772   2.41713   1.82731   1.42335   2.04488   1.63488   3.49146   2.23598  </span></span>
<span id="cb252-17"><a href="rwpd.html#cb252-17" tabindex="-1"></a><span class="co">#&gt;  statemt   statene   statenv   statenh   statenj   statenm   stateny   statenc  </span></span>
<span id="cb252-18"><a href="rwpd.html#cb252-18" tabindex="-1"></a><span class="co">#&gt;  3.17160   2.00846   2.93322   2.27245   1.43016   3.95748   1.34849   3.22630  </span></span>
<span id="cb252-19"><a href="rwpd.html#cb252-19" tabindex="-1"></a><span class="co">#&gt;  statend   stateoh   stateok   stateor   statepa   stateri   statesc   statesd  </span></span>
<span id="cb252-20"><a href="rwpd.html#cb252-20" tabindex="-1"></a><span class="co">#&gt;  1.90762   1.85664   2.97776   2.36597   1.76563   1.26964   4.06496   2.52317  </span></span>
<span id="cb252-21"><a href="rwpd.html#cb252-21" tabindex="-1"></a><span class="co">#&gt;  statetn   statetx   stateut   statevt   stateva   statewa   statewv   statewi  </span></span>
<span id="cb252-22"><a href="rwpd.html#cb252-22" tabindex="-1"></a><span class="co">#&gt;  2.65670   2.61282   2.36165   2.56100   2.23618   1.87424   2.63364   1.77545  </span></span>
<span id="cb252-23"><a href="rwpd.html#cb252-23" tabindex="-1"></a><span class="co">#&gt;  statewy  year1983  year1984  year1985  year1986  year1987  year1988  </span></span>
<span id="cb252-24"><a href="rwpd.html#cb252-24" tabindex="-1"></a><span class="co">#&gt;  3.30791  -0.07990  -0.07242  -0.12398  -0.03786  -0.05090  -0.05180</span></span>
<span id="cb252-25"><a href="rwpd.html#cb252-25" tabindex="-1"></a></span>
<span id="cb252-26"><a href="rwpd.html#cb252-26" tabindex="-1"></a><span class="co"># via plm()</span></span>
<span id="cb252-27"><a href="rwpd.html#cb252-27" tabindex="-1"></a>fatal_tefe_mod <span class="ot">&lt;-</span> <span class="fu">plm</span>(fatal_rate <span class="sc">~</span> beertax, </span>
<span id="cb252-28"><a href="rwpd.html#cb252-28" tabindex="-1"></a>                      <span class="at">data =</span> Fatalities,</span>
<span id="cb252-29"><a href="rwpd.html#cb252-29" tabindex="-1"></a>                      <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;state&quot;</span>, <span class="st">&quot;year&quot;</span>), </span>
<span id="cb252-30"><a href="rwpd.html#cb252-30" tabindex="-1"></a>                      <span class="at">model =</span> <span class="st">&quot;within&quot;</span>, </span>
<span id="cb252-31"><a href="rwpd.html#cb252-31" tabindex="-1"></a>                      <span class="at">effect =</span> <span class="st">&quot;twoways&quot;</span>)</span>
<span id="cb252-32"><a href="rwpd.html#cb252-32" tabindex="-1"></a></span>
<span id="cb252-33"><a href="rwpd.html#cb252-33" tabindex="-1"></a><span class="fu">coeftest</span>(fatal_tefe_mod, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb252-34"><a href="rwpd.html#cb252-34" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb252-35"><a href="rwpd.html#cb252-35" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb252-36"><a href="rwpd.html#cb252-36" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb252-37"><a href="rwpd.html#cb252-37" tabindex="-1"></a><span class="co">#&gt;         Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span id="cb252-38"><a href="rwpd.html#cb252-38" tabindex="-1"></a><span class="co">#&gt; beertax -0.63998    0.35015 -1.8277  0.06865 .</span></span>
<span id="cb252-39"><a href="rwpd.html#cb252-39" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb252-40"><a href="rwpd.html#cb252-40" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Before discussing the outcomes we convince ourselves that <tt>state</tt> and <tt>year</tt> are of the class <tt>factor</tt> .</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="rwpd.html#cb253-1" tabindex="-1"></a><span class="co"># check the class of &#39;state&#39; and &#39;year&#39;</span></span>
<span id="cb253-2"><a href="rwpd.html#cb253-2" tabindex="-1"></a><span class="fu">class</span>(Fatalities<span class="sc">$</span>state)</span>
<span id="cb253-3"><a href="rwpd.html#cb253-3" tabindex="-1"></a><span class="co">#&gt; [1] &quot;pseries&quot; &quot;factor&quot;</span></span>
<span id="cb253-4"><a href="rwpd.html#cb253-4" tabindex="-1"></a><span class="fu">class</span>(Fatalities<span class="sc">$</span>year)</span>
<span id="cb253-5"><a href="rwpd.html#cb253-5" tabindex="-1"></a><span class="co">#&gt; [1] &quot;pseries&quot; &quot;factor&quot;</span></span></code></pre></div>
<p>The <tt>lm()</tt> functions converts factors into dummies automatically. Since we exclude the intercept by adding <tt>-1</tt> to the right-hand side of the regression formula, <tt>lm()</tt> estimates coefficients for <span class="math inline">\(n + (T-1) = 48 + 6 = 54\)</span> binary variables (6 year dummies and 48 state dummies). Again, <tt>plm()</tt> only reports the estimated coefficient on <span class="math inline">\(BeerTax\)</span>.</p>
<p>The estimated regression function is
<span class="math display" id="eq:cbnfemod">\[\begin{align}
\widehat{FatalityRate} =  -\underset{(0.35)}{0.64} \times BeerTax + StateEffects + TimeFixedEffects. \tag{10.8}
\end{align}\]</span>
The result <span class="math inline">\(-0.66\)</span> is close to the estimated coefficient for the regression model including only entity fixed effects. Unsurprisingly, the coefficient is less precisely estimated but significantly different from zero at <span class="math inline">\(10\%\)</span>.</p>
<p>In view of <a href="rwpd.html#eq:efemod">(10.7)</a> and <a href="rwpd.html#eq:cbnfemod">(10.8)</a> we conclude that the estimated relationship between traffic fatalities and the real beer tax is not affected by omitted variable bias due to factors that are constant either over time or across states..</p>
</div>
<div id="tferaaseffer" class="section level2 hasAnchor" number="10.5">
<h2><span class="header-section-number">10.5</span> The Fixed Effects Regression Assumptions and Standard Errors for Fixed Effects Regression<a href="rwpd.html#tferaaseffer" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section focuses on the entity fixed effects model and presents model assumptions that need to hold in order for OLS to produce unbiased estimates that are normally distributed in large samples. These assumptions are an extension of the assumptions made for the multiple regression model (see Key Concept 6.4) and are given in Key Concept 10.3. We also briefly discuss standard errors in fixed effects models which differ from standard errors in multiple regression as the regression error can exhibit serial correlation in panel models.</p>
<div id="KC10.3" class="keyconcept">
<h3 class="right">
Key Concept 10.3
</h3>
<h3 class="left">
The Fixed Effects Regression Assumptions
</h3>
<p>In the fixed effects model <span class="math display">\[ Y_{it} = \beta_1 X_{it} + \alpha_i + u_{it} \ \ , \ \ i=1,\dots,n, \ t=1,\dots,T, \]</span> we assume the following:</p>
<ol style="list-style-type: decimal">
<li><p>The error term <span class="math inline">\(u_{it}\)</span> has conditional mean zero, that is, <span class="math inline">\(E(u_{it}|X_{i1}, X_{i2},\dots, X_{iT} = 0)\)</span>.</p></li>
<li><p><span class="math inline">\((X_{i1}, X_{i2}, \dots, X_{it}, u_{i1}, \dots, u_{iT})\)</span>, <span class="math inline">\(i=1,\dots,n\)</span> are i.i.d. draws from their joint distribution.</p></li>
<li><p>Large outliers are unlikely, i.e., <span class="math inline">\((X_{it}, u_{it})\)</span> have nonzero finite fourth moments.</p></li>
<li><p>There is no perfect multicollinearity.</p></li>
</ol>
<p>When there are multiple regressors, <span class="math inline">\(X_{it}\)</span> is replaced by <span class="math inline">\(X_{1,it}, X_{2,it}, \dots, X_{k,it}\)</span>.</p>
</div>
<p>The first assumption is that the error is uncorrelated with <em>all</em> observations of the variable <span class="math inline">\(X\)</span> for the entity <span class="math inline">\(i\)</span> over time. If this assumption is violated, we face omitted variables bias. The second assumption ensures that variables are i.i.d. <em>across</em> entities <span class="math inline">\(i=1,\dots,n\)</span>. This does not require the observations to be uncorrelated <em>within</em> an entity. The <span class="math inline">\(X_{it}\)</span> are allowed to be <em>autocorrelated</em> within entities. This is a common property of time series data. The same is allowed for errors <span class="math inline">\(u_{it}\)</span>. Consult Chapter 10.5 (Stock and Watson) of the book for a detailed explanation for why autocorrelation is plausible in panel applications. The second assumption is justified if the entities are selected by simple random sampling. The third and fourth assumptions are analogous to the multiple regression assumptions made in Key Concept 6.4.</p>
<div id="standard-errors-for-fixed-effects-regression" class="section level4 unnumbered hasAnchor">
<h4>Standard Errors for Fixed Effects Regression<a href="rwpd.html#standard-errors-for-fixed-effects-regression" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Similar as for heteroskedasticity, autocorrelation invalidates the usual standard error formulas as well as heteroskedasticity-robust standard errors since these are derived under the assumption that there is no autocorrelation. When there is both heteroskedasticity <em>and</em> autocorrelation, the so-called <em>heteroskedasticity and autocorrelation-consistent (HAC) standard errors</em> need to be used. <em>Clustered standard errors</em> belong to these type of standard errors. They allow for heteroskedasticity and autocorrelated errors within an entity but <em>not</em> correlation across entities.</p>
<p>As shown in the examples throughout this chapter, it is fairly easy to specify usage of clustered standard errors in regression summaries produced by functions like <tt>coeftest()</tt> in conjunction with <tt>vcovHC()</tt> from the package <tt>sandwich</tt>. Conveniently, <tt>vcovHC()</tt> recognizes panel model objects (objects of class <tt>plm</tt>) and computes clustered standard errors by default.</p>
<p>The regressions conducted in this chapter are good examples for why usage of clustered standard errors is crucial in empirical applications of fixed effects models. For example, consider the entity and time fixed effects model for fatalities. Since <tt>fatal_tefe_lm_mod</tt> is an object of class <tt>lm</tt>, <tt>coeftest()</tt> does not compute clustered standard errors but uses robust standard errors that are only valid in the absence of autocorrelated errors.</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="rwpd.html#cb254-1" tabindex="-1"></a><span class="co"># check class of the model object</span></span>
<span id="cb254-2"><a href="rwpd.html#cb254-2" tabindex="-1"></a><span class="fu">class</span>(fatal_tefe_lm_mod)</span>
<span id="cb254-3"><a href="rwpd.html#cb254-3" tabindex="-1"></a><span class="co">#&gt; [1] &quot;lm&quot;</span></span>
<span id="cb254-4"><a href="rwpd.html#cb254-4" tabindex="-1"></a></span>
<span id="cb254-5"><a href="rwpd.html#cb254-5" tabindex="-1"></a><span class="co"># obtain a summary based on heteroskedasticity-robust standard errors </span></span>
<span id="cb254-6"><a href="rwpd.html#cb254-6" tabindex="-1"></a><span class="co"># (no adjustment for heteroskedasticity only)</span></span>
<span id="cb254-7"><a href="rwpd.html#cb254-7" tabindex="-1"></a><span class="fu">coeftest</span>(fatal_tefe_lm_mod, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)[<span class="dv">1</span>, ]</span>
<span id="cb254-8"><a href="rwpd.html#cb254-8" tabindex="-1"></a><span class="co">#&gt;   Estimate Std. Error    t value   Pr(&gt;|t|) </span></span>
<span id="cb254-9"><a href="rwpd.html#cb254-9" tabindex="-1"></a><span class="co">#&gt; -0.6399800  0.2547149 -2.5125346  0.0125470</span></span>
<span id="cb254-10"><a href="rwpd.html#cb254-10" tabindex="-1"></a></span>
<span id="cb254-11"><a href="rwpd.html#cb254-11" tabindex="-1"></a><span class="co"># check class of the (plm) model object</span></span>
<span id="cb254-12"><a href="rwpd.html#cb254-12" tabindex="-1"></a><span class="fu">class</span>(fatal_tefe_mod)</span>
<span id="cb254-13"><a href="rwpd.html#cb254-13" tabindex="-1"></a><span class="co">#&gt; [1] &quot;plm&quot;        &quot;panelmodel&quot;</span></span>
<span id="cb254-14"><a href="rwpd.html#cb254-14" tabindex="-1"></a></span>
<span id="cb254-15"><a href="rwpd.html#cb254-15" tabindex="-1"></a><span class="co"># obtain a summary based on clustered standard errors </span></span>
<span id="cb254-16"><a href="rwpd.html#cb254-16" tabindex="-1"></a><span class="co"># (adjustment for autocorrelation + heteroskedasticity)</span></span>
<span id="cb254-17"><a href="rwpd.html#cb254-17" tabindex="-1"></a><span class="fu">coeftest</span>(fatal_tefe_mod, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb254-18"><a href="rwpd.html#cb254-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb254-19"><a href="rwpd.html#cb254-19" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb254-20"><a href="rwpd.html#cb254-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb254-21"><a href="rwpd.html#cb254-21" tabindex="-1"></a><span class="co">#&gt;         Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span id="cb254-22"><a href="rwpd.html#cb254-22" tabindex="-1"></a><span class="co">#&gt; beertax -0.63998    0.35015 -1.8277  0.06865 .</span></span>
<span id="cb254-23"><a href="rwpd.html#cb254-23" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb254-24"><a href="rwpd.html#cb254-24" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The outcomes differ rather strongly: imposing no autocorrelation we obtain a standard error of <span class="math inline">\(0.25\)</span> which implies significance of <span class="math inline">\(\hat\beta_1\)</span>, the coefficient on <span class="math inline">\(BeerTax\)</span> at the level of <span class="math inline">\(5\%\)</span>. On the contrary, using the clustered standard error <span class="math inline">\(0.35\)</span> results in a failure to reject the null hypothesis <span class="math inline">\(H_0: \beta_1 = 0\)</span> at the same level, see equation <a href="rwpd.html#eq:cbnfemod">(10.8)</a>. Consult Appendix 10.2 of the book (Stock and Watson) for insights on the computation of clustered standard errors.</p>
</div>
</div>
<div id="drunk-driving-laws-and-traffic-deaths" class="section level2 hasAnchor" number="10.6">
<h2><span class="header-section-number">10.6</span> Drunk Driving Laws and Traffic Deaths<a href="rwpd.html#drunk-driving-laws-and-traffic-deaths" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are two major sources of omitted variable bias that are not accounted for by all of the models of the relation between traffic fatalities and beer taxes that we have considered so far: economic conditions and driving laws. Fortunately, <tt>Fatalities</tt> has data on state-specific legal drinking age (<tt>drinkage</tt>), punishment (<tt>jail</tt>, <tt>service</tt>) and various economic indicators like unemployment rate (<tt>unemp</tt>) and per capita income (<tt>income</tt>). We may use these covariates to extend the preceding analysis.</p>
<p>These covariates are defined as follows:</p>
<ul>
<li><tt>unemp</tt>: a numeric variable stating the state specific unemployment rate.</li>
<li><tt>log(income)</tt>: the logarithm of real per capita income (in 1988 dollars).</li>
<li><tt>miles</tt>: the state average miles per driver.</li>
<li><tt>drinkage</tt>: the state specific minimum legal drinking age.</li>
<li><tt>drinkagec</tt>: a discretized version of <tt>drinkage</tt> that classifies states into four categories of minimal drinking age; <span class="math inline">\(18\)</span>, <span class="math inline">\(19\)</span>, <span class="math inline">\(20\)</span>, <span class="math inline">\(21\)</span> and older. <tt>R</tt> denotes this as <tt>[18,19)</tt>, <tt>[19,20)</tt>, <tt>[20,21)</tt> and <tt>[21,22]</tt>. These categories are included as dummy regressors where <tt>[21,22]</tt> is chosen as the reference category.</li>
<li><tt>punish</tt>: a dummy variable with levels <tt>yes</tt> and <tt>no</tt> that measures if drunk driving is severely punished by mandatory jail time or mandatory community service (first conviction).</li>
</ul>
<p>At first, we define the variables according to the regression results presented in Table 10.1 of the book.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="rwpd.html#cb255-1" tabindex="-1"></a><span class="co"># discretize the minimum legal drinking age</span></span>
<span id="cb255-2"><a href="rwpd.html#cb255-2" tabindex="-1"></a>Fatalities<span class="sc">$</span>drinkagec <span class="ot">&lt;-</span> <span class="fu">cut</span>(Fatalities<span class="sc">$</span>drinkage,</span>
<span id="cb255-3"><a href="rwpd.html#cb255-3" tabindex="-1"></a>                            <span class="at">breaks =</span> <span class="dv">18</span><span class="sc">:</span><span class="dv">22</span>, </span>
<span id="cb255-4"><a href="rwpd.html#cb255-4" tabindex="-1"></a>                            <span class="at">include.lowest =</span> <span class="cn">TRUE</span>, </span>
<span id="cb255-5"><a href="rwpd.html#cb255-5" tabindex="-1"></a>                            <span class="at">right =</span> <span class="cn">FALSE</span>)</span>
<span id="cb255-6"><a href="rwpd.html#cb255-6" tabindex="-1"></a></span>
<span id="cb255-7"><a href="rwpd.html#cb255-7" tabindex="-1"></a><span class="co"># set minimum drinking age [21, 22] to be the baseline level</span></span>
<span id="cb255-8"><a href="rwpd.html#cb255-8" tabindex="-1"></a>Fatalities<span class="sc">$</span>drinkagec <span class="ot">&lt;-</span> <span class="fu">relevel</span>(Fatalities<span class="sc">$</span>drinkagec, <span class="st">&quot;[21,22]&quot;</span>)</span>
<span id="cb255-9"><a href="rwpd.html#cb255-9" tabindex="-1"></a></span>
<span id="cb255-10"><a href="rwpd.html#cb255-10" tabindex="-1"></a><span class="co"># mandatory jail or community service?</span></span>
<span id="cb255-11"><a href="rwpd.html#cb255-11" tabindex="-1"></a>Fatalities<span class="sc">$</span>punish <span class="ot">&lt;-</span> <span class="fu">with</span>(Fatalities, <span class="fu">factor</span>(jail <span class="sc">==</span> <span class="st">&quot;yes&quot;</span> <span class="sc">|</span> service <span class="sc">==</span> <span class="st">&quot;yes&quot;</span>, </span>
<span id="cb255-12"><a href="rwpd.html#cb255-12" tabindex="-1"></a>                                             <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;no&quot;</span>, <span class="st">&quot;yes&quot;</span>)))</span>
<span id="cb255-13"><a href="rwpd.html#cb255-13" tabindex="-1"></a></span>
<span id="cb255-14"><a href="rwpd.html#cb255-14" tabindex="-1"></a><span class="co"># the set of observations on all variables for 1982 and 1988</span></span>
<span id="cb255-15"><a href="rwpd.html#cb255-15" tabindex="-1"></a>fatal_1982_1988 <span class="ot">&lt;-</span> Fatalities[<span class="fu">with</span>(Fatalities, year <span class="sc">==</span> <span class="dv">1982</span> <span class="sc">|</span> year <span class="sc">==</span> <span class="dv">1988</span>), ]</span></code></pre></div>
<p>Next, we estimate all seven models using <tt>plm()</tt>.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="rwpd.html#cb256-1" tabindex="-1"></a><span class="co"># estimate all seven models</span></span>
<span id="cb256-2"><a href="rwpd.html#cb256-2" tabindex="-1"></a>fat_mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(fatal_rate <span class="sc">~</span> beertax, <span class="at">data =</span> Fatalities)</span>
<span id="cb256-3"><a href="rwpd.html#cb256-3" tabindex="-1"></a></span>
<span id="cb256-4"><a href="rwpd.html#cb256-4" tabindex="-1"></a>fat_mod2 <span class="ot">&lt;-</span> <span class="fu">plm</span>(fatal_rate <span class="sc">~</span> beertax <span class="sc">+</span> state, <span class="at">data =</span> Fatalities)</span>
<span id="cb256-5"><a href="rwpd.html#cb256-5" tabindex="-1"></a></span>
<span id="cb256-6"><a href="rwpd.html#cb256-6" tabindex="-1"></a>fat_mod3 <span class="ot">&lt;-</span> <span class="fu">plm</span>(fatal_rate <span class="sc">~</span> beertax <span class="sc">+</span> state <span class="sc">+</span> year,</span>
<span id="cb256-7"><a href="rwpd.html#cb256-7" tabindex="-1"></a>                       <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;state&quot;</span>,<span class="st">&quot;year&quot;</span>),</span>
<span id="cb256-8"><a href="rwpd.html#cb256-8" tabindex="-1"></a>                       <span class="at">model =</span> <span class="st">&quot;within&quot;</span>,</span>
<span id="cb256-9"><a href="rwpd.html#cb256-9" tabindex="-1"></a>                       <span class="at">effect =</span> <span class="st">&quot;twoways&quot;</span>, </span>
<span id="cb256-10"><a href="rwpd.html#cb256-10" tabindex="-1"></a>                       <span class="at">data =</span> Fatalities)</span>
<span id="cb256-11"><a href="rwpd.html#cb256-11" tabindex="-1"></a></span>
<span id="cb256-12"><a href="rwpd.html#cb256-12" tabindex="-1"></a>fat_mod4 <span class="ot">&lt;-</span> <span class="fu">plm</span>(fatal_rate <span class="sc">~</span> beertax <span class="sc">+</span> state <span class="sc">+</span> year <span class="sc">+</span> drinkagec </span>
<span id="cb256-13"><a href="rwpd.html#cb256-13" tabindex="-1"></a>                       <span class="sc">+</span> punish <span class="sc">+</span> miles <span class="sc">+</span> unemp <span class="sc">+</span> <span class="fu">log</span>(income), </span>
<span id="cb256-14"><a href="rwpd.html#cb256-14" tabindex="-1"></a>                       <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;state&quot;</span>, <span class="st">&quot;year&quot;</span>),</span>
<span id="cb256-15"><a href="rwpd.html#cb256-15" tabindex="-1"></a>                       <span class="at">model =</span> <span class="st">&quot;within&quot;</span>,</span>
<span id="cb256-16"><a href="rwpd.html#cb256-16" tabindex="-1"></a>                       <span class="at">effect =</span> <span class="st">&quot;twoways&quot;</span>,</span>
<span id="cb256-17"><a href="rwpd.html#cb256-17" tabindex="-1"></a>                       <span class="at">data =</span> Fatalities)</span>
<span id="cb256-18"><a href="rwpd.html#cb256-18" tabindex="-1"></a></span>
<span id="cb256-19"><a href="rwpd.html#cb256-19" tabindex="-1"></a>fat_mod5 <span class="ot">&lt;-</span> <span class="fu">plm</span>(fatal_rate <span class="sc">~</span> beertax <span class="sc">+</span> state <span class="sc">+</span> year <span class="sc">+</span> drinkagec </span>
<span id="cb256-20"><a href="rwpd.html#cb256-20" tabindex="-1"></a>                       <span class="sc">+</span> punish <span class="sc">+</span> miles,</span>
<span id="cb256-21"><a href="rwpd.html#cb256-21" tabindex="-1"></a>                       <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;state&quot;</span>, <span class="st">&quot;year&quot;</span>),</span>
<span id="cb256-22"><a href="rwpd.html#cb256-22" tabindex="-1"></a>                       <span class="at">model =</span> <span class="st">&quot;within&quot;</span>,</span>
<span id="cb256-23"><a href="rwpd.html#cb256-23" tabindex="-1"></a>                       <span class="at">effect =</span> <span class="st">&quot;twoways&quot;</span>,</span>
<span id="cb256-24"><a href="rwpd.html#cb256-24" tabindex="-1"></a>                       <span class="at">data =</span> Fatalities)</span>
<span id="cb256-25"><a href="rwpd.html#cb256-25" tabindex="-1"></a></span>
<span id="cb256-26"><a href="rwpd.html#cb256-26" tabindex="-1"></a>fat_mod6 <span class="ot">&lt;-</span> <span class="fu">plm</span>(fatal_rate <span class="sc">~</span> beertax <span class="sc">+</span> year <span class="sc">+</span> drinkage </span>
<span id="cb256-27"><a href="rwpd.html#cb256-27" tabindex="-1"></a>                       <span class="sc">+</span> punish <span class="sc">+</span> miles <span class="sc">+</span> unemp <span class="sc">+</span> <span class="fu">log</span>(income), </span>
<span id="cb256-28"><a href="rwpd.html#cb256-28" tabindex="-1"></a>                       <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;state&quot;</span>, <span class="st">&quot;year&quot;</span>),</span>
<span id="cb256-29"><a href="rwpd.html#cb256-29" tabindex="-1"></a>                       <span class="at">model =</span> <span class="st">&quot;within&quot;</span>,</span>
<span id="cb256-30"><a href="rwpd.html#cb256-30" tabindex="-1"></a>                       <span class="at">effect =</span> <span class="st">&quot;twoways&quot;</span>,</span>
<span id="cb256-31"><a href="rwpd.html#cb256-31" tabindex="-1"></a>                       <span class="at">data =</span> Fatalities)</span>
<span id="cb256-32"><a href="rwpd.html#cb256-32" tabindex="-1"></a></span>
<span id="cb256-33"><a href="rwpd.html#cb256-33" tabindex="-1"></a>fat_mod7 <span class="ot">&lt;-</span> <span class="fu">plm</span>(fatal_rate <span class="sc">~</span> beertax <span class="sc">+</span> state <span class="sc">+</span> year <span class="sc">+</span> drinkagec </span>
<span id="cb256-34"><a href="rwpd.html#cb256-34" tabindex="-1"></a>                       <span class="sc">+</span> punish <span class="sc">+</span> miles <span class="sc">+</span> unemp <span class="sc">+</span> <span class="fu">log</span>(income), </span>
<span id="cb256-35"><a href="rwpd.html#cb256-35" tabindex="-1"></a>                       <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;state&quot;</span>, <span class="st">&quot;year&quot;</span>),</span>
<span id="cb256-36"><a href="rwpd.html#cb256-36" tabindex="-1"></a>                       <span class="at">model =</span> <span class="st">&quot;within&quot;</span>,</span>
<span id="cb256-37"><a href="rwpd.html#cb256-37" tabindex="-1"></a>                       <span class="at">effect =</span> <span class="st">&quot;twoways&quot;</span>,</span>
<span id="cb256-38"><a href="rwpd.html#cb256-38" tabindex="-1"></a>                       <span class="at">data =</span> fatal_1982_1988)</span></code></pre></div>
<p>We again use <tt>stargazer()</tt> <span class="citation">(<a href="#ref-R-stargazer">Hlavac 2022</a>)</span> to generate a comprehensive tabular presentation of the results.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="rwpd.html#cb257-1" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb257-2"><a href="rwpd.html#cb257-2" tabindex="-1"></a></span>
<span id="cb257-3"><a href="rwpd.html#cb257-3" tabindex="-1"></a><span class="co"># gather clustered standard errors in a list</span></span>
<span id="cb257-4"><a href="rwpd.html#cb257-4" tabindex="-1"></a>rob_se <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(fat_mod1, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb257-5"><a href="rwpd.html#cb257-5" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(fat_mod2, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb257-6"><a href="rwpd.html#cb257-6" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(fat_mod3, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb257-7"><a href="rwpd.html#cb257-7" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(fat_mod4, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb257-8"><a href="rwpd.html#cb257-8" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(fat_mod5, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb257-9"><a href="rwpd.html#cb257-9" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(fat_mod6, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb257-10"><a href="rwpd.html#cb257-10" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(fat_mod7, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))))</span>
<span id="cb257-11"><a href="rwpd.html#cb257-11" tabindex="-1"></a></span>
<span id="cb257-12"><a href="rwpd.html#cb257-12" tabindex="-1"></a><span class="co"># generate the table</span></span>
<span id="cb257-13"><a href="rwpd.html#cb257-13" tabindex="-1"></a><span class="fu">stargazer</span>(fat_mod1, </span>
<span id="cb257-14"><a href="rwpd.html#cb257-14" tabindex="-1"></a>          fat_mod2, </span>
<span id="cb257-15"><a href="rwpd.html#cb257-15" tabindex="-1"></a>          fat_mod3, </span>
<span id="cb257-16"><a href="rwpd.html#cb257-16" tabindex="-1"></a>          fat_mod4, </span>
<span id="cb257-17"><a href="rwpd.html#cb257-17" tabindex="-1"></a>          fat_mod5, </span>
<span id="cb257-18"><a href="rwpd.html#cb257-18" tabindex="-1"></a>          fat_mod6, </span>
<span id="cb257-19"><a href="rwpd.html#cb257-19" tabindex="-1"></a>          fat_mod7, </span>
<span id="cb257-20"><a href="rwpd.html#cb257-20" tabindex="-1"></a>          <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb257-21"><a href="rwpd.html#cb257-21" tabindex="-1"></a>          <span class="at">header =</span> <span class="cn">FALSE</span>,</span>
<span id="cb257-22"><a href="rwpd.html#cb257-22" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>, </span>
<span id="cb257-23"><a href="rwpd.html#cb257-23" tabindex="-1"></a>          <span class="at">se =</span> rob_se,</span>
<span id="cb257-24"><a href="rwpd.html#cb257-24" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">&quot;Linear Panel Regression Models of Traffic Fatalities</span></span>
<span id="cb257-25"><a href="rwpd.html#cb257-25" tabindex="-1"></a><span class="st">                                                      due to Drunk Driving&quot;</span>,</span>
<span id="cb257-26"><a href="rwpd.html#cb257-26" tabindex="-1"></a>          <span class="at">model.numbers =</span> <span class="cn">FALSE</span>,</span>
<span id="cb257-27"><a href="rwpd.html#cb257-27" tabindex="-1"></a>          <span class="at">column.labels =</span> <span class="fu">c</span>(<span class="st">&quot;(1)&quot;</span>, <span class="st">&quot;(2)&quot;</span>, <span class="st">&quot;(3)&quot;</span>, <span class="st">&quot;(4)&quot;</span>, <span class="st">&quot;(5)&quot;</span>, <span class="st">&quot;(6)&quot;</span>, <span class="st">&quot;(7)&quot;</span>))</span></code></pre></div>
<p>While columns (2) and (3) recap the results <a href="rwpd.html#eq:efemod">(10.7)</a> and <a href="rwpd.html#eq:cbnfemod">(10.8)</a>, column (1) presents an estimate of the coefficient of interest in the naive OLS regression of the fatality rate on beer tax without any fixed effects. We obtain a <em>positive</em> estimate for the coefficient on beer tax that is likely to be upward biased. The model fit is rather bad, too (<span class="math inline">\(\bar{R}^2 = 0.091\)</span>). The sign of the estimate changes as we extend the model by both entity and time fixed effects in models (2) and (3). Furthermore <span class="math inline">\(\bar{R}^2\)</span> increases substantially as fixed effects are included in the model equation. Nonetheless, as discussed before, the magnitudes of both estimates may be too large.</p>
<p>The model specifications (4) to (7) include covariates that shall capture the effect of economic conditions overall state as well as the legal framework. Considering (4) as the baseline specification, we observe four interesting results:</p>
<ol style="list-style-type: decimal">
<li><p>Including the covariates does not lead to a major reduction of the estimated effect of the beer tax. The coefficient is not significantly different from zero at the level of <span class="math inline">\(5\%\)</span> as the estimate is rather imprecise.</p></li>
<li><p>The minimum legal drinking age <em>does not</em> have an effect on traffic fatalities: none of the three dummy variables are significantly different from zero at any common level of significance. Moreover, an <span class="math inline">\(F\)</span>-Test of the joint hypothesis that all three coefficients are zero does not reject the null hyptothesis. The next code chunk shows how to test this hypothesis.</p></li>
</ol>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="rwpd.html#cb258-1" tabindex="-1"></a><span class="co"># test if legal drinking age has no explanatory power</span></span>
<span id="cb258-2"><a href="rwpd.html#cb258-2" tabindex="-1"></a><span class="fu">linearHypothesis</span>(fat_mod4,</span>
<span id="cb258-3"><a href="rwpd.html#cb258-3" tabindex="-1"></a>                 <span class="at">test =</span> <span class="st">&quot;F&quot;</span>,</span>
<span id="cb258-4"><a href="rwpd.html#cb258-4" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">&quot;drinkagec[18,19)=0&quot;</span>, <span class="st">&quot;drinkagec[19,20)=0&quot;</span>, <span class="st">&quot;drinkagec[20,21)&quot;</span>), </span>
<span id="cb258-5"><a href="rwpd.html#cb258-5" tabindex="-1"></a>                 <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb258-6"><a href="rwpd.html#cb258-6" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb258-7"><a href="rwpd.html#cb258-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb258-8"><a href="rwpd.html#cb258-8" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb258-9"><a href="rwpd.html#cb258-9" tabindex="-1"></a><span class="co">#&gt; drinkagec[18,19) = 0</span></span>
<span id="cb258-10"><a href="rwpd.html#cb258-10" tabindex="-1"></a><span class="co">#&gt; drinkagec[19,20) = 0</span></span>
<span id="cb258-11"><a href="rwpd.html#cb258-11" tabindex="-1"></a><span class="co">#&gt; drinkagec[20,21) = 0</span></span>
<span id="cb258-12"><a href="rwpd.html#cb258-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb258-13"><a href="rwpd.html#cb258-13" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb258-14"><a href="rwpd.html#cb258-14" tabindex="-1"></a><span class="co">#&gt; Model 2: fatal_rate ~ beertax + state + year + drinkagec + punish + miles + </span></span>
<span id="cb258-15"><a href="rwpd.html#cb258-15" tabindex="-1"></a><span class="co">#&gt;     unemp + log(income)</span></span>
<span id="cb258-16"><a href="rwpd.html#cb258-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb258-17"><a href="rwpd.html#cb258-17" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb258-18"><a href="rwpd.html#cb258-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb258-19"><a href="rwpd.html#cb258-19" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df      F Pr(&gt;F)</span></span>
<span id="cb258-20"><a href="rwpd.html#cb258-20" tabindex="-1"></a><span class="co">#&gt; 1    276                 </span></span>
<span id="cb258-21"><a href="rwpd.html#cb258-21" tabindex="-1"></a><span class="co">#&gt; 2    273  3 0.3782 0.7688</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li><p>There is no evidence that punishment for first offenders has a deterring effects on drunk driving: the corresponding coefficient is not significant at the <span class="math inline">\(10\%\)</span> level.</p></li>
<li><p>The economic variables significantly explain traffic fatalities. We can check that the employment rate and per capita income are jointly significant at the level of <span class="math inline">\(0.1\%\)</span>.</p></li>
</ol>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="rwpd.html#cb259-1" tabindex="-1"></a><span class="co"># test if economic indicators have no explanatory power</span></span>
<span id="cb259-2"><a href="rwpd.html#cb259-2" tabindex="-1"></a><span class="fu">linearHypothesis</span>(fat_mod4, </span>
<span id="cb259-3"><a href="rwpd.html#cb259-3" tabindex="-1"></a>                 <span class="at">test =</span> <span class="st">&quot;F&quot;</span>,</span>
<span id="cb259-4"><a href="rwpd.html#cb259-4" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">&quot;log(income)&quot;</span>, <span class="st">&quot;unemp&quot;</span>), </span>
<span id="cb259-5"><a href="rwpd.html#cb259-5" tabindex="-1"></a>                 <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb259-6"><a href="rwpd.html#cb259-6" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb259-7"><a href="rwpd.html#cb259-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb259-8"><a href="rwpd.html#cb259-8" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb259-9"><a href="rwpd.html#cb259-9" tabindex="-1"></a><span class="co">#&gt; log(income) = 0</span></span>
<span id="cb259-10"><a href="rwpd.html#cb259-10" tabindex="-1"></a><span class="co">#&gt; unemp = 0</span></span>
<span id="cb259-11"><a href="rwpd.html#cb259-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb259-12"><a href="rwpd.html#cb259-12" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb259-13"><a href="rwpd.html#cb259-13" tabindex="-1"></a><span class="co">#&gt; Model 2: fatal_rate ~ beertax + state + year + drinkagec + punish + miles + </span></span>
<span id="cb259-14"><a href="rwpd.html#cb259-14" tabindex="-1"></a><span class="co">#&gt;     unemp + log(income)</span></span>
<span id="cb259-15"><a href="rwpd.html#cb259-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb259-16"><a href="rwpd.html#cb259-16" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb259-17"><a href="rwpd.html#cb259-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb259-18"><a href="rwpd.html#cb259-18" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df      F    Pr(&gt;F)    </span></span>
<span id="cb259-19"><a href="rwpd.html#cb259-19" tabindex="-1"></a><span class="co">#&gt; 1    275                        </span></span>
<span id="cb259-20"><a href="rwpd.html#cb259-20" tabindex="-1"></a><span class="co">#&gt; 2    273  2 31.577 4.609e-13 ***</span></span>
<span id="cb259-21"><a href="rwpd.html#cb259-21" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb259-22"><a href="rwpd.html#cb259-22" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Model (5) omits the economic factors. The result supports the notion that economic indicators should remain in the model as the coefficient on beer tax is sensitive to the inclusion of the latter.</p>
<p>Results for model (6) demonstrate that the legal drinking age has little explanatory power and that the coefficient of interest is not sensitive to changes in the functional form of the relation between drinking age and traffic fatalities.</p>
<p>Specification (7) reveals that reducing the amount of available information (we only use 95 observations for the period 1982 to 1988 here) inflates standard errors but does not lead to drastic changes in coefficient estimates.</p>
<div id="summary-2" class="section level4 unnumbered hasAnchor">
<h4>Summary<a href="rwpd.html#summary-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We have not found evidence that severe punishments and increasing the minimum drinking age reduce traffic fatalities due to drunk driving. Nonetheless, there seems to be a negative effect of alcohol taxes on traffic fatalities which, however, is estimated imprecisely and cannot be interpreted as the causal effect of interest as there still may be a bias. The issue is that there may be omitted variables that differ across states <em>and</em> change over time and this bias remains even though we use a panel approach that controls for entity specific and time invariant unobservables.</p>
<p>A powerful method that can be used if common panel regression approaches fail is instrumental variables regression. We will return to this concept in Chapter <a href="ivr.html#ivr">12</a>.</p>
</div>
</div>
<div id="exercises-10" class="section level2 hasAnchor" number="10.7">
<h2><span class="header-section-number">10.7</span> Exercises<a href="rwpd.html#exercises-10" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For the course of this section, you will work with <tt>Guns</tt>, a balanced panel containing observations on criminal and demographic variables for all US states and the years 1977-1999. The dataset comes with the package <tt>AER</tt> which is already installed for the interactive R exercises below.</p>
<div id="the-guns-dataset" class="section level4 unnumbered hasAnchor DCexercise">
<h4>1. The Guns Dataset<a href="rwpd.html#the-guns-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Load both the <tt>AER</tt> package and the <tt>Guns</tt> dataset.</p></li>
<li><p>Get yourself an overview over the dataset using the <tt>summary()</tt> function. Use <tt>?Guns</tt> for detailed information on the variables.</p></li>
<li><p>Verify that <tt>Guns</tt> is a balanced panel: extract the number of years and states from the dataset and assign them to the predefined variables <tt>years</tt> and <tt>states</tt>, respectively. Afterwards use these variables for a logical comparison: check that the panel is balanced.</p></li>
</ul>
<iframe src="DCL/ex10_1.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li>Use <tt>library()</tt> and <tt>data()</tt> to attach the package and load the dataset, respectively.</li>
<li>Use <tt>summary()</tt> to obtain a comprehensive overview of the dataset.</li>
<li>Remember that in a balanced panel the number of entities times the number of years equals the total number of observations in the dataset. The basic functions <tt>levels()</tt>, <tt>length()</tt> and <tt>nrow()</tt> may be useful.</li>
</ul>
</div>
<div id="strict-or-loose-gun-laws-and-the-effect-on-crime-i" class="section level4 unnumbered hasAnchor DCexercise">
<h4>2. Strict or Loose? Gun Laws and the Effect on Crime I<a href="rwpd.html#strict-or-loose-gun-laws-and-the-effect-on-crime-i" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There is a controversial debate whether and if to what extent the right to carry a gun influences crime. Proponents of so-called “Carrying a Concealed Weapon” (CCW) laws argue that the deterrent effect of guns prevents crime, whereas opponents argue that the public availability of guns increases their usage and thus makes it easier to commit crimes. In the following exercises you will empirically investigate this topic.
To begin with consider the following estimated model
<span class="math display">\[\widehat{{\log(violent_i)}} = 6.135 - 0.443 \times law_i,\]</span>
with <span class="math inline">\(i=1,\ldots,51\)</span> where <tt>violent</tt> is the violent crime rate (incidents per 100000 residents) and <tt>law</tt> is a binary variable indicating the implementation of a CCW law (1 = yes, 0 = no), respectively.</p>
<p>The estimated model is available as <tt>model</tt> in your working environment. The packages <tt>AER</tt> and <tt>plm</tt> have been loaded.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Extend and estimate the model by including state fixed effects using the function <tt>plm()</tt> and assign the model object to the predefined variable <tt>model_se</tt>. Can you think of an unobserved variable that is captured by this model specification?</li>
<li>Print a summary of the model which reports cluster robust standard errors.</li>
<li>Test whether the fixed state effects are jointly significant from zero. To do so use the function <tt>pFtest()</tt>. Use <tt>?pFtest</tt> for additional information.</li>
</ul>
<iframe src="DCL/ex10_2.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p>The function <tt>plm()</tt> allows you to conduct regressions with panel data and works very similar to <tt>lm()</tt>. You have to specify the entity and time indicators inside as a vector using the argument <tt>index</tt> and specify the estimator to be used with the argument <tt>model</tt> (for the fixed effects estimator this is <tt>“within”</tt>).</p></li>
<li><p>As usual you can use <tt>coeftest()</tt> in conjunction with appropriate arguments to obtain a summary output with robust standard errors.</p></li>
<li><p><tt>pFtest()</tt> expects two model objects. The first model includes fixed effects, the second does not.</p></li>
</ul>
</div>
<div id="strict-or-loose-gun-laws-and-the-effect-on-crime-ii" class="section level4 unnumbered hasAnchor DCexercise">
<h4>3. Strict or Loose? Gun Laws and the Effect on Crime II<a href="rwpd.html#strict-or-loose-gun-laws-and-the-effect-on-crime-ii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>As touched upon at the end of the last exercise it is reasonable to also include time effects which is why we now consider the model
<span class="math display">\[\begin{align}\log(violent_i)  &amp; = \beta_1\times law_i + \alpha_i + \lambda_t + u_i,\end{align}\]</span>
for <span class="math inline">\(i=1,\ldots,51\)</span> and <span class="math inline">\(t=1977,\ldots,1999\)</span>.
The models <tt>model</tt> and <tt>model_se</tt> from the previous exercises are available in your working environment. The packages <tt>AER</tt> and <tt>plm</tt> have been attached.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Estimate the model above and assign it to the variable <tt>model_sete</tt> using <tt>plm()</tt>.</li>
<li>Print a summary of the model which reports robust standard errors.</li>
<li>Test whether both state and time fixed effects are jointly significant.</li>
</ul>
<iframe src="DCL/ex10_3.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li>To additionally incorparate time fixed effects, one can set the argument <tt>effect=“twoways”</tt> inside of <tt>plm()</tt>.</li>
<li>Note that we want to test whether the state <em>and</em> time fixed effects are jointly significant.</li>
</ul>
</div>
<div id="strict-or-loose-gun-laws-and-the-effect-on-crime-iii" class="section level4 unnumbered hasAnchor DCexercise">
<h4>4. Strict or Loose? Gun Laws and the Effect on Crime III<a href="rwpd.html#strict-or-loose-gun-laws-and-the-effect-on-crime-iii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Despite the evidence for state as well as time effects found in exercise 3, there still might be a bias due to omitted variables such as sociodemographic characteristics. The following model accounts for the latter:
<span class="math display">\[\begin{align}\log(violent_i)  &amp; = \beta_1\times law_i + \beta_2\times prisoners_i + \beta_3\times density_i + \beta_4\times income_i + \beta_5\times population_i \\&amp;\quad + \beta_6\times afam_i + \beta_7\times cauc_i + \beta_8\times male_i + \alpha_i + \lambda_t + u_i.\end{align}\]</span>
See <tt>?Guns</tt> for detailed information on the additional variables.</p>
<p>The packages <tt>AER</tt> and <tt>plm</tt> have been loaded.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Estimate the extended model and assign it to the predefined variable <tt>model_sete_ext</tt>.</li>
<li>Print a robust summary of the estimated model. What can you say about the effect of a CCW law?</li>
</ul>
<iframe src="DCL/ex10_4.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<div id="fixed-effects-regression---two-time-periods" class="section level4 unnumbered hasAnchor DCexercise">
<h4>5. Fixed Effects Regression - Two Time Periods<a href="rwpd.html#fixed-effects-regression---two-time-periods" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Recall the fixed effects model from Exercise 10.2, but now assume that you only have observations for the years 1978 and 1984. Consider the two model specifications
<span class="math display">\[\begin{align}
\log(violent_{i1984}) - \log(violent_{i1978}) = \beta_{BA}\times(law_{i1984}-law_{i1978}) + (u_{i1984} - u_{i1978})
\end{align}\]</span>
and
<span class="math display">\[\begin{align}
\log(violent_{it}) = \beta_{FE}\times law_{it} + \alpha_i + u_{it},\\
\end{align}\]</span>
with <span class="math inline">\(i=1,\ldots,51\)</span> and <span class="math inline">\(t=1978,1984\)</span>.
In this exercise you need to show that <span class="math inline">\(\widehat{\beta}_{BA}=\widehat{\beta}_{FE}\)</span>.
The subsets of <tt>Guns</tt> for the years 1978 and 1984 are already available as <tt>Guns78</tt> and <tt>Guns84</tt> in your working environment. The packages <tt>AER</tt> and <tt>plm</tt> have been loaded.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Compute the differences necessary to estimate the first model and assign them to the variables <tt>diff_logv</tt> and <tt>diff_law</tt>.</li>
<li>Estimate both models. Use the differenced data to estimate the first model and <tt>plm()</tt> for the second.</li>
<li>Verify with a logical comparison that both procedures numerically yield the same estimate. Use the variables <tt>coef_diff</tt> and <tt>coef_plm</tt> which contain the relevant coefficients rounded to the fourth decimal place.</li>
</ul>
<iframe src="DCL/ex10_5.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li>Keep in mind that the dependend variable is log-transformed.</li>
<li>You may use <tt>plm()</tt> as in the previous exercises. Note that you only need a subset of the original <tt>Guns</tt> dataset. Theargument <tt>subset</tt> allows to subset the dataset passed to the argument <tt>data</tt>. Alternatively, you can join the two datasets <tt>Guns78</tt> and <tt>Guns84</tt>using, e.g., <tt>rbind()</tt>.</li>
<li>Use the logical operator <tt>==</tt> to compare both estimates.</li>
</ul>
</div>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-R-plm" class="csl-entry">
Croissant, Yves, Giovanni Millo, and Kevin Tappe. 2023. <em><span class="nocase">plm: Linear Models for Panel Data</span></em> (version 2.6-3). <a href="https://cran.r-project.org/package=plm">https://cran.r-project.org/package=plm</a>.
</div>
<div id="ref-R-stargazer" class="csl-entry">
Hlavac, Marek. 2022. <em>Stargazer: Well-Formatted Regression and Summary Statistics Tables</em>. Bratislava, Slovakia: Social Policy Institute. <a href="https://CRAN.R-project.org/package=stargazer">https://CRAN.R-project.org/package=stargazer</a>.
</div>
<div id="ref-R-AER" class="csl-entry">
Kleiber, Christian, and Achim Zeileis. 2008. <em>Applied Econometrics with <span>R</span></em>. New York: Springer-Verlag. <a href="https://CRAN.R-project.org/package=AER">https://CRAN.R-project.org/package=AER</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="asbomr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="rwabdv.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mca91/EconometricsWithR/edit/master/10-ch10.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
